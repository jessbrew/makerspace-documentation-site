!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="f434a2c7-6f0f-3776-b802-7a1cda00b022")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_folder","./c_file_viewer_api_navigation","./c_core_data_ui","./c_core_data_actions","./c_react-redux_hooks_useDispatch","./c_web-vitals","./e_edison","./c_file_viewer_hooks_lifecycle_logging","./c_file_viewer_hooks_usePrevious"],(function(e,i,t,n,s,o,r,l,a,v,u){"use strict";function _(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var g=_(i);const c=t.fileViewerAtom(),d=t.fileViewerAtom(),T=t.fileViewerAtom(),E=t.fileViewerAtom(),w=t.fileViewerAtom(),m=t.fileViewerAtom(),A=t.fileViewerAtom();const f=new Set([t.PreviewsTimingEvents.CONTAINER_MOUNT,t.PreviewsTimingEvents.COLLECTION_VIEWER_MOUNT,t.PreviewsTimingEvents.SDK_FILE_VIEWER_CODE_START,t.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA_START_START,t.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA,t.PreviewsTimingEvents.FVSDK_TITLE_BAR_MOUNT,t.PreviewsTimingEvents.FVSDK_APP_MOUNT,t.PreviewsTimingEvents.FVSDK_MARK_TTVC,t.PreviewsTimingEvents.PREVIEW_COMPONENT_MOUNT,t.PreviewsTimingEvents.PREVIEW_RENDERER_MOUNT,t.PreviewsTimingEvents.FVSDK_MARK_LCP,t.PreviewsTimingEvents.FVSDK_MARK_FCP,t.PreviewsTimingEvents.ASYNC_IMAGE_CONTAINER_MOUNT,t.PreviewsTimingEvents.FVSDK_IMAGE_CONTAINER_START,t.PreviewsTimingEvents.FVSDK_IMAGE_CONTAINER_MOUNT,t.PreviewsTimingEvents.FVSDK_IMAGE_ON_LOAD,t.PreviewsTimingEvents.FVSDK_VIDEO_CONTAINER_MOUNT,t.PreviewsTimingEvents.FVSDK_VIDEO_PLAYER_READY,t.PreviewsTimingEvents.ASYNC_DOC_CONTAINER_MOUNT,t.PreviewsTimingEvents.FVSDK_DOC_CONTAINER_START,t.PreviewsTimingEvents.FVSDK_DOC_CONTAINER_MOUNT,t.PreviewsTimingEvents.FVSDK_FIRST_DOC_PAGE_ON_LOAD]);e.useRecordPreviewsTimerOnMount=(e,i,n,s=!0)=>{const o=t.useFileViewerSelector(t.getFilePreviewSessionId,e),{logger:r}=t.useFileViewerContext(),l=u.usePrevious(s);g.default.useEffect((()=>{var e;const t=performance.getEntriesByName(i,"mark"),a=v.getLoggingSession(o);if(t.length>0&&s&&!l){performance.clearMarks(i);const s=t[t.length-1],o=performance.now()-s.startTime;null===(e=null==r?void 0:r.logDuration)||void 0===e||e.call(r,{eventName:i,durationInMs:o,session:a?v.serializeSession(a):void 0,tags:n})}}),[r,s,l,o,n,i])},e.useTimingLogging=(e,i)=>{const n=g.default.useRef(!1),s=t.useFileViewerSelector(t.getFilePreviewSessionId,e),{logger:o,isLoggedIn:r}=t.useFileViewerContext(),{onLogTimeline:u}=((e,i,n)=>{const s=t.useFileViewerSelector(t.getFilePreviewSessionId,e),{logger:o}=t.useFileViewerContext(),r=g.default.useRef(!1);return{onLogTimeline:g.default.useCallback((()=>{var e;const l=t.PreviewsEventLogger.getStartEntry(),a=v.getLoggingSession(s);if(l&&!r.current){const s=t.PreviewsEventLogger.getEventTimeline();Object.entries(s).forEach((([e,t])=>{var s;n.has(e)&&(null===(s=null==o?void 0:o.logDuration)||void 0===s||s.call(o,{eventName:i,durationInMs:t,tags:{event:e},session:a?v.serializeSession(a):void 0}))})),null===(e=null==o?void 0:o.logDuration)||void 0===e||e.call(o,{eventName:i,durationInMs:l.startTime,tags:{event:"session_start_since_load"},session:a?v.serializeSession(a):void 0}),r.current=!0}}),[o,i,s,n])}})(e,`preview_timeline_ttvc_${i}`,f),_=t.useRootPreviewMetadata(),c=g.default.useMemo((()=>{var e,i,t,n,s,o,r,l,a;if("image"===(null===(e=_.content)||void 0===e?void 0:e[".tag"])&&(null===(i=_.content.default_src)||void 0===i?void 0:i.includes(".webp"))||"ssr_doc"===(null===(t=_.content)||void 0===t?void 0:t[".tag"])&&(null===(s=null===(n=_.content)||void 0===n?void 0:n.image_url_tmpl)||void 0===s?void 0:s.includes(".webp")))return"ON";if("ssr_doc"===(null===(o=_.content)||void 0===o?void 0:o[".tag"]))return"CONTROL";return"image"===(null===(r=_.content)||void 0===r?void 0:r[".tag"])&&((null===(l=_.content.default_src)||void 0===l?void 0:l.includes(".jpeg"))||(null===(a=_.content.default_src)||void 0===a?void 0:a.includes(".jpg")))?"CONTROL":"OFF"}),[_.content]),d=g.default.useCallback(((e,i)=>({navigation_type:e,file_flip:String(!!(null==i?void 0:i.extra.was_flipped)),logged_in_user:String(r)})),[r]),T=t.useStabilizedCallback((e=>{var i;t.PreviewsEventLogger.mark(t.PreviewsTimingEvents.FVSDK_MARK_TTVC);const n=v.getLoggingSession(s);n&&(n.extra.webp_preview_variant=c),e.duration&&(null===(i=null==o?void 0:o.logDuration)||void 0===i||i.call(o,{eventName:t.PREVIEW_TTVC_DURATION_EVENT,durationInMs:e.duration,tags:d("script"===e.detail.navigationType?"ajax":"page_load",n),shouldLogToHive:!0,session:n?v.serializeSession(n):void 0})),u()})),E=t.useStabilizedCallback((e=>{var i;t.PreviewsEventLogger.mark(t.PreviewsTimingEvents.FVSDK_MARK_LCP);const n=v.getLoggingSession(s);n&&(n.extra.webp_preview_variant=c),e.value&&(t.PreviewsEventLogger.mark(t.PreviewsTimingEvents.FVSDK_MARK_LCP,e.value),null===(i=null==o?void 0:o.logDuration)||void 0===i||i.call(o,{eventName:"largest_contentful_paint",durationInMs:e.value,tags:d(e.navigationType,n),shouldLogToHive:!0,session:n?v.serializeSession(n):void 0}))})),w=t.useStabilizedCallback((e=>{var i;t.PreviewsEventLogger.mark(t.PreviewsTimingEvents.FVSDK_MARK_FCP);const n=v.getLoggingSession(s);e.value&&(null===(i=null==o?void 0:o.logDuration)||void 0===i||i.call(o,{eventName:"first_contentful_paint",durationInMs:e.value,tags:d(e.navigationType,n),shouldLogToHive:!0,session:n?v.serializeSession(n):void 0}))}));n.current||(l.w(w),l.W(E),n.current=!0),g.default.useEffect((()=>{const e=a.onTTVC(T);return()=>{e&&e()}}),[T])},e.useTitlebarEditorActions=function(){const e=r.useDispatch(),{fileViewerId:i}=t.useFileViewerContext(),l=g.useCallback((()=>{e(o.setActiveEditPlugin({actionContext:t.UserActionContext.TitleBarMain,fileViewerId:i,pluginId:void 0}))}),[e,i]),a=n.useCloseViewerCallback(),v=g.useCallback((()=>{a(t.UserActionContext.TitleBarMain)}),[a]),u=!!s.useActiveEditorId(),[_,f]=t.useFileViewerAtom(c),[S,V]=t.useFileViewerAtom(d),[C,P]=t.useFileViewerAtom(T),[O,N]=t.useFileViewerAtom(E),[R,D]=t.useFileViewerAtom(w),[I,F]=t.useFileViewerAtom(m),[M,p]=t.useFileViewerAtom(A),L=g.useCallback((()=>{f(!1),V(!1),P(!1),N(void 0),D(void 0),p(v),F(l)}),[l,v,P,V,f,F,p,D,N]);return g.useEffect((()=>(u||L(),L)),[u,L]),{titleBarActionSetters:g.useMemo((()=>({setIsEditorReady:f,setHasEditorChanges:V,setEditorCanSave:P,setOnCancel:F,setOnSaveReplace:N,setOnSaveCopy:D,setOnClose:p})),[P,V,f,F,p,D,N]),titleBarActionGetters:g.useMemo((()=>({isEditorReady:null!=_&&_,hasEditorChanges:null!=S&&S,editorCanSave:null!=C&&C,onCancel:I,onSaveReplace:O,onSaveCopy:R,onClose:M})),[C,S,_,I,M,R,O])}}}));
//# sourceMappingURL=c_file_viewer_logging_timing.js-vfla2eyoz.map

//# debugId=f434a2c7-6f0f-3776-b802-7a1cda00b022