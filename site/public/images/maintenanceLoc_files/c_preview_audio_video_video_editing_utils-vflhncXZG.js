!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1bc50d1f-1ab9-39df-8159-080150e41102")}catch(e){}}();
define(["exports","./e_file_viewer_static_scl_page_folder","./c_core_logging_actions","./c_react_query_helpers_queries_file_content_metadata","./c_api_v2_routes_hellosign_provider"],(function(t,e,n,r,o){"use strict";const i=async t=>new Promise((e=>requestAnimationFrame((()=>t&&t.current?e(t.current.getBoundingClientRect().left):e(void 0))))),a=(t,e,n)=>t>n?n:t<e?e:t,c=(t,e,n,r)=>a(e,n,r)-t,l=(t,e,n,r)=>{const o=r-n;return Math.floor(n+t/e*o)},s=(t,e,n,r)=>r*(n-t)/(e-t),u=(t,e,n=1e-6)=>Math.abs(t-e)<n,d=(t,e)=>!(null==e||u(t.start,0)&&u(t.end,e)),g=t=>t>e.AUDIO_VIDEO_EDITING_SIZE_LIMIT,_=t=>t&&t>60*e.AUDIO_VIDEO_EDITING_DURATION_MINS_LIMIT,h=t=>t&&t<=1,T=t=>{if(t&&t.resolution_height&&t.resolution_width){const e=t.resolution_width,n=t.resolution_height;if(Math.max(e,n)>3840||Math.min(e,n)>2160)return!0}return!1},E=["h264"],I=[...E,"aac","flac","mp3","opus","pcm","hevc","mjpeg","av1"],p=t=>t&&I.includes(t);t.calculateLeftHandlePosition=async(t,e,n,r)=>{const a=await i(e);if(null==a)return;if(null==t||0===t)return;const{trackLeftOuterBound:l}=n;return c(l,t-a,l,r-2*o.TRIM_BORDER_ADJUSTMENT-o.TIME_MARKER_WIDTH-o.TIME_MARKER_GAP)},t.calculatePlaybackTimeMarkerPosition=async(t,e,n,r,a)=>{const l=await i(e);if(null==l)return;const{trackLeftOuterBound:s}=n;return c(s,t.clientX-l,r+o.TRIM_BORDER_ADJUSTMENT,a-o.TRIM_BORDER_ADJUSTMENT-o.TIME_MARKER_WIDTH)},t.calculateRightHandlePosition=async(t,e,n,r)=>{const a=await i(e);if(null==a)return;if(null==t||0===t)return;const{trackLeftOuterBound:l,trackEnd:s}=n;return c(l,t-a,r+2*o.TRIM_BORDER_ADJUSTMENT+o.TIME_MARKER_WIDTH,s)},t.calculateTimeFromPosition=(t,e,n)=>e/t*n,t.checkFileEditEligibility=(t,n,r)=>{if("video"!==t[".tag"]&&"audio"!==t[".tag"]||void 0===n||!r)return"codecNotSupported";const i=e.file_extension(r),a=t.duration||t.duration_precise;return g(n)?"tooBig":_(a)?"tooLong":h(a)?"tooShort":"video"===t[".tag"]&&T(t)?"over4k":o.isExtensionSupported(i)?p(t.codec)?void 0:"codecNotSupported":"extensionNotSupported"},t.checkHasAnyChange=(t,e)=>(0!==t.counts.crop||0!==t.counts.flip||0!==t.counts.rotate||0!==t.counts.trim)&&!!(d(t.trim,e)||0!==t.rotate||t.crop||t.horizontalFlip),t.checkHasCropCoordChange=(t,e)=>!(u(t.height,e.height)&&u(t.width,e.width)&&u(t.top,e.top)&&u(t.left,e.left)),t.checkHasTrimChange=d,t.checkHasTrimRangeChange=(t,e)=>!u(t.start,e.start)||!u(t.end,e.end),t.clamp=a,t.createInitialVideoEditState=(t,e)=>{var n,r,o;return{rotate:0,trim:{start:null!==(n=null==e?void 0:e.start)&&void 0!==n?n:0,end:null!==(o=null!==(r=null==e?void 0:e.end)&&void 0!==r?r:t)&&void 0!==o?o:0},crop:void 0,horizontalFlip:!1,counts:{trim:0,crop:0,rotate:0,flip:0},enhanceSpeech:!1}},t.getArrowKeyTimeDelta=(t,e)=>{if(0===e)return 0;const n=Math.max(.01*e,1),r=.1*n;let o=0;return"ArrowLeft"===t.key?o=t.shiftKey?-r:-n:"ArrowRight"===t.key&&(o=t.shiftKey?r:n),o},t.getContainerLeft=i,t.getElementLeft=t=>{var e,n;return null==(null===(n=null===(e=null==t?void 0:t.current)||void 0===e?void 0:e.style)||void 0===n?void 0:n.left)?null:parseInt(t.current.style.left,10)},t.getEmptyDragImage=()=>{const t=new Image(0,0);return t.src=o.EMPTY_IMG_SRC,t},t.getHoverTimestamp=(t,e,n)=>{const{trackLeftInnerBound:r,trackRightInnerBound:i}=n;return s(r,i-o.TIME_MARKER_WIDTH,t,e)},t.getLeftPositionFromTimestamp=(t,e,n)=>{const{trackLeftInnerBound:r,trackRightInnerBound:i}=n;return l(t,e,r,i)-o.TRIM_BORDER_ADJUSTMENT},t.getLeftTimestamp=(t,e,n)=>{const{trackLeftInnerBound:r,trackRightInnerBound:i}=n;return s(r,i,t+o.TRIM_BORDER_ADJUSTMENT,e)},t.getNextFlip=(t,e,n)=>"horizontal"===n?[!t,e]:[!t,(e+180)%360],t.getNextRotation=(t,e,n)=>(t+(n!==e?90:270))%360,t.getPlaybackTimeMarkerPositionFromTimestamp=(t,e,n)=>{const{trackLeftInnerBound:r,trackRightInnerBound:i}=n;return l(t,e,r,i-o.TIME_MARKER_WIDTH)},t.getPlaybackTimestamp=(t,e,n)=>{const{trackLeftInnerBound:r,trackRightInnerBound:i}=n;return s(r,i-o.TIME_MARKER_WIDTH,t,e)},t.getRightPositionFromTimestamp=(t,e,n)=>{const{trackLeftInnerBound:r,trackRightInnerBound:i}=n;return l(t,e,r,i)+o.TRIM_BORDER_ADJUSTMENT},t.getRightTimestamp=(t,e,n)=>{const{trackLeftInnerBound:r,trackRightInnerBound:i}=n;return s(r,i,t-o.TRIM_BORDER_ADJUSTMENT,e)},t.getTrimAccuracyThresholdMsec=t=>{const e=Math.round(100*(t.end-t.start));return Math.min(e>0?e:0,500)},t.getWrapperBounds=t=>{const e=t;return{trackStart:0,trackEnd:e,trackLeftOuterBound:0,trackRightOuterBound:e,trackLeftInnerBound:0+o.TRIM_BORDER_ADJUSTMENT,trackRightInnerBound:e-o.TRIM_BORDER_ADJUSTMENT}},t.isChangingCodecDuringEdit=t=>t&&!E.includes(t),t.logIneligibleEditAttempt=(t,r,o,i,a,c)=>{if(!a||!i||"video"!==i[".tag"]&&"audio"!==i[".tag"])return;const l=e.file_extension(c||""),s=i.duration||i.duration_precise;switch(t){case void 0:break;case"tooBig":r(n.logUserActionEvent({userAction:e.UserAction.EditVideoFailure,fileViewerId:o,actionContext:e.UserActionContext.TitleBarMain,extra:{reason:"too_large",size:a.toString()}}));break;case"tooLong":r(n.logUserActionEvent({userAction:e.UserAction.EditVideoFailure,fileViewerId:o,actionContext:e.UserActionContext.TitleBarMain,extra:{reason:"too_long",duration:s?s.toString():""}}));break;case"tooShort":r(n.logUserActionEvent({userAction:e.UserAction.EditVideoFailure,fileViewerId:o,actionContext:e.UserActionContext.TitleBarMain,extra:{reason:"too_short",duration:s?s.toString():""}}));break;case"over4k":if("video"!==i[".tag"])break;const t=i.resolution_width,c=i.resolution_height;r(n.logUserActionEvent({userAction:e.UserAction.EditVideoFailure,fileViewerId:o,actionContext:e.UserActionContext.TitleBarMain,extra:{reason:"over_4k",resolution_width:String(t),resolution_height:String(c)}}));break;case"extensionNotSupported":r(n.logUserActionEvent({userAction:e.UserAction.EditVideoFailure,fileViewerId:o,actionContext:e.UserActionContext.TitleBarMain,extra:{reason:"unsupported_extension",fileExtension:l}}));break;case"codecNotSupported":r(n.logUserActionEvent({userAction:e.UserAction.EditVideoFailure,fileViewerId:o,actionContext:e.UserActionContext.TitleBarMain,extra:{reason:"unsupported_codec",codec:i.codec||""}}))}},t.shouldAutoSnapHandle=(t,e)=>Math.abs(t-e)<o.AUTO_SNAP_THRESHOLD,t.updateElementVisibility=(t,e)=>{t.current&&(t.current.style.visibility=e?"hidden":"visible")},t.updatePositionStyle=(t,e)=>{t.current&&(null!=e.left&&(t.current.style.left=`${e.left}px`),null!=e.width&&(t.current.style.width=`${e.width}px`),null!=e.right&&(t.current.style.right=`${e.right}px`),null!=e.top&&(t.current.style.top=`${e.top}px`),null!=e.height&&(t.current.style.height=`${e.height}px`))},t.useEditLoggingExtras=t=>{var n;const o=e.useRootFile(),{data:i}=r.useFileContentMetadataQuery(o),a=null===(n=null==i?void 0:i.apiData)||void 0===n?void 0:n.metadata;if(!a)return null;const c="video"===a[".tag"]?a:null;if(!c)return null;const{resolution_width:l,resolution_height:s,frame_rate:u,duration:d,codec:g}=c;let _;return l&&s&&u&&d&&(_=l*s*u*d),{resolution_width:l?String(l):"",resolution_height:s?String(s):"",frame_rate:u?String(u):"",codec:g||"",total_size:_?String(_):"",extension:e.getWhitelistedFileExtension(e.getFileExtension(t))}}}));
//# sourceMappingURL=c_preview_audio_video_video_editing_utils.js-vflp3k1yd.map

//# debugId=1bc50d1f-1ab9-39df-8159-080150e41102