!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="74cc369f-2123-37aa-8dc5-542a0d1dc802")}catch(e){}}();
define(["exports","./c_flows_conversions_convert","./c_core_i18n","./c_flows_utils_browse_logger","./c_flows_redux_reducer","./c_api_v2_routes_flows_provider","./c_flows_redux_store","./c_flows_redux_actions","./c_src_bolt_flows_client","./c_dig-icons_assets_ui-icon_line_file","./c_dig-icons_assets_ui-icon_line_star","./c_dig-icons_assets_ui-icon_line_video","./c_dig-logos_src_glyph_fss","react","./c_spectrum_svg_icon_bundle","./c_extensions_client","./e_file_viewer_static_scl_page_folder","./c_shared_components_templates_modal_template","./e_core_exception","./c_cloud_docs_constants","./c_dig-icons_assets_ui-icon_line_upload","./c_gdd_migration_ui_utils","./c_icon_shortcuts_icon","./c_cloud_docs_hooks"],(function(e,t,o,n,s,i,a,l,r,c,u,d,f,g,_,p,h,m,S,v,E,M,F,I){"use strict";function T(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(o){if("default"!==o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}})),t.default=e,Object.freeze(t)}var O=T(g);const D="browse_save_as";async function C({files:e,template:t,conversionType:c,source:u}){const{initLabel:d,failLabel:f}={initLabel:e=>o.intl.formatMessage({id:"YdruIN",defaultMessage:"Your {numFiles, plural, one {file} other {files}} will be saved shortly..."},{numFiles:e}),failLabel:e=>o.intl.formatMessage({id:"j4UjMR",defaultMessage:"There was a problem saving your {numFiles, plural, one {file} other {files}}"},{numFiles:e})};n.updateSnackbar({variant:"sync",title:d(e.length)});const g=r.getConversionLoggingFunctions(c);a.getStoreForAutomations().dispatch(l.setShouldSubscribeToBolt(!0));try{await s.submitFileWorkflow(t,e.map((e=>e.file_id))),i.PapLogger.logSucceedSubmitManualWorkflow(D,t,e.length),g.logConvert(u,e.length)}catch(o){n.updateSnackbar({variant:"fail",title:f(e.length)}),i.PapLogger.logFailSubmitManualWorkflow(D,t,e.length,o)}}const y="pdf",L={actionText:"PDF",actionIcon:c.FileLine,selector:r.singleFileWithExtensionSelector(i.SUPPORTED_PDF_EXTENSIONS),convert:(e,o,n)=>{const{source:s}=n;return t.convertFileAndShowSnackbar({...n,file:e[0],user:o,conversionType:y,folderRuleAction:"pdf_conversion",loggingFunctions:r.getConversionLoggingFunctions(y),getStrings:(e,t)=>r.getDefaultConversionStrings("PDF",e,o,t),conversionFn:async(e,n,s)=>(await t.convertToPdf(o,r.getFileIdentifier(e,s))).path,getAdoptionSnackbarProps:n=>t.getAdoptionSnackbarProps({user:o,conversionType:y,folderRuleAction:"pdf_conversion",fileType:"PDF",resultPath:n,source:s,nsId:e[0].ns_id}),template:{sequence:[{workflow_action:{".tag":"pdf_conversion"}}]},outputExt:"PDF"})}},w={actionText:"PDF",actionIcon:c.FileLine,selector:r.strictMultiFileWithExtensionSelector(i.SUPPORTED_PDF_EXTENSIONS),convert:(e,t,{source:o})=>C({files:e,template:{sequence:[{workflow_action:{".tag":"pdf_conversion"}}]},conversionType:y,source:o})},A={jpg:i.SUPPORTED_IMAGE_INPUT_EXTENSIONS.filter((e=>"jpg"!==e&&"jpeg"!==e)),png:i.SUPPORTED_IMAGE_INPUT_EXTENSIONS.filter((e=>"png"!==e))},P="image-format",b=Object.entries(A).map((([e,o])=>({actionText:e.toUpperCase(),actionIcon:u.ImageLine,selector:r.singleFileWithExtensionSelector(o),convert:(o,n,s)=>{const{source:i}=s;return t.convertFileAndShowSnackbar({...s,file:o[0],user:n,conversionType:P,folderRuleAction:"image_conversion",loggingFunctions:r.getConversionLoggingFunctions(P),getStrings:(t,o)=>r.getDefaultConversionStrings(e.toUpperCase(),t,n,o),conversionFn:async(o,s,i)=>(await t.convertImageFormat(n,r.getFileIdentifier(o,i),e)).path,getAdoptionSnackbarProps:s=>t.getAdoptionSnackbarProps({user:n,conversionType:P,folderRuleAction:"image_conversion",fileType:e,resultPath:s,source:i,nsId:o[0].ns_id}),outputExt:e})}}))),R="doc-to-image",k=i.SUPPORTED_IMAGE_OUTPUT_EXTENSIONS.map((e=>({actionText:e.toUpperCase(),actionIcon:u.ImageLine,selector:r.singleFileWithExtensionSelector(i.SUPPORTED_DOC_INPUT_EXTENSIONS),convert:(o,n,s)=>{const{source:i}=s;return t.convertFileAndShowSnackbar({...s,file:o[0],user:n,conversionType:R,folderRuleAction:"image_conversion",loggingFunctions:r.getConversionLoggingFunctions(R),getStrings:(t,o)=>r.getDefaultConversionStrings(e.toUpperCase(),t,n,o),conversionFn:async(o,s,i)=>(await t.convertDocToImage(n,r.getFileIdentifier(o,i),e)).path,getAdoptionSnackbarProps:s=>t.getAdoptionSnackbarProps({user:n,conversionType:R,folderRuleAction:"image_conversion",fileType:e,resultPath:s,source:i,nsId:o[0].ns_id}),outputExt:e})}}))),N="media-remux",U=(e,n,s)=>(a,l,c)=>{const{source:u}=c;return t.convertFileAndShowSnackbar({...c,file:a[0],user:l,conversionType:N,folderRuleAction:n,loggingFunctions:r.getConversionLoggingFunctions(N),getStrings:(t,n)=>function(e,t,n,s){const a=r.getDefaultConversionStrings(e,t,n,s);return{...a,failTooLarge:o.intl.formatMessage({id:"D67i/e",defaultMessage:"Couldn't save as {fileType} because the file is too large. The maximum file size is {maxSize} MB."},{fileType:e,maxSize:i.MEDIA_REMUX_FILE_SIZE_LIMIT})}}(e.toUpperCase(),t,l,n),conversionFn:async(o,n,s)=>(await t.mediaRemux(l,r.getFileIdentifier(o,s),e)).path,getAdoptionSnackbarProps:n?o=>t.getAdoptionSnackbarProps({user:l,conversionType:N,folderRuleAction:n,fileType:e,resultPath:o,source:u,nsId:a[0].ns_id}):void 0,template:s,outputExt:e,asyncThresholdBytes:134217728})},x=[...i.SUPPORTED_VIDEO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:d.VideoLine,selector:r.singleFileWithExtensionSelector(i.SUPPORTED_VIDEO_INPUT_EXTENSIONS.filter((t=>t!==e))),convert:U(e,"video_conversion",{sequence:[{workflow_action:{".tag":"video_conversion",format:e}}]})}))),...i.SUPPORTED_AUDIO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:f.AudioLine,selector:r.singleFileWithExtensionSelector([...i.SUPPORTED_AUDIO_INPUT_EXTENSIONS,...i.SUPPORTED_VIDEO_INPUT_EXTENSIONS].filter((t=>t!==e))),convert:U(e,"audio_conversion",{sequence:[{workflow_action:{".tag":"audio_conversion",format:e}}]})})))],G=[...i.SUPPORTED_VIDEO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:d.VideoLine,selector:r.strictMultiFileWithExtensionSelector(i.SUPPORTED_VIDEO_INPUT_EXTENSIONS.filter((t=>t!==e))),convert:(t,o,{source:n})=>C({files:t,template:{sequence:[{workflow_action:{".tag":"video_conversion",format:e}}]},conversionType:N,source:n})}))),...i.SUPPORTED_AUDIO_OUTPUT_CONTAINERS.map((e=>({actionText:e.toUpperCase(),actionIcon:f.AudioLine,selector:r.strictMultiFileWithExtensionSelector([...i.SUPPORTED_AUDIO_INPUT_EXTENSIONS,...i.SUPPORTED_VIDEO_INPUT_EXTENSIONS].filter((t=>t!==e))),convert:(t,o,{source:n})=>C({files:t,template:{sequence:[{workflow_action:{".tag":"audio_conversion",format:e}}]},conversionType:N,source:n})})))];const z=i.SUPPORTED_DOC_INPUT_EXTENSIONS.concat(i.SUPPORTED_IMAGE_INPUT_EXTENSIONS),H={jpg:z.filter((e=>"jpg"!==e&&"jpeg"!==e)),png:z.filter((e=>"png"!==e))},V=Object.entries(H).map((([e,t])=>({actionText:e.toUpperCase(),actionIcon:u.ImageLine,selector:r.strictMultiFileWithExtensionSelector(t),convert:(t,o,{source:n})=>C({files:t,conversionType:"image-batch",template:{sequence:[{workflow_action:{".tag":"image_conversion",format:e}}]},source:n})})));var B;e.ConversionActionGroup=void 0,(B=e.ConversionActionGroup||(e.ConversionActionGroup={}))[B.DEFAULT=0]="DEFAULT",B[B.CLOUD_DOCS=1]="CLOUD_DOCS",B[B.VIDEO_SCALE=2]="VIDEO_SCALE";const W=JSON.parse('\n    {"dlink":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M4.222 12.914a4.5 4.5 0 0 0 6.364 6.364l2.475-2.475-1.414-1.414-2.475 2.475a2.5 2.5 0 0 1-3.536-3.536l3.536-3.535a2.5 2.5 0 0 1 3.535 0l1.061 1.06 1.414-1.414-1.06-1.06a4.5 4.5 0 0 0-6.364 0l-3.536 3.535z\\" fill=\\"currentColor\\"></path><path d=\\"M19.778 10.086a4.5 4.5 0 0 0-6.364-6.364L10.94 6.197l1.414 1.414 2.475-2.475a2.5 2.5 0 0 1 3.535 3.536l-3.535 3.535a2.5 2.5 0 0 1-3.536 0l-1.06-1.06-1.415 1.414 1.06 1.06a4.5 4.5 0 0 0 6.365 0l3.535-3.535z\\" fill=\\"currentColor\\"></path>"},"dropbox_form":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 30"},"dangerouslySetInnerIconHtml":"<path d=\\"M20.907 3.97h-2.819v-.93c0-.69-.559-1.249-1.248-1.249H14.7V.626A.622.622 0 0 0 14.074 0h-5.11a.626.626 0 0 0-.626.626v1.165h-2.13c-.69 0-1.25.56-1.25 1.249v.93H2.132A2.162 2.162 0 0 0 0 6.129v21.53a2.162 2.162 0 0 0 2.13 2.179h18.777a2.162 2.162 0 0 0 2.131-2.18V6.127a2.162 2.162 0 0 0-2.13-2.156zm.053 23.1a.622.622 0 0 1-.626.627H2.687a.626.626 0 0 1-.627-.626V6.776c0-.346.28-.626.627-.626H4.94v1.707a.626.626 0 0 0 .627.627h11.89a.626.626 0 0 0 .63-.666V6.11h2.255a.622.622 0 0 1 .626.627L20.96 27.07z\\" fill=\\"#727880\\" fill-rule=\\"nonzero\\"></path>"},"dropbox_paper":{"attrs":{"width":"30","height":"30","viewBox":"0 0 30 30"},"dangerouslySetInnerIconHtml":"<path fill=\\"none\\" d=\\"M0 0h30v30H0z\\"></path><path fill=\\"none\\" d=\\"M4 3h22.883v24H4z\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 19.71L15.441 27l11.442-7.29-11.441-7.288L4 19.712z\\" fill=\\"#B6D2EA\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 10.288l11.442 7.29 11.441-7.29L15.442 3 4 10.288z\\" fill=\\"#0061FF\\"></path>"},"dropbox_paper_template":{"attrs":{"width":"30","height":"30","viewBox":"0 0 30 30"},"dangerouslySetInnerIconHtml":"<path fill=\\"none\\" d=\\"M0 0h30v30H0z\\"></path><path fill=\\"none\\" d=\\"M4 3h22.883v24H4z\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 19.71L15.441 27l11.442-7.29-11.441-7.288L4 19.712z\\" fill=\\"#6A7C8F\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M4 10.288l11.442 7.29 11.441-7.29L15.442 3 4 10.288z\\" fill=\\"#1B2733\\"></path>"},"dropbox_paper_binder":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g clip-path=\\"url(#mc-partners-dropbox_paper_binder-a)\\" fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" fill=\\"#0061FF\\"><path d=\\"M11.92 22.107l-8.402-5.361-1.491.95L11.92 24l9.894-6.303-1.484-.951-8.41 5.36z\\"></path><path d=\\"M11.92 18.303l-8.402-5.352-1.491.95 9.893 6.304 9.894-6.303-1.484-.951-8.41 5.352z\\"></path><path d=\\"M11.92 14.508l-8.402-5.36-1.491.95 9.893 6.304 9.894-6.304-1.484-.95-8.41 5.36z\\"></path><path d=\\"M2.027 6.303l9.893 6.304 9.894-6.304L11.92 0 2.027 6.303z\\"></path></g><defs><clipPath id=\\"mc-partners-dropbox_paper_binder-a\\"><path fill=\\"#fff\\" d=\\"M0 0h24v24H0z\\"></path></clipPath></defs>"},"google_gdoc":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<rect x=\\"3\\" y=\\"3\\" width=\\"18\\" height=\\"18\\" rx=\\"2\\" fill=\\"#4285F4\\"></rect><path d=\\"M18 7H6v2h12V7zM18 11H6v2h12v-2zM14 15H6v2h8v-2z\\" fill=\\"#fff\\"></path>"},"google_gsheet":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<rect x=\\"3\\" y=\\"3\\" width=\\"18\\" height=\\"18\\" rx=\\"2\\" fill=\\"#0F9D58\\"></rect><path fill=\\"#fff\\" d=\\"M9 5h2v14H9z\\"></path><path fill=\\"#fff\\" d=\\"M5 9h14v2H5z\\"></path>"},"google_gslides":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<rect x=\\"3\\" y=\\"3\\" width=\\"18\\" height=\\"18\\" rx=\\"2\\" fill=\\"#F4B400\\"></rect><path fill=\\"#fff\\" d=\\"M5 8h14v8H5z\\"></path>"},"microsoft_docx":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M1 3l13-2v21L1 20V3z\\" fill=\\"#2B579A\\"></path><path d=\\"M13 3h9a1 1 0 0 1 1 1v15a1 1 0 0 1-1 1h-9V3z\\" fill=\\"#2B579A\\"></path><path fill=\\"#fff\\" d=\\"M14 4h8v15h-8z\\"></path><path fill=\\"#2B579A\\" d=\\"M13 6h7v1h-7zM13 9h7V8h-7zM13 11h7v-1h-7zM13 13h7v-1h-7zM13 15h7v-1h-7zM13 17h7v-1h-7z\\"></path><path d=\\"M12 8l-1.687 7H8.72l-1.06-4.49a4.084 4.084 0 0 1-.102-.787H7.54c-.027.32-.065.581-.116.786L6.338 15h-1.66L3 8h1.571l.9 4.662c.038.198.066.465.084.8h.027c.011-.25.054-.524.129-.82L6.868 8h1.54l1.046 4.7c.039.173.073.424.102.753h.018c.012-.258.043-.518.094-.781L10.549 8H12z\\" fill=\\"#fff\\"></path>"},"microsoft_pptx":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M1 3l13-2v21L1 20V3z\\" fill=\\"#D24726\\"></path><path d=\\"M7 13v3H5V7h2.897C9.966 7 11 7.956 11 9.868c0 .904-.298 1.636-.893 2.197A3.388 3.388 0 0 1 7.73 13H7zm0-4.444v2.806h.576c.985 0 1.477-.473 1.477-1.418 0-.925-.492-1.388-1.477-1.388H7z\\" fill=\\"#fff\\"></path><path d=\\"M13 3h9a1 1 0 0 1 1 1v15a1 1 0 0 1-1 1h-9V3z\\" fill=\\"#D24726\\"></path><path fill=\\"#fff\\" d=\\"M14 4h8v15h-8z\\"></path><path fill=\\"#D24726\\" d=\\"M14 15h6v-1h-6zM14 17h6v-1h-6z\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M16 13a3 3 0 0 0 3-3h-3V7a3 3 0 0 0 0 6z\\" fill=\\"#D24726\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M20 9a3 3 0 0 0-3-3v3h3z\\" fill=\\"#D24726\\"></path>"},"microsoft_xlsx":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path d=\\"M1 3l13-2v21L1 20V3z\\" fill=\\"#217346\\"></path><path d=\\"M13 3h9a1 1 0 0 1 1 1v15a1 1 0 0 1-1 1h-9V3z\\" fill=\\"#217346\\"></path><path fill=\\"#fff\\" d=\\"M14 4h8v15h-8z\\"></path><path fill=\\"#217346\\" d=\\"M14 14h2v-1h-2zM14 16h2v-1h-2zM14 10h2V9h-2zM14 12h2v-1h-2zM14 8h2V7h-2zM17 14h3v-1h-3zM17 16h3v-1h-3zM17 10h3V9h-3zM17 12h3v-1h-3zM17 8h3V7h-3z\\"></path><path d=\\"M6 7H4l2 4.5L4 16h2l1-3 1 3h2l-2-4.5L10 7H8l-1 3-1-3z\\" fill=\\"#fff\\"></path>"},"shortcut":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M13 18v-3.016a1.2 1.2 0 0 0-.965-1.177l-.358-.072a1.799 1.799 0 0 1-1.053-.64 4.984 4.984 0 0 0-.335-.666 1.84 1.84 0 0 1-.024-.106l-.168-.836a1.2 1.2 0 0 0-.51-.763l-.567-.377a1.167 1.167 0 0 1-.52-.972.875.875 0 0 0-.875-.875H6.46c-.183.477-.315.98-.39 1.5H4.056A9.001 9.001 0 0 1 22 11a9 9 0 0 1-11 8.777V17.71c.634.189 1.305.29 2 .29zm7-7a6.968 6.968 0 0 1-1.21 3.935 3 3 0 0 0-2.949-2.435h-2.24a.6.6 0 0 1-.6-.6V9.974c0-.29.163-.556.423-.686a1.915 1.915 0 0 0 1.058-1.741l-.05-3.4A7.002 7.002 0 0 1 20 11z\\" fill=\\"#0061FF\\"></path><path d=\\"M8.499 12H2.443l2.253 2.253c-3.513 3.711-2.712 7.364-2.367 8.434.03.095.165.086.192-.01.24-.852 1.147-3.317 4.174-6.425L8.943 18.5v-6.056A.444.444 0 0 0 8.499 12z\\" fill=\\"#717781\\"></path>"}}\n  '),j=e=>{const{name:t}=e,o=O.createElement(_.SvgIconBundle,{focusable:"false",icon:W[t]});return O.createElement(_.Component,{icon:o,...e})};var X;j.displayName="IconPartners",function(e){e.GOOGLE_DRIVE="web_shortcut",e.MICROSOFT_FILE="ms_file"}(X||(X={}));const q=(e,t,o,n,s)=>{h.logEvent$1({class:"cloud_docs",action:"select",object:"cloud_docs_manual_conversion_modal",properties:{accountRole:e,numFiles:t,cloudDocsManualConversionType:o,cloudDocsManualConversionModalButton:n,dontAskAgainChecked:s}})},Q=(e,t)=>{h.logEvent$1({class:"cloud_docs",action:"open",object:"cloud_docs_manual_conversion_folder_picker",properties:{accountRole:e,eventState:t}})},Y=(e,t,o,n,s,i,a,l)=>{h.logEvent$1({class:"cloud_docs",action:"initiate",object:"cloud_docs_manual_conversion",properties:{accountRole:e,numFiles:t,cloudDocsManualConversionType:o,modalWasShown:n,copyFilePermissions:s,useDefaultFolder:i,cloudDocsManualConversionError:a,eventState:l}})},$=(e,t)=>{switch(t){case X.GOOGLE_DRIVE:return(e=>{const t=new Set;for(const o of e){const e=v.getGoogleFileTypeByPath(o);if(e){t.add(e);continue}const n=v.getMicrosoftFileTypeByPath(o);n&&t.add(v.MicrosoftToGoogleFileTypes[n])}if(1===t.size)for(const e of t)return v.GoogleFileLabels[e];return o.intl.formatMessage({id:"ZYjkCp",defaultMessage:"Google"})})(e);case X.MICROSOFT_FILE:return(e=>{const t=new Set;for(const o of e){const e=v.getMicrosoftFileTypeByPath(o);if(e){t.add(e);continue}const n=v.getGoogleFileTypeByPath(o);n&&t.add(v.GoogleToMicrosoftFileTypes[n])}if(1===t.size)for(const e of t)return v.MicrosoftFileLabels[e];return o.intl.formatMessage({id:"WbLFdE",defaultMessage:"Microsoft"})})(e)}},J=({srcFileNames:e,targetDest:t,folderName:n=m.Strings.MIGRATION_FOLDER,onChangeDriveFolder:s,onLearnMore:i})=>{const a=$(e,t);switch(t){case X.GOOGLE_DRIVE:return o.intl.formatMessage({id:"pU1fIE",defaultMessage:"{numFiles, plural, one{The new {fileTypeLabel} shortcut (to be saved in <folderPickerButton>{folderName}</folderPickerButton>) will inherit the same sharing permissions as the original file. Save as will replace the original file.} other{The new {fileTypeLabel} shortcuts (to be saved in <folderPickerButton>{folderName}</folderPickerButton>) will inherit the same sharing permissions as the original files. Save as will replace the original files.}} <button>Learn more</button>"},{fileTypeLabel:a,numFiles:e.length,folderName:n,bold:e=>O.default.createElement(h.Text,{isBold:!0},e),button:e=>O.default.createElement(h.Button,{variant:"transparent",onClick:i},e),folderPickerButton:e=>O.default.createElement(h.Button,{onClick:s,variant:"transparent",withIconLeft:O.default.createElement(h.UIIcon,{src:E.FolderLine,role:"presentation"})},e)});case X.MICROSOFT_FILE:return o.intl.formatMessage({id:"gctOhH",defaultMessage:"{numFiles, plural, one{The new {fileTypeLabel} file will inherit the same sharing permissions as the original file. Save as will replace the original file.} other{The new {fileTypeLabel} files will inherit the same sharing permissions as the original files. Save as will replace the original files.}} <button>Learn more</button>"},{fileTypeLabel:a,numFiles:e.length,bold:e=>O.default.createElement(h.Text,{isBold:!0},e),button:e=>O.default.createElement(h.Button,{variant:"transparent",onClick:()=>{}},e)})}};var K;!function(e){e.pendingSaveShortcuts=function(e){return o.intl.formatMessage({id:"EXRMbA",defaultMessage:"Saving as {numFiles, plural, one{shortcut} other{shortcuts}} in Google Drive..."},{numFiles:e})},e.pendingSaveMsFiles=function(e){return o.intl.formatMessage({id:"xNu9kx",defaultMessage:"Saving as Microsoft {numFiles, plural, one{file} other{files}}..."},{numFiles:e})},e.successMessageShortcuts=function(e){return o.intl.formatMessage({id:"BwnqL+",defaultMessage:"{numFiles, plural, one{1 file saved as Google file shortcut} other{# files saved as Google file shortcuts}}."},{numFiles:e})},e.successMessageMultipleMsFiles=function(e){return o.intl.formatMessage({id:"ZXYeoK",defaultMessage:"{numFiles} files saved as Microsoft files."},{numFiles:e})},e.successMessageOneShortcut=function(e){return o.intl.formatMessage({id:"osYTsQ",defaultMessage:"{filename} saved to Google Drive."},{filename:e})},e.successMessageOneMsFile=function(e){return o.intl.formatMessage({id:"0kS6qL",defaultMessage:"{filename} saved."},{filename:e})},e.SERVER_ERROR=o.intl.formatMessage({id:"+rrsxb",defaultMessage:"Server error"}),e.srcFilesNotFound=function(e){return o.intl.formatMessage({id:"eRab3W",defaultMessage:"Source {numFiles, plural, one{file} other{files}} not found"},{numFiles:e})},e.srcFilesWrongType=function(e){return o.intl.formatMessage({id:"V0eQ4f",defaultMessage:"Source {numFiles, plural, one{file} other{files}} of the wrong type"},{numFiles:e})},e.GOOGLE_ACCOUNT_NOT_LINKED=o.intl.formatMessage({id:"Qs6YhO",defaultMessage:"Google account not linked"}),e.FOLDER_CREATION_FAILED=o.intl.formatMessage({id:"gBED0D",defaultMessage:"Folder creation failed"}),e.FIND_UNUSED_FILENAME_FAILED=o.intl.formatMessage({id:"UgrtDM",defaultMessage:"Find unused filename failed"}),e.UPLOAD_FAILED=o.intl.formatMessage({id:"MQocdR",defaultMessage:"Upload failed"}),e.GRANT_PERMISSIONS_FAILED=o.intl.formatMessage({id:"OltuRn",defaultMessage:"Grant permissions failed"}),e.CREATE_FILE_FAILED=o.intl.formatMessage({id:"8eZdXo",defaultMessage:"Create file failed"}),e.DELETE_FILE_FAILED=o.intl.formatMessage({id:"QoVCWl",defaultMessage:"Delete file failed"}),e.FIND_FOLDER_FAILED=o.intl.formatMessage({id:"6phdrE",defaultMessage:"Find folder failed"}),e.INVALID_DEST_FOLDER_MIME_TYPE=o.intl.formatMessage({id:"+DHCWS",defaultMessage:"Destination folder invalid"}),e.GOOGLE_SERVER_ERROR=o.intl.formatMessage({id:"gTHqcG",defaultMessage:"Google server error"}),e.NO_WRITE_PERMISSION=o.intl.formatMessage({id:"EYJIs6",defaultMessage:"User has no write access"}),e.singleFileFailSaveShortcut=function({filename:e,rootCause:t}){return e?o.intl.formatMessage({id:"LsI80W",defaultMessage:"{filename} couldn’t be saved to Google Drive ({rootCause})."},{filename:e,rootCause:t}):o.intl.formatMessage({id:"IYz0cM",defaultMessage:"File couldn’t be saved to Google Drive ({rootCause})."},{rootCause:t})},e.singleFileFailSaveMsFile=function({filename:e,rootCause:t}){return e?o.intl.formatMessage({id:"fvHSWo",defaultMessage:"{filename} couldn’t be saved ({rootCause})."},{filename:e,rootCause:t}):o.intl.formatMessage({id:"nARyLu",defaultMessage:"File couldn’t be saved ({rootCause})."},{rootCause:t})},e.multipleFilesPartialFailureShortcuts=function(e){return o.intl.formatMessage({id:"4UgBQ9",defaultMessage:"Some files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFullFailureShortcuts=function(e){return o.intl.formatMessage({id:"Q9gfPh",defaultMessage:"Files couldn’t be saved as shortcuts ({rootCause})."},{rootCause:e})},e.multipleFilesFullFailureMsFile=function(e){return o.intl.formatMessage({id:"O1bxfj",defaultMessage:"Files couldn’t be saved as Microsoft files ({rootCause})."},{rootCause:e})},e.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS=o.intl.formatMessage({id:"AoDCl3",defaultMessage:"Failed to get Google shortcut settings. Please try again."})}(K||(K={}));const Z=e=>"ns_path"in e?h.filename(e.ns_path):void 0,ee=async e=>{try{const t=new h.DefaultUserApiV2Client(e);return await p.GetCloudDocsRoutes(t).rpc("google_shortcut_settings/get",void 0,{})}catch{return h.Snackbar.failSticky(K.FAILED_TO_GET_GOOGLE_SHORTCUT_SETTINGS),null}},te=async({user:e,dontAskMeAgain:t,copyFilePermissions:o})=>{const n=(({dontAskMeAgain:e,copyFilePermissions:t})=>e?t?{".tag":"always"}:{".tag":"never"}:{".tag":"ask_each_time"})({dontAskMeAgain:t,copyFilePermissions:o}),s=new h.DefaultUserApiV2Client(e);try{await p.GetCloudDocsRoutes(s).rpc("google_shortcut_settings/set",{copy_permissions_to_google_shortcut:n},{})}catch{}},oe=({user:e,srcFileNames:t,targetDest:n,onUpdateCopyPermissionsSetting:s,onSubmit:i})=>{const[a,l]=g.useState(!1),[{folderName:r,folderId:c},u]=g.useState({folderName:m.Strings.MIGRATION_FOLDER});g.useEffect((()=>{var o,s,i;o=e.role,s=t.length,i=n,h.logEvent$1({class:"cloud_docs",action:"shown",object:"cloud_docs_manual_conversion_modal",properties:{accountRole:o,numFiles:s,cloudDocsManualConversionType:i}})}),[e.role,t.length,n]);const d=g.useCallback((async()=>{Q(e.role,"start");try{if(await m.ensureUserHasGddMigrationCompatibleLink(e)!==m.GddMigrationCompatibleLinkStatus.HAS_COMPATIBLE_LINK)return void Q(e.role,"canceled")}catch(e){const t=m.getUserFriendlyLinkAccountErrorMessage(e);return void(t&&h.Snackbar.failSticky(t))}try{const t=await M.chooseGdriveFolder(e);t?(Q(e.role,"success"),u(t)):Q(e.role,"canceled")}catch{Q(e.role,"failed")}}),[e]),f=()=>{h.open_tab("https://help.dropbox.com/integrations/move-google-docs")},_=g.useMemo((()=>(({srcFileNames:e,targetDest:t,dontAskMeAgain:n,folderName:s,onChangeDriveFolder:i,onSetDontAskMeAgain:a,onConvertAndCopy:l,onConvertButDontCopy:r,onLearnMore:c})=>({title:o.intl.formatMessage({id:"taJUkh",defaultMessage:"Save with sharing permissions?"}),bodyText:O.default.createElement(O.default.Fragment,null,J({srcFileNames:e,targetDest:t,folderName:s,onChangeDriveFolder:i,onLearnMore:c})),actions:O.default.createElement(O.default.Fragment,null,O.default.createElement(h.Checkbox,{id:"toggleDontAskMeAgain",checked:n,onChange:e=>a(e.currentTarget.checked),"aria-label":o.intl.formatMessage({id:"PJIYJF",defaultMessage:"Toggle don’t ask me again"})}),O.default.createElement(h.Label,{htmlFor:"toggleDontAskMeAgain"},O.default.createElement(h.Text,null,o.intl.formatMessage({id:"rI2pNz",defaultMessage:"Don’t ask me again"})))),tertiaryActions:O.default.createElement(O.default.Fragment,null,O.default.createElement(h.Button,{variant:"opacity",onClick:r},o.intl.formatMessage({id:"QzQNL5",defaultMessage:"Save without permissions"})),O.default.createElement(h.Button,{variant:"primary",onClick:l},m.Strings.SAVE)),width:"standard",withCloseButton:m.Strings.CLOSE}))({srcFileNames:t,targetDest:n,dontAskMeAgain:a,folderName:r,onChangeDriveFolder:d,onSetDontAskMeAgain:e=>l(e),onConvertAndCopy:()=>{h.Modal$1.close(),s({dontAskMeAgain:a,copyFilePermissions:!0}),q(e.role,t.length,n,"save_with_permissions",a),i({modalWasShown:!0,copyFilePermissions:!0,folderId:c})},onConvertButDontCopy:()=>{h.Modal$1.close(),s({dontAskMeAgain:a,copyFilePermissions:!1}),q(e.role,t.length,n,"save_without_permissions",a),i({modalWasShown:!0,copyFilePermissions:!1,folderId:c})},onLearnMore:f})),[t,n,a,r,d,s,e.role,i,c]);return O.default.createElement(m.ModalTemplate,{open:!0,..._,onRequestClose:()=>{var o,s,i;h.Modal$1.close(),o=e.role,s=t.length,i=n,h.logEvent$1({class:"cloud_docs",action:"dismiss",object:"cloud_docs_manual_conversion_modal",properties:{accountRole:o,numFiles:s,cloudDocsManualConversionType:i}})}})};oe.displayName="ManualConversionComponent";const ne=({user:e,srcFileNames:t,targetDest:o,copyPermissionsSetting:n,onUpdateCopyPermissionsSetting:s,onSubmit:i})=>{switch(n[".tag"]){case"always":return void i({modalWasShown:!1,copyFilePermissions:!0});case"never":return void i({modalWasShown:!1,copyFilePermissions:!1})}h.Modal$1.showInstance(O.default.createElement(oe,{user:e,srcFileNames:t,targetDest:o,onUpdateCopyPermissionsSetting:s,onSubmit:i}))},se=async({files:e,user:t,modalWasShown:o,copyFilePermissions:n,folderId:s})=>{const i="web_shortcut",a=!s,l="none";if(Y(t.role,e.length,i,o,n,a,l,"start"),!await m.ensureUserHasLinkedAccountAndReport(t))return;h.Snackbar.sync(K.pendingSaveShortcuts(e.length));const r={src_files:e.map((e=>e.file_id)),keep_original_file:!1,copy_permissions:n,dest_folder_id:s};try{const s=new h.DefaultUserApiV2Client(t),c=await p.GetCloudDocsRoutes(s).rpc("convert_to_web_shortcut_with_atf",r,{}),{success:u,task_gid:d}=c.schedule_result;if(!u)throw new Error;await ie(s,d),Y(t.role,e.length,i,o,n,a,l,"success"),((e,t)=>{t?h.Snackbar.completeSticky(K.successMessageOneShortcut(h.filename(t))):h.Snackbar.completeSticky(K.successMessageShortcuts(e.length))})(e)}catch(s){const l=((e,t)=>{let o=!1,n="server_error",s=K.SERVER_ERROR;if(t instanceof h.AppError){const i=t.error;switch(i[".tag"]){case"src_file_not_found":n="src_file_not_found",s=K.srcFilesNotFound(e.length);break;case"src_file_wrong_type":n="src_file_wrong_type",s=K.srcFilesWrongType(e.length);break;case"missing_linked_service":n="google_account_not_linked",s=K.GOOGLE_ACCOUNT_NOT_LINKED;break;case"no_write_permission":s=K.NO_WRITE_PERMISSION;break;case"external_api_error":switch(o=i.is_partial_failure,i.error_sub_type[".tag"]){case"create_folder":n="folder_creation_failed",s=K.FOLDER_CREATION_FAILED;break;case"find_unused_filename":n="find_unused_filename_failed",s=K.FIND_UNUSED_FILENAME_FAILED;break;case"upload":n="upload_failed",s=K.UPLOAD_FAILED;break;case"grant_role":n="grant_permissions_failed",s=K.GRANT_PERMISSIONS_FAILED;break;case"create_file":n="create_file_failed",s=K.CREATE_FILE_FAILED;break;case"delete_file":n="delete_file_failed",s=K.DELETE_FILE_FAILED;break;case"find_file_or_folder":n="find_folder_failed",s=K.FIND_FOLDER_FAILED;break;case"other":n="google_server_error",s=K.GOOGLE_SERVER_ERROR;break;default:S.enforceExhaustive(i.error_sub_type)}break;case"invalid_dest_folder_mime_type":n="invalid_dest_folder_mime_type",s=K.INVALID_DEST_FOLDER_MIME_TYPE}}else t instanceof Error&&t.message&&(s=t.message);if(1===e.length){const t=Z(e[0]);h.Snackbar.failSticky(K.singleFileFailSaveShortcut({filename:t,rootCause:s}))}else o?h.Snackbar.failSticky(K.multipleFilesPartialFailureShortcuts(s)):h.Snackbar.failSticky(K.multipleFilesFullFailureShortcuts(s));return n})(e,s);Y(t.role,e.length,i,o,n,a,l,"failed")}},ie=async(e,t)=>new Promise(((o,n)=>{const s=setInterval((async()=>{var i,a;try{const l=await ae(e,t);"success"===(null===(i=l.status)||void 0===i?void 0:i[".tag"])?(o(),clearInterval(s)):"fatal_failure"===(null===(a=l.status)||void 0===a?void 0:a[".tag"])&&(n(new Error(l.result)),clearInterval(s))}catch(e){clearInterval(s),n(e)}}),1e3)})),ae=async(e,t)=>p.GetCloudDocsRoutes(e).rpc("get_atf_task_status",{task_gid:t},{}),le=async({files:e,user:t,modalWasShown:o,copyFilePermissions:n})=>{const s="ms_file",i=void 0,a="none";Y(t.role,e.length,s,o,n,i,a,"start");const l=[];for(let t=0;t<e.length;t+=4){const o=e.slice(t,t+4);l.push({src_files:o.map((e=>e.file_id)),keep_original_file:!1,preserve_existing_ms_file:!0,copy_permissions:n})}h.Snackbar.sync(K.pendingSaveMsFiles(e.length));const r=new h.DefaultUserApiV2Client(t);try{const c=await Promise.all(l.map((e=>p.GetCloudDocsRoutes(r).rpc("convert_gdd_to_ms_office_file",e,{}))));Y(t.role,e.length,s,o,n,i,a,"success"),((e,t)=>{e.length>1?h.Snackbar.completeSticky(K.successMessageMultipleMsFiles(e.length)):h.Snackbar.completeSticky(K.successMessageOneMsFile(h.filename(t)))})(e,c[0].converted_files[0].dest_file_path)}catch(a){const l=((e,t)=>{let o="server_error",n=K.SERVER_ERROR;if(t instanceof h.AppError)switch(t.error[".tag"]){case"src_file_not_found":o="src_file_not_found",n=K.srcFilesNotFound(e.length);break;case"src_file_wrong_type":o="src_file_wrong_type",n=K.srcFilesWrongType(e.length);break;case"no_write_permission":n=K.NO_WRITE_PERMISSION;break;case"other":o="server_error"}if(1===e.length){const t=Z(e[0]);h.Snackbar.failSticky(K.singleFileFailSaveMsFile({filename:t,rootCause:n}))}else h.Snackbar.failSticky(K.multipleFilesFullFailureMsFile(n));return o})(e,a);Y(t.role,e.length,s,o,n,i,l,"failed")}},re=["gdoc","gslides","gsheet"],ce=(e,t)=>(o,n)=>!t.some((e=>e(o,n)))&&e(o,n),ue=r.multiFileWithExtensionSelector(["gdoc"]),de=r.multiFileWithExtensionSelector(["gslides"]),fe=r.multiFileWithExtensionSelector(["gsheet"]),ge=ce(r.multiFileWithExtensionSelector(re),[ue,de,fe]),_e=r.multiFileWithExtensionSelector(["gdoc","doc","docx"]),pe=r.multiFileWithExtensionSelector(["gslides","ppt","pptx"]),he=r.multiFileWithExtensionSelector(["gsheet","xls","xlsx"]),me=ce(r.multiFileWithExtensionSelector(re.concat(["doc","docx","ppt","pptx","xls","xlsx"])),[_e,pe,he]);var Se;!function(e){e.GOOGLE_DOC_SHORTCUT=o.intl.formatMessage({id:"CKb8d4",defaultMessage:"Google Doc shortcut"}),e.GOOGLE_SLIDES_SHORTCUT=o.intl.formatMessage({id:"f6BDMy",defaultMessage:"Google Slides shortcut"}),e.GOOGLE_SHEET_SHORTCUT=o.intl.formatMessage({id:"4dVxeR",defaultMessage:"Google Sheet shortcut"}),e.GOOGLE_FILE_SHORTCUT=o.intl.formatMessage({id:"c4laUx",defaultMessage:"Google file shortcut"}),e.MICROSOFT_DOC=o.intl.formatMessage({id:"yUBw4G",defaultMessage:"Microsoft Word"}),e.MICROSOFT_SLIDES=o.intl.formatMessage({id:"F/PKmQ",defaultMessage:"Microsoft Powerpoint"}),e.MICROSOFT_SHEET=o.intl.formatMessage({id:"wxiHoJ",defaultMessage:"Microsoft Excel"}),e.MICROSOFT_FILE=o.intl.formatMessage({id:"zNrz5l",defaultMessage:"Microsoft file"})}(Se||(Se={}));const ve=async(e,t)=>{await(async(e,t)=>{const o=await ee(t);o&&ne({user:t,srcFileNames:e.map((e=>{var t;return null!==(t=Z(e))&&void 0!==t?t:""})),targetDest:X.GOOGLE_DRIVE,copyPermissionsSetting:o.copy_permissions_to_google_shortcut,onUpdateCopyPermissionsSetting:({dontAskMeAgain:e,copyFilePermissions:o})=>{te({user:t,dontAskMeAgain:e,copyFilePermissions:o})},onSubmit:({modalWasShown:o,copyFilePermissions:n,folderId:s})=>{se({files:e,user:t,modalWasShown:o,copyFilePermissions:n,folderId:s})}})})(e,t)},Ee=async(e,t)=>{await(async(e,t)=>{const o=await ee(t);o&&ne({user:t,srcFileNames:e.map((e=>{var t;return null!==(t=Z(e))&&void 0!==t?t:""})),targetDest:X.MICROSOFT_FILE,copyPermissionsSetting:o.copy_permissions_to_google_shortcut,onUpdateCopyPermissionsSetting:({dontAskMeAgain:e,copyFilePermissions:o})=>{te({user:t,dontAskMeAgain:e,copyFilePermissions:o})},onSubmit:({modalWasShown:o,copyFilePermissions:n})=>{le({files:e,user:t,modalWasShown:o,copyFilePermissions:n})}})})(e,t)},Me=({shortcutUrl:e,...t})=>{const o=F.urlToShortcutIconAsset(e,"small");return O.default.createElement("img",{...t,src:o,alt:""})};Me.displayName="ShortcutsIcon";const Fe=[{actionText:Se.GOOGLE_DOC_SHORTCUT,actionIcon:e=>O.default.createElement(Me,{...e,shortcutUrl:"docs.google.com/document"}),selector:_e,convert:ve,actionGroup:e.ConversionActionGroup.CLOUD_DOCS},{actionText:Se.GOOGLE_SLIDES_SHORTCUT,actionIcon:e=>O.default.createElement(Me,{...e,shortcutUrl:"docs.google.com/presentation"}),selector:pe,convert:ve,actionGroup:e.ConversionActionGroup.CLOUD_DOCS},{actionText:Se.GOOGLE_SHEET_SHORTCUT,actionIcon:e=>O.default.createElement(Me,{...e,shortcutUrl:"docs.google.com/spreadsheets"}),selector:he,convert:ve,actionGroup:e.ConversionActionGroup.CLOUD_DOCS},{actionText:Se.GOOGLE_FILE_SHORTCUT,actionIcon:e=>O.default.createElement(Me,{...e,shortcutUrl:"www.google.com"}),selector:me,convert:ve,actionGroup:e.ConversionActionGroup.CLOUD_DOCS}];function Ie(e){switch(e){case 360:return{".tag":"res_360_p"};case 720:return{".tag":"res_720_p"};case 1080:return{".tag":"res_1080_p"};case 1440:return{".tag":"res_1440_p"};case 2160:return{".tag":"res_2160_p"};default:return{".tag":"unknown_res"}}}const Te=[L,w,...b,...k,...V,...x,...G,...[{actionText:Se.MICROSOFT_DOC,actionIcon:e=>O.default.createElement(j,{...e,width:14,height:14,name:"microsoft_docx"}),selector:ue,convert:Ee,actionGroup:e.ConversionActionGroup.CLOUD_DOCS},{actionText:Se.MICROSOFT_SLIDES,actionIcon:e=>O.default.createElement(j,{...e,width:14,height:14,name:"microsoft_pptx"}),selector:de,convert:Ee,actionGroup:e.ConversionActionGroup.CLOUD_DOCS},{actionText:Se.MICROSOFT_SHEET,actionIcon:e=>O.default.createElement(j,{...e,width:14,height:14,name:"microsoft_xlsx"}),selector:fe,convert:Ee,actionGroup:e.ConversionActionGroup.CLOUD_DOCS},{actionText:Se.MICROSOFT_FILE,actionIcon:c.FileLine,selector:ge,convert:Ee,actionGroup:e.ConversionActionGroup.CLOUD_DOCS}],...i.SUPPORTED_SCALE_RESOLUTIONS.map((o=>({actionText:`MP4 ${o}P`,actionIcon:d.VideoLine,selector:r.singleFileWithExtensionAndResolutionSelector(i.SUPPORTED_SEGMENT_CONCAT_EXTENSIONS,o),convert:(e,s,i)=>{const{source:a}=i,l={sequence:[{workflow_action:{".tag":"video_scale",scale:Ie(o)}}]};return n.updateSnackbar({variant:"sync",title:"Loading"}),t.convertSingleFileAsynchronously(e[0],l,a)},actionGroup:e.ConversionActionGroup.VIDEO_SCALE})))],Oe=Te.concat(...Fe);e.getConversionActionsForFiles=(e,t,o,n)=>{if(!e)return Te.filter((e=>e.selector(t,o,n)));return(I.getCloudDocsInfoFromQuery(e).gSuiteEnabled?Oe:Te).filter((e=>e.selector(t,o,n)))}}));
//# sourceMappingURL=c_flows_conversions_conversion_actions.js-vflLEd_Ic.map

//# debugId=74cc369f-2123-37aa-8dc5-542a0d1dc802