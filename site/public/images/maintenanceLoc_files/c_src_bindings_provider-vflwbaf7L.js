!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="41eb6429-894b-3f7d-b342-48d124683064")}catch(e){}}();
define(["require","exports","./e_file_viewer_static_scl_page_folder","react","./c_core_i18n","./e_data_modules_stormcrow","./c_datatypes_sharing_account-metadata","./c_shared_with_redux_store","./c_contacts_contact","./c_validators","./c_file_viewer_title_bar_title_bar_pass_ui","./c_sharing_sharing_pap_logging_send_share_invite_util","./c_dig-components_typeahead_index","./c_dig-components_chip_index","./c_dig-icons_assets_ui-icon_line_share","./c_dig-components_skeleton_index","./c_dig-icons_assets_ui-icon_line_settings","./c_dig-icons_assets_ui-icon_line_home","./c_dig-icons_assets_ui-icon_line_star","./c_react-intl_src_components_message","./c_src_common_format_bytes","./c_files_view_util","./c_pap-events_docsend_view_docsend_hub_entry_button","./c_api-v2-client_src_dropbox","react-dom","./c_api_v2_routes_password_confirmation_provider","./c_react_query_helpers_queries_login_and_register_constants","./c_flux_action_type"],(function(e,t,a,n,r,i,o,s,l,_,d,c,u,g,m,p,h,E,f,v,S,b,y,A,w,T,I,C){"use strict";function R(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var k=R(n),M=R(w);const L={".tag":"owner"},N={".tag":"viewer"},O={".tag":"editor"},x={".tag":"viewer_no_comment"},D={".tag":"other"};function P(e){return e.requested_visibility===d.RequestedVisibilityPolicy.password||e.require_password}function F(e){return e.audience_options.filter((e=>"password"===e.audience&&e.allowed)).length>0}function $(e){if(e.effective_audience)return e.effective_audience;switch(e.resolved_visibility){case"public":case"password":case"no_one":return e.resolved_visibility;case"team_only":return"team";case"team_and_password":return"password";case"shared_folder_only":case"only_you":return"no_one"}}const H={day_1:1,day_3:3,day_7:7,day_30:30,day_90:90,day_180:180,year_1:365};function B(e){return["public","password"].includes(e)}function U(e){return!!e.days_to_expire_policy&&"none"!==e.days_to_expire_policy}function V(e){return!!e.enforce_shared_link_password_policy&&"required"===e.enforce_shared_link_password_policy}function z(e){return U(e)&&!!e.change_shared_link_expiration_policy&&"not_allowed"===e.change_shared_link_expiration_policy}function j(e,t){return B(e.audience)&&(!e.expires&&z(t)||!P(t)&&V(t))}const G=(e,t)=>Boolean(!e||t);class q{static initClass(){this.ACCURACY=2,this.CODEPOINT_TO_WIDTH={32:38,33:25,34:42,35:67,36:58,37:92,38:75,39:25,40:33,41:33,42:58,43:58,44:25,45:33,46:25,47:42,48:58,49:58,50:58,51:58,52:58,53:58,54:58,55:58,56:58,57:58,58:25,59:25,60:58,61:58,62:58,63:50,64:100,65:67,66:67,67:67,68:75,69:58,70:58,71:75,72:83,73:33,74:25,75:67,76:58,77:100,78:83,79:83,80:67,81:83,82:67,83:58,84:58,85:75,86:67,87:100,88:67,89:58,90:58,91:33,92:42,93:33,94:58,95:50,96:67,97:58,98:67,99:50,100:67,101:58,102:33,103:58,104:67,105:25,106:25,107:58,108:25,109:100,110:67,111:67,112:67,113:67,114:42,115:50,116:42,117:67,118:58,119:83,120:58,121:58,122:50,123:42,124:58,125:42,126:58,161:25,162:58,163:58,164:58,165:58,166:58,167:58,168:67,169:92,170:42,171:50,172:58,174:92,175:58,176:50,177:58,178:42,179:42,180:67,181:67,182:75,183:25,184:25,185:42,186:42,187:50,188:83,189:83,190:83,191:50,192:67,193:67,194:67,195:67,196:67,197:67,198:92,199:67,200:58,201:58,202:58,203:58,204:33,205:33,206:33,207:33,208:75,209:83,210:83,211:83,212:83,213:83,214:83,215:58,216:83,217:75,218:75,219:75,220:75,221:58,222:67,223:67,224:58,225:58,226:58,227:58,228:58,229:58,230:92,231:50,232:58,233:58,234:58,235:58,236:25,237:25,238:25,239:25,240:67,241:67,242:67,243:67,244:67,245:67,246:67,247:58,248:67,249:67,250:67,251:67,252:67,253:58,254:67,255:58,256:75,257:67,258:75,259:67,260:75,261:67,262:75,263:58,264:75,265:58,266:75,267:58,268:75,269:58,270:83,271:83,272:83,273:75,274:67,275:67,276:67,277:67,278:67,279:67,280:67,281:67,282:67,283:67,284:83,285:75,286:83,287:75,288:83,289:75,290:83,291:75,292:83,293:75,294:92,295:75,296:33,297:33,298:33,299:33,300:33,301:33,302:33,303:33,304:33,305:25,306:67,307:67,308:42,309:33,310:75,311:67,312:67,313:58,314:33,315:58,316:33,317:58,318:42,319:58,320:50,321:67,322:42,323:83,324:75,325:83,326:75,327:83,328:75,329:83,330:83,331:75,332:92,333:67,334:92,335:67,336:92,337:67,338:100,339:100,340:75,341:50,342:75,343:50,344:75,345:50,346:67,347:58,348:67,349:58,350:67,351:58,352:67,353:58,354:75,355:42,356:75,357:42,358:75,359:42,360:83,361:75,362:83,363:75,364:83,365:75,366:83,367:75,368:83,369:75,370:83,371:75,372:100,373:92,374:75,375:58,376:75,377:67,378:67,379:67,380:67,381:67,382:67,383:42,384:75,385:83,386:67,387:75,388:75,389:67,390:75,391:83,392:58,393:83,394:100,395:67,396:75,397:67,398:67,399:75,400:58,401:58,402:75,403:83,404:75,405:100,406:50,407:50,408:75,409:67,410:50,411:67,412:117,413:83,414:75,415:92,416:92,417:75,418:117,419:100,420:75,421:75,422:75,423:67,424:58,425:67,426:58,427:42,428:75,429:42,430:75,431:83,432:75,433:92,434:83,435:75,436:75,437:67,438:67,439:67,440:67,441:58,442:58,443:75,444:75,445:58,446:50,447:67,448:33,449:50,450:50,451:33,452:142,453:142,454:133,455:100,456:92,457:67,458:117,459:117,460:100,461:75,462:67,463:33,464:33,465:92,466:67,467:83,468:75,469:83,470:75,471:83,472:75,473:83,474:75,475:83,476:75,477:67,478:75,479:67,480:75,481:67,482:100,483:100,484:92,485:75,486:83,487:75,488:75,489:67,490:92,491:67,492:92,493:67,494:67,495:58,496:33,497:142,498:142,499:133,500:83,501:75,502:117,503:67,504:83,505:75,506:75,507:67,508:100,509:100,510:92,511:67,512:75,513:67,514:75,515:67,516:67,517:67,518:67,519:67,520:33,521:33,522:33,523:33,524:92,525:67,526:92,527:67,528:75,529:50,530:75,531:50,532:83,533:75,534:83,535:75,536:67,537:58,538:75,539:42,540:58,541:58,542:83,543:75,544:83,545:100,546:92,547:67,548:67,549:67,550:75,551:67,552:67,553:67,554:92,555:67,556:92,557:67,558:92,559:67,560:92,561:67,562:75,563:58,564:67,565:100,566:67,567:33,568:100,569:100,570:75,571:75,572:58,573:58,574:67,575:58,576:58,577:67,578:50,579:75,580:75,581:75,582:75,583:58,584:58,585:25,586:83,587:58,588:75,589:33,590:75,591:58,880:67,881:50,882:67,883:50,884:33,885:33,886:75,887:67,888:108,889:108,890:67,891:58,892:58,893:58,894:42,895:108,896:108,897:108,898:108,899:108,900:67,901:67,902:75,903:42,904:83,905:100,906:58,907:108,908:100,909:108,910:100,911:100,912:42,913:75,914:67,915:58,916:83,917:67,918:67,919:83,920:92,921:33,922:75,923:75,924:100,925:83,926:75,927:92,928:83,929:67,930:108,931:67,932:75,933:75,934:83,935:75,936:83,937:92,938:33,939:75,940:83,941:58,942:75,943:42,944:67,945:83,946:67,947:67,948:67,949:58,950:75,951:75,952:67,953:42,954:67,955:67,956:75,957:67,958:67,959:67,960:92,961:67,962:67,963:75,964:67,965:67,966:92,967:67,968:92,969:100,970:42,971:67,972:67,973:67,974:100,975:108,976:58,977:75,978:75,979:100,980:75,981:92,982:100,983:67,984:92,985:67,986:75,987:58,988:58,989:58,990:67,991:58,992:75,993:92,994:100,995:92,996:75,997:58,998:75,999:58,1e3:75,1001:75,1002:67,1003:67,1004:83,1005:58,1006:50,1007:42,1008:67,1009:67,1010:58,1011:33,1012:92,1013:58,1014:58,1015:67,1016:67,1017:75,1018:100,1019:83,1020:58,1021:75,1022:75,1023:75,1024:67,1025:67,1026:92,1027:58,1028:75,1029:67,1030:33,1031:33,1032:42,1033:108,1034:108,1035:83,1036:75,1037:83,1038:75,1039:83,1040:75,1041:67,1042:67,1043:58,1044:83,1045:67,1046:92,1047:67,1048:83,1049:83,1050:75,1051:83,1052:100,1053:83,1054:92,1055:83,1056:67,1057:75,1058:75,1059:75,1060:83,1061:75,1062:83,1063:75,1064:108,1065:108,1066:75,1067:92,1068:67,1069:75,1070:108,1071:75,1072:67,1073:67,1074:58,1075:58,1076:75,1077:67,1078:83,1079:58,1080:75,1081:75,1082:67,1083:67,1084:83,1085:75,1086:67,1087:75,1088:75,1089:58,1090:58,1091:58,1092:92,1093:67,1094:75,1095:58,1096:92,1097:100,1098:67,1099:83,1100:58,1101:58,1102:92,1103:58,1104:67,1105:67,1106:75,1107:58,1108:58,1109:58,1110:33,1111:33,1112:42,1113:92,1114:92,1115:75,1116:67,1117:75,1118:58,1119:75,1120:100,1121:75,1122:75,1123:67,1124:83,1125:83,1126:75,1127:67,1128:100,1129:92,1130:92,1131:83,1132:117,1133:108,1134:67,1135:67,1136:83,1137:83,1138:92,1139:67,1140:83,1141:67,1142:83,1143:67,1144:133,1145:125,1146:92,1147:67,1148:100,1149:75,1150:100,1151:75,1152:75,1153:58,1154:75,1155:0,1156:0,1157:0,1158:0,1159:108,1160:0,1161:0,1162:83,1163:75,1164:67,1165:58,1166:67,1167:75,1168:58,1169:58,1170:67,1171:58,1172:75,1173:67,1174:100,1175:92,1176:67,1177:58,1178:75,1179:67,1180:83,1181:75,1182:75,1183:67,1184:83,1185:75,1186:83,1187:75,1188:100,1189:83,1190:117,1191:100,1192:92,1193:75,1194:75,1195:58,1196:75,1197:58,1198:75,1199:58,1200:75,1201:58,1202:75,1203:75,1204:100,1205:83,1206:75,1207:67,1208:75,1209:67,1210:75,1211:58,1212:92,1213:75,1214:92,1215:75,1216:33,1217:92,1218:83,1219:75,1220:67,1221:83,1222:67,1223:83,1224:75,1225:83,1226:75,1227:75,1228:58,1229:100,1230:83,1231:25,1232:75,1233:67,1234:75,1235:67,1236:100,1237:100,1238:67,1239:67,1240:75,1241:67,1242:75,1243:67,1244:92,1245:83,1246:67,1247:58,1248:67,1249:58,1250:83,1251:75,1252:83,1253:75,1254:92,1255:67,1256:92,1257:67,1258:92,1259:67,1260:75,1261:58,1262:75,1263:58,1264:75,1265:58,1266:75,1267:58,1268:75,1269:58,1270:58,1271:42,1272:92,1273:83,1274:58,1275:42,1276:75,1277:58,1278:75,1279:58,2026:67,19977:108,65403:58},this._ELLIPSIS_LENGTH=new q("…").length}static em_snippet(e,t,a){return null==t&&(t=50),null==a&&(a=.75),new q(e.toString()).snippet(t,a).toString()}constructor(e){if(!(this instanceof q))return new q(e);this.s=e,this.info=this.widthInfo(),this.length=e.length?this.info[this.s.length-1]:0}widthInfo(){const e={"-1":0};for(let t=0,a=this.s.length,n=0<=a;n?t<a:t>a;n?t++:t--)e[t]=e[t-1]+this.ems(this.s.charAt(t));return e}findSpot(e){let t;if(!e)return 0;let a=0,n=this.s.length;for(;a<=n;){t=Math.floor(a/2+n/2);const r=this.info[t-1];if(r>e)n=t-1;else{if(!(r<e))return t;a=t+1}}return a>t?a:t}ems(e){const t=e.charCodeAt(0),a=q.CODEPOINT_TO_WIDTH[t];return a?a/Math.pow(10,q.ACCURACY):768<=t&&t<=879?0:65377<=t&&t<=65500?.58:11904<=t&&t<=40911||44032<=t&&t<=55215||4352<=t&&t<=4607||63744<=t&&t<=64255||65280<=t&&t<=65535||131072<=t&&t<=196607?1.08:.65}substr(e,t){const a=this.findSpot(e);if(null!=t){let n=this.findSpot(e+t);if(n-a<this.s.length){const e=this.s.charCodeAt(n-a);65024<=e&&e<=65039&&n--}return new q(this.s.substr(a,n-a))}return new q(this.s.substr(a))}toString(){return this.s}snippet(e=50,t=.75){if(this.length<=e)return this;const a=(e-=q._ELLIPSIS_LENGTH)*t,n=e-a,r=this.length-n,i=this.substr(0,a),o=this.substr(r);return new q(i.toString()+"…"+o.toString())}}function W(e,t,a=!1){return e.filter((e=>void 0!==e.email)).map((e=>({email:e.email,checkForInvite:t,isResurface:a})))}function K(e,t,a){return[...W(e,!0),...W(a,!0,!0),...W(t,!1)]}function Y(e){return["member_invite_expand_eligibility","member_suggestion_expand_eligibility","member_invite_partial_eligibility"].includes(e)}function Q(e,t,a,n){const r=e.length>0,i=t.length>0,o=(r||n&&i)&&(function(e){return["admin_invite_after_move","admin_invite_expand_eligibility"].includes(e)}(a)||Y(a));return Boolean(o)}function Z(e){return e.ns("guest_pass")}var X;async function J(e){var t,n;const r=ee(await a.fetchViewer()),i={guest_email:e};try{return!!(await Z(r).rpc("get_invite_eligibility",i,{})).eligible}catch(e){throw new Error((null===(n=null===(t=a.filterApiError(e))||void 0===t?void 0:t.error)||void 0===n?void 0:n[".tag"])||"Unknown error")}}function ee(e){const t=e.work_user;if(!t)throw new Error("No active work user");return new a.DefaultUserApiV2Client(t)}q.initClass(),function(e){e.OFFBOARD="offboard",e.CONVERT="convert"}(X||(X={}));var te,ae;a.injectInternalStyle("/static/typescript/component_libraries/pro-ui/src/components/branding/background_chooser/background_palette.module.out-vflKmVh9U.css",(e=>"._action-button_r8kvh_1{border-radius:100%;display:inline-grid;height:var(--spacing__unit--4);margin-left:var(--spacing__unit--0_5);margin-right:var(--spacing__unit--0_5);width:var(--spacing__unit--4)}._background-palette-segment-inner_r8kvh_10{display:block;line-height:40px;padding-left:var(--spacing__unit--0_5);padding-right:var(--spacing__unit--0_5);width:200px}")),t.TypeBackground=void 0,(te=t.TypeBackground||(t.TypeBackground={})).color="color",te.image="image",te.video="video",function(e){e.MAIN="main",e.QRCODE="qrcode"}(ae||(ae={}));a.injectInternalStyle("/static/metaserver/static/js/sharing/features/shareme24/common/components/layout.module.out-vflJ0oMzz.css",(e=>"._overlay_wfnsa_1{background:var(--dig-color__background__subtle);border:.5px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__xlarge)}._click-outside_wfnsa_7{background-color:var(--dig-color__utility__overlay)}._outer-wrapper_wfnsa_11{width:360px}._inner-wrapper_wfnsa_15{padding:var(--dig-spacing__micro__small)}._button-row_wfnsa_19{box-sizing:border-box;display:flex;gap:var(--dig-spacing__micro__medium);padding:var(--dig-spacing__dimension__6);width:auto}._button-row-bmus-qr_wfnsa_27._button-row_wfnsa_19{gap:var(--dig-spacing__micro__small)}._button-row-bmus-qr_wfnsa_27._button-row_wfnsa_19 button{min-width:32px}._button-row-button-wrapper_wfnsa_36{max-width:50%;width:50%}._utility-button-row_wfnsa_41{align-items:center;justify-content:flex-end}._button-row-hidden_wfnsa_46{animation:_fade-out-row_wfnsa_1 var(--duration__micro-fast) var(--easing__transition) forwards;z-index:0}._button-row-button-wrapper-right-button-hidden_wfnsa_51{animation:_fade-out-right-button_wfnsa_1 var(--duration__micro-fast) var(--easing__transition) forwards;z-index:0}._button-row-button-wrapper-left-button-expanded_wfnsa_57{animation:_expand-out-left-button_wfnsa_1 var(--duration__micro-fast) var(--easing__transition) forwards}._footerFileOrFolderInfoContainer_wfnsa_61{padding:12px}._footerFileOrFolderInfoContainer_wfnsa_61,._redesignedFooterFileOrFolderInfoContainer_wfnsa_70{align-items:flex-start;display:flex;flex:1 0 0;flex-direction:column;justify-content:center}._redesignedFooterFileOrFolderInfoContainer_wfnsa_70{padding-left:var(--dig-spacing__micro__medium)}._footerFilerOrFolderInfo_wfnsa_79{line-height:18px;max-width:272px;width:100%}._footerFilerOrFolderInfoBmusQrCode_wfnsa_85{max-width:calc(224px - var(--dig-spacing__micro__medium))}@keyframes _fade-out-row_wfnsa_1{0%{max-height:112px;opacity:1;transform:translateY(0)}to{max-height:0;opacity:0;transform:translateY(-60px)}}@keyframes _fade-out-right-button_wfnsa_1{0%{max-width:50%;opacity:1;transform:scale(1);transform-origin:top right;width:50%}to{max-width:0;opacity:0;transform:scale(0);transform-origin:top right;width:0}}@keyframes _expand-out-left-button_wfnsa_1{0%{max-width:50%;width:50%}to{max-width:100%;width:100%}}"));const ne="_button-row-bmus-qr_wfnsa_27",re="_utility-button-row_wfnsa_41",ie="_button-row-hidden_wfnsa_46",oe="_footerFileOrFolderInfoContainer_wfnsa_61",se="_redesignedFooterFileOrFolderInfoContainer_wfnsa_70",le="_footerFilerOrFolderInfo_wfnsa_79",_e="_footerFilerOrFolderInfoBmusQrCode_wfnsa_85",de=e=>{const t=k.useRef(null),n=e.onEscape,r=k.useCallback((e=>{var a,r,i,o;if(!t.current)return;if("Shift"===e.key)return;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)&&(e.preventDefault(),e.nativeEvent.stopImmediatePropagation()),"Escape"===e.key)return n(e),e.preventDefault(),void e.nativeEvent.stopImmediatePropagation();if("Tab"===e.key){const n=t.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),s=n[0],l=n[n.length-1];return(null===(a=document.activeElement)||void 0===a?void 0:a.classList.contains("targets-tokenizer-suggestion"))||(null===(r=document.activeElement)||void 0===r?void 0:r.classList.contains("typeahead-import-contacts"))?(null===(i=document.getElementById("targets-tokenizer-input-search"))||void 0===i||i.focus(),void e.preventDefault()):(null===(o=document.activeElement)||void 0===o?void 0:o.matches("#targets-tokenizer-input-search"))&&null==t.current.querySelector("textarea")||s===l?void e.preventDefault():void(e.shiftKey?document.activeElement===s&&(e.preventDefault(),l.focus()):document.activeElement===l&&(e.preventDefault(),s.focus()))}}),[n]);return k.createElement(a.ClickOutside,{className:"_click-outside_wfnsa_7",isActive:e.isOpen,onClickOutside:e.onClickOutside},k.createElement(a.Overlay,{className:"_overlay_wfnsa_1",offsetDistance:e.offsetDistance,anchorRef:e.anchorRef,placement:e.placement,auto:!0},k.createElement("div",{ref:t,onKeyDown:r,className:"_outer-wrapper_wfnsa_11","data-test-id":"shareme24-modal"},k.createElement("div",{className:"_inner-wrapper_wfnsa_15"},e.children))))};de.displayName="Wrapper";const ce=e=>k.createElement("div",{className:`_button-row_wfnsa_19 ${e.styleName}`,"aria-hidden":e.hidden,...e},e.children);ce.displayName="ButtonRow";const ue=e=>k.createElement("div",{className:`_button-row-button-wrapper_wfnsa_36 ${e.styleName}`,"aria-hidden":e.hidden,...e},e.children);ue.displayName="ButtonRowButtonWrapper";a.injectInternalStyle("/static/metaserver/static/js/sharing/features/shareme24/common/components/buttons.module.out-vflAc-79H.css",(e=>"._base-button_73zdp_1{background:var(--dig-color__background__base);border-radius:var(--dig-radius__small);cursor:pointer;width:100%}._base-button_73zdp_1:focus-visible{box-shadow:var(--dig-utilities__boxshadow__focus-ring)!important}._horizontal-button_73zdp_13:hover:not(:disabled),._vertical-button_73zdp_18:hover:not(:disabled){box-shadow:0 16px 32px 0 rgba(0,0,0,.3)!important}._horizontal-button_73zdp_13,._vertical-button_73zdp_18{box-shadow:var(--dig-utilities__boxshadow__raised)!important;width:100%}._button-wrapper_73zdp_33{width:100%}._title-text_73zdp_37{font-family:var(--type__title__standard--fontfamily);font-size:14px;font-weight:500;line-height:24px;white-space:normal;width:100%}._vertical-button-outer-wrapper_73zdp_46{text-align:left;width:100%}._vertical-button-inner-wrapper_73zdp_51{align-items:start;display:flex;flex-direction:column;height:76px;justify-content:start;padding:var(--dig-spacing__micro__medium)}._horizontal-button-outer-wrapper_73zdp_60{text-align:left;width:100%}._horizontal-button-inner-wrapper_73zdp_65{align-items:center;display:flex;flex-direction:row;height:36px;justify-content:start;padding:var(--dig-spacing__micro__medium)}._flat-horizontal-button_73zdp_75{border-color:var(--dig-color__border__subtle);border-radius:var(--dig-radius__small);border-style:solid;border-width:2px;height:64px;width:100%}._flat-horizontal-button-outer-wrapper_73zdp_84{text-align:left;width:100%}._flat-horizontal-button-inner-wrapper_73zdp_89{align-items:center;display:flex;flex-direction:row;justify-content:start;padding:var(--dig-spacing__micro__medium)}._flat-horizontal-button_73zdp_75 ._button-icon-container_73zdp_97{flex-basis:var(--dig-spacing__dimension__24);height:var(--dig-spacing__dimension__24);margin-bottom:var(--dig-spacing__micro__small);margin-top:var(--dig-spacing__micro__small);width:var(--dig-spacing__dimension__24)}._button-icon-container_73zdp_97,._flat-horizontal-button_73zdp_75 ._button-icon-container_73zdp_97{align-items:center;background:var(--dig-color__background__subtle);border-radius:100%;color:var(--dig-color__text__base);display:flex;flex-grow:0;flex-shrink:0;justify-content:center;margin-right:var(--dig-spacing__micro__medium)}._button-icon-container_73zdp_97{flex-basis:var(--dig-spacing__dimension__36);height:var(--dig-spacing__dimension__36);width:var(--dig-spacing__dimension__36)}._base-button_73zdp_1:hover:not(:disabled) ._button-icon-container_73zdp_97{background:var(--dig-color__primary__base);color:var(--dig-color__background__base)}._button-inner-column_73zdp_135{display:flex;flex-direction:column}._base-button_73zdp_1:disabled{background:var(--dig-color__disabled__on-base);cursor:default}._base-button_73zdp_1:disabled ._button-icon-container_73zdp_97,._base-button_73zdp_1:disabled ._title-text_73zdp_37{color:var(--dig-color__disabled__base)}._base-button_73zdp_1:disabled ._button-icon-container_73zdp_97{background-color:var(--dig-color__secondary__surface)}._utility-icon-button_73zdp_154{align-items:center;display:flex;height:40px;justify-content:center;width:48px}._spacer_73zdp_162{flex:1}"));var ge=Object.freeze({__proto__:null,baseButton:"_base-button_73zdp_1",buttonIconContainer:"_button-icon-container_73zdp_97",buttonInnerColumn:"_button-inner-column_73zdp_135",buttonWrapper:"_button-wrapper_73zdp_33",default:{baseButton:"_base-button_73zdp_1",horizontalButton:"_horizontal-button_73zdp_13",verticalButton:"_vertical-button_73zdp_18",buttonWrapper:"_button-wrapper_73zdp_33",titleText:"_title-text_73zdp_37",verticalButtonOuterWrapper:"_vertical-button-outer-wrapper_73zdp_46",verticalButtonInnerWrapper:"_vertical-button-inner-wrapper_73zdp_51",horizontalButtonOuterWrapper:"_horizontal-button-outer-wrapper_73zdp_60",horizontalButtonInnerWrapper:"_horizontal-button-inner-wrapper_73zdp_65",flatHorizontalButton:"_flat-horizontal-button_73zdp_75",flatHorizontalButtonOuterWrapper:"_flat-horizontal-button-outer-wrapper_73zdp_84",flatHorizontalButtonInnerWrapper:"_flat-horizontal-button-inner-wrapper_73zdp_89",buttonIconContainer:"_button-icon-container_73zdp_97",buttonInnerColumn:"_button-inner-column_73zdp_135",utilityIconButton:"_utility-icon-button_73zdp_154",spacer:"_spacer_73zdp_162"},flatHorizontalButton:"_flat-horizontal-button_73zdp_75",flatHorizontalButtonInnerWrapper:"_flat-horizontal-button-inner-wrapper_73zdp_89",flatHorizontalButtonOuterWrapper:"_flat-horizontal-button-outer-wrapper_73zdp_84",horizontalButton:"_horizontal-button_73zdp_13",horizontalButtonInnerWrapper:"_horizontal-button-inner-wrapper_73zdp_65",horizontalButtonOuterWrapper:"_horizontal-button-outer-wrapper_73zdp_60",spacer:"_spacer_73zdp_162",titleText:"_title-text_73zdp_37",utilityIconButton:"_utility-icon-button_73zdp_154",verticalButton:"_vertical-button_73zdp_18",verticalButtonInnerWrapper:"_vertical-button-inner-wrapper_73zdp_51",verticalButtonOuterWrapper:"_vertical-button-outer-wrapper_73zdp_46"});a.injectInternalStyle("/static/metaserver/static/js/sharing/features/shareme24/common/components/redesigned-buttons.module.out-vflemu2C9.css",(e=>"._base-button_m37pl_1{background:var(--dig-color__background__base);border:1px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__large);cursor:pointer;width:100%}._base-button_m37pl_1:focus-visible{box-shadow:var(--dig-utilities__boxshadow__focus-ring)!important}._base-button_m37pl_1:hover:not(:disabled){background:var(--dig-color__secondary__surface)}._base-button_m37pl_1:active:not(:disabled){background:var(--dig-color__secondary__surface--state-1)}._button-wrapper_m37pl_30,._horizontal-button_m37pl_22,._vertical-button_m37pl_26{width:100%}._title-text_m37pl_34{color:inherit;font-family:var(--type__title__standard--fontfamily);font-size:14px;font-weight:500;line-height:24px;white-space:normal;width:100%}._vertical-button-outer-wrapper_m37pl_44{text-align:left;width:100%}._vertical-button-inner-wrapper_m37pl_49{align-items:start;display:flex;flex-direction:column;height:64px;justify-content:start;padding:var(--dig-spacing__micro__medium)}._horizontal-button-outer-wrapper_m37pl_58{text-align:left;width:100%}._horizontal-button-inner-wrapper_m37pl_63{align-items:center;display:flex;flex-direction:row;height:36px;justify-content:start;padding:var(--dig-spacing__micro__medium)}._flat-horizontal-button_m37pl_73{border-color:var(--dig-color__border__subtle);border-radius:var(--dig-radius__small);border-style:solid;border-width:2px;width:100%}._flat-horizontal-button-outer-wrapper_m37pl_81{text-align:left;width:100%}._flat-horizontal-button-inner-wrapper_m37pl_86{align-items:center;display:flex;flex-direction:row;justify-content:start;padding:var(--dig-spacing__micro__medium)}._flat-horizontal-button_m37pl_73 ._button-icon-container_m37pl_94{background:var(--dig-color__background__subtle);color:var(--dig-color__text__base);flex-basis:var(--dig-spacing__dimension__24);height:var(--dig-spacing__dimension__24);margin-bottom:var(--dig-spacing__micro__small);margin-top:var(--dig-spacing__micro__small);width:var(--dig-spacing__dimension__24)}._button-icon-container_m37pl_94,._flat-horizontal-button_m37pl_73 ._button-icon-container_m37pl_94{align-items:center;border-radius:100%;display:flex;flex-grow:0;flex-shrink:0;justify-content:center;margin-right:var(--dig-spacing__micro__medium)}._button-inner-column_m37pl_122{display:flex;flex-direction:column}._base-button_m37pl_1:disabled{color:var(--dig-color__disabled__surface);cursor:default}._utility-icon-button_m37pl_132{align-items:center;background:var(--dig-color__background__base);border:1px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__large);display:flex;flex-shrink:0;height:40px;justify-content:center;width:48px}._spacer_m37pl_144{flex:1;max-height:var(--dig-spacing__micro__large)}"));var me=Object.freeze({__proto__:null,baseButton:"_base-button_m37pl_1",buttonIconContainer:"_button-icon-container_m37pl_94",buttonInnerColumn:"_button-inner-column_m37pl_122",buttonWrapper:"_button-wrapper_m37pl_30",default:{baseButton:"_base-button_m37pl_1",buttonWrapper:"_button-wrapper_m37pl_30",horizontalButton:"_horizontal-button_m37pl_22",verticalButton:"_vertical-button_m37pl_26",titleText:"_title-text_m37pl_34",verticalButtonOuterWrapper:"_vertical-button-outer-wrapper_m37pl_44",verticalButtonInnerWrapper:"_vertical-button-inner-wrapper_m37pl_49",horizontalButtonOuterWrapper:"_horizontal-button-outer-wrapper_m37pl_58",horizontalButtonInnerWrapper:"_horizontal-button-inner-wrapper_m37pl_63",flatHorizontalButton:"_flat-horizontal-button_m37pl_73",flatHorizontalButtonOuterWrapper:"_flat-horizontal-button-outer-wrapper_m37pl_81",flatHorizontalButtonInnerWrapper:"_flat-horizontal-button-inner-wrapper_m37pl_86",buttonIconContainer:"_button-icon-container_m37pl_94",buttonInnerColumn:"_button-inner-column_m37pl_122",utilityIconButton:"_utility-icon-button_m37pl_132",spacer:"_spacer_m37pl_144"},flatHorizontalButton:"_flat-horizontal-button_m37pl_73",flatHorizontalButtonInnerWrapper:"_flat-horizontal-button-inner-wrapper_m37pl_86",flatHorizontalButtonOuterWrapper:"_flat-horizontal-button-outer-wrapper_m37pl_81",horizontalButton:"_horizontal-button_m37pl_22",horizontalButtonInnerWrapper:"_horizontal-button-inner-wrapper_m37pl_63",horizontalButtonOuterWrapper:"_horizontal-button-outer-wrapper_m37pl_58",spacer:"_spacer_m37pl_144",titleText:"_title-text_m37pl_34",utilityIconButton:"_utility-icon-button_m37pl_132",verticalButton:"_vertical-button_m37pl_26",verticalButtonInnerWrapper:"_vertical-button-inner-wrapper_m37pl_49",verticalButtonOuterWrapper:"_vertical-button-outer-wrapper_m37pl_44"});const pe=({children:e,useRedesignedStyle:t})=>{const a=t?me:ge;return k.createElement("div",{className:a.buttonIconContainer},e)};pe.displayName="ButtonIconContainer";const he=({children:e,useRedesignedStyle:t,...n})=>{const r=t?me:ge;return k.createElement(a.StylelessButton,{className:`${r.baseButton} ${r.verticalButton}`,...n},k.createElement("div",{className:r.verticalButtonOuterWrapper},k.createElement("div",{className:r.verticalButtonInnerWrapper},e)))};he.displayName="VerticalButton";const Ee=({children:e,useRedesignedStyle:t,...n})=>{const r=t?me:ge;return k.createElement(a.StylelessButton,{className:`${r.baseButton} ${r.horizontalButton}`,...n},k.createElement("div",{className:r.horizontalButtonOuterWrapper},k.createElement("div",{className:r.horizontalButtonInnerWrapper},e)))};Ee.displayName="HorizontalButton";const fe=({children:e,useRedesignedStyle:t,...n})=>{const r=t?me:ge;return k.createElement(a.StylelessButton,{className:`${r.baseButton} ${r.flatHorizontalButton}`,...n},k.createElement("div",{className:r.flatHorizontalButtonOuterWrapper},k.createElement("div",{className:r.flatHorizontalButtonInnerWrapper},e)))};fe.displayName="HorizontalFlatButton";const ve=k.forwardRef(((e,t)=>{const a=e.useRedesignedStyle?me:ge;return k.createElement("div",{className:a.buttonWrapper,...e,ref:t},e.children)}));ve.displayName="ButtonWrapper";const Se=({children:e,useRedesignedStyle:t})=>{const a=t?me:ge;return k.createElement("div",{className:a.buttonInnerColumn},e)};Se.displayName="ButtonInnerColumn";const be=k.forwardRef(((e,t)=>{const n=e.useRedesignedStyle?me:ge;return k.createElement(a.IconButton,{className:n.utilityIconButton,variant:"transparent",...e,ref:t},e.children)}));be.displayName="UtilityIconButton";const ye=({children:e,useRedesignedStyle:t})=>{const n=t?me:ge;return k.createElement(a.Text,{size:"medium",isBold:!0,className:n.titleText},e)};ye.displayName="Title";const Ae=({useRedesignedStyle:e})=>{const t=e?me:ge;return k.createElement("div",{className:t.spacer})};Ae.displayName="Spacer";function we(e){return{class:"sharing_sender",action:"select",object:"flexible_sharing_entrypoint_action",properties:e}}function Te(e){return{class:"sharing_sender",action:"hover",object:"flexible_sharing_entrypoint_action",properties:e}}function Ie(e){return{class:"sharing_sender",action:"log",object:"flexible_sharing_entrypoint_action_dwell_time",properties:e}}const Ce=a.defineContext(null),Re=e=>e||{actionSurface:"unspecified",actionElement:"unspecified",tiburonOrigin:"unspecified",contentAction:"unspecified"},ke=e=>e||{},Me=new Map,Le=e=>{const t=Me.get(e);if(t)return t;const n=a.getFileTypeFromString(e.split(".").slice(-1)[0]);return Me.set(e,n),n},Ne=a.defineContext(null),Oe=e=>e?"file"===e.type?{sharedObjType:"file",fileType:Le(e.name)||"unresolved",isDir:"false"}:"file_folder"===e.type?{sharedObjType:"file_folder",fileType:"folder",isDir:"true"}:"shared_folder"===e.type?{sharedObjType:"shared_folder",fileType:"folder",isDir:"true"}:a.exhausts(e,{sharedObjType:"fallthrough",fileType:"fallthrough",isDir:"fallthrough"}):{sharedObjType:"unspecified",fileType:"unspecified",isDir:"unspecified"},xe=e=>{if(e){if("file"===e.type){const t=Le(e.name);return{sharedObjType:"file",fileType:t,fileExtension:t,isDir:!1}}return"file_folder"===e.type?{sharedObjType:"folder",isDir:!0}:"shared_folder"===e.type?{sharedObjType:"shared_folder",isDir:!0}:a.exhausts(e[".tag"],{})}return{}},De=a.defineContext(null),Pe=e=>e?"file"===e[".tag"]||"file_folder"===e[".tag"]||"shared_folder"===e[".tag"]||"link_only"===e[".tag"]||"collection"===e[".tag"]?{}:a.exhausts(e[".tag"],{}):{},Fe=e=>e?"file"===e[".tag"]?{contentIdentifier:e.id}:"file_folder"===e[".tag"]||"shared_folder"===e[".tag"]||"link_only"===e[".tag"]||"collection"===e[".tag"]?{contentIdentifier:e.folder_id}:a.exhausts(e[".tag"],{}):{},$e=Symbol("ON_CLICK"),He=Symbol("ON_MOUSE_ENTER"),Be=Symbol("ON_MOUSE_LEAVE"),{useEmitter:Ue,defaultEmitter:Ve}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o={...Re(n),...Oe(r),...Pe(i)},s={...ke(n),...xe(r),...Fe(i)};if(e.key===$e)return a.UDCL.logEvent(we({...s,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"copy_link"}}),void a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"copy_link"}});e.key!==He?e.key!==Be||a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"copy_link"}}):a.UDCL.logEvent(Te({...s,flexibleSharingEntryPointAction:"copy_link"}),{tags:{...o,action:"copy_link"}})})),ze=({store:e})=>{const t=Ue(),n=k.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,n=Date.now()-e.$componentViewTime.get();t.select($e).emit({dwellTime:a,timeSinceView:n}),e.$isHovered.set(!1),e.$props.get().onClickCopyLinkButton()}),[t,e]),i=k.useCallback((()=>{t.select(He).emit(null),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[t,e]),o=k.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(Be).emit({dwellTime:a}),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[t,e]);k.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const s=e.$props.get().useRedesignedStyle;return k.createElement(k.Fragment,null,k.createElement(ve,{onMouseEnter:i,onMouseLeave:o,useRedesignedStyle:s},k.createElement(he,{onClick:n,"data-testid":"copy-link-button",useRedesignedStyle:s},k.createElement(pe,{useRedesignedStyle:s},k.createElement(a.UIIcon,{src:a.LinkLine,size:"medium","data-testid":"copy-link-icon"})),k.createElement(Ae,{useRedesignedStyle:s}),k.createElement(Se,{useRedesignedStyle:s},k.createElement(ye,{useRedesignedStyle:s},k.createElement(a.Truncate,{lines:2},r.intl.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"})))))))};ze.displayName="LoadedButton";const je=({store:e})=>k.createElement(ze,{store:e});je.displayName="Inner";const Ge=e=>{const t=(e=>a.useInitStore(e,(e=>({$props:e,$isHovered:a.store(!1),$hoverStartTime:a.store(0),$componentViewTime:a.store(0)}))))(e);return k.createElement(je,{store:t})};Ge.displayName="CopyLinkButton";const qe=k.createContext(new A.Dropbox({})),We=({sdk:e,children:t})=>k.createElement(qe.Provider,{value:e},t);We.displayName="DropboxSdkProvider";const Ke=(...e)=>{},Ye=a.SHARE_ACTION_ORIGIN_TYPE.SHARING_SDK_SANDBOX,Qe=(...e)=>(...t)=>{e.forEach((e=>{try{e(...t)}catch(e){}}))},Ze=k.createContext({sink:Ke,metadata:{},origin:Ye,actionInfo:void 0}),Xe=({sink:e,children:t,origin:a,actionInfo:n})=>{const r=k.useMemo((()=>({sink:e,metadata:{},origin:a,actionInfo:n})),[e,a,n]);return k.createElement(Ze.Provider,{value:r},t)};Xe.displayName="Provider";const Je=()=>{const e=k.useContext(Ze);return k.useCallback(((t,a)=>{const n={type:t,payload:a};e.sink(n,e.metadata,e.origin,e.actionInfo)}),[e])},et=({children:e,...t})=>{const a=k.useContext(Ze),[n]=k.useState({sink:a.sink,metadata:{},origin:a.origin,actionInfo:a.actionInfo});return n.metadata={...a.metadata,...t},k.createElement(Ze.Provider,{value:n},e)};et.displayName="MetadataProvider";const tt=e=>{const t=k.useContext(qe),a=Je();if("standard"===e.type){const n=k.useMemo((()=>e.fetch(t)),[e,t]);return k.useCallback((async t=>{const r=Math.random().toString();a("ENDPOINT_FETCH_BEGIN",{name:e.name,input:t,id:r});const i=Date.now(),o=await n(t),s=Date.now();return a("ENDPOINT_FETCH_END",{name:e.name,id:r,latency:s-i,response:o}),o}),[n,e,a])}{const t=e.useFetch();return k.useCallback((async n=>{const r=Math.random().toString();a("ENDPOINT_FETCH_BEGIN",{name:e.name,input:n,id:r});const i=Date.now(),o=await t(n),s=Date.now();return a("ENDPOINT_FETCH_END",{name:e.name,id:r,latency:s-i,response:o}),o}),[t,e,a])}};var at;!function(e){e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.FATAL="FATAL"}(at||(at={}));const nt=a.isObjectOf({status:a.isNumber,headers:a.isUnknown,error:a.isObjectOf({error:a.isObjectOf({".tag":a.isString})})}),rt=a.isObjectOf({status:a.isNumber}),it=async e=>{try{const t=await e;return{status:at.SUCCESS,output:t.result}}catch(e){const t=e;return nt(t)?{status:at.ERROR,error:t.error.error,statusCode:t.status}:rt(e)?{status:at.FATAL,statusCode:e.status,error:e}:{status:at.FATAL,error:e}}},ot=(e,t)=>({name:e.name,fetch:t,type:"standard"}),st=ot({name:"sharing.alphaGetFileMetadata"},(e=>t=>it(e.sharingAlphaGetFileMetadata(t)))),lt=ot({name:"sharing.alphaGetFolderMetadata"},(e=>t=>it(e.sharingAlphaGetFolderMetadata(t)))),_t=ot({name:"sharing.validateFolderPathV2"},(e=>async t=>it(e.sharingValidateFolderPathV2(t)))),dt=ot({name:"collections.getAllCollections"},(e=>t=>it(e.collectionsGetAllCollections(t)))),ct=["change_options","disable_viewer_info","edit_contents","enable_viewer_info","invite_editor","invite_viewer","invite_viewer_no_comment","unshare","update_confidentiality","relinquish_membership"].map((e=>({".tag":e}))),ut=["change_options","create_edit_link","create_link","create_view_link","disable_viewer_info","edit_contents","enable_viewer_info","invite_editor","invite_viewer","invite_viewer_no_comment","relinquish_membership","remove_download_policy","set_download_policy","share_link","share_message_as_comment","unshare"].map((e=>({".tag":e}))),gt=["change_options","create_link","disable_viewer_info","edit_contents","enable_viewer_info","invite_editor","invite_viewer","invite_viewer_no_comment","relinquish_membership","remove_download_policy","set_download_policy","share_link","leave_a_copy","set_access_inheritance","unmount","unshare","update_confidentiality"].map((e=>({".tag":e}))),mt=["change_options","create_link","disable_viewer_info","edit_contents","enable_viewer_info","invite_editor","invite_viewer","invite_viewer_no_comment","relinquish_membership","remove_download_policy","set_download_policy","share_link","leave_a_copy","set_access_inheritance","unmount","unshare","update_confidentiality"].map((e=>({".tag":e}))),pt=["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"].map((e=>({".tag":e}))),ht=a.isObjectOf({path_lower:a.isString,is_confidential:a.isBoolean,is_inside_team_folder:a.isBoolean}),Et={name:{name:"sharing.proxy.getObjectMetadata"}.name,useFetch:()=>{const e=tt(st),t=tt(lt),a=tt(_t),n=tt(dt);return k.useCallback((async r=>{var i,o,s,l,_,d;if("file"===r[".tag"]){const t=await e({file:r.fileId,actions:ut});return"SUCCESS"===t.status?{...t,output:{...t.output,".tag":"file"}}:t}if("file_folder"===r[".tag"]){const e=await a({path:r.path,actions:ct,list_members_arg:{actions:pt},confidentiality:{".tag":"not_confidential"}});if("SUCCESS"===e.status)return{...e,output:{...e.output,".tag":"file_folder",name:r.name}};if("ERROR"===e.status){if("no_permission"===e.error[".tag"]&&(d=e.error,ht(d))){const t={...e.error,name:r.name,".tag":"file_folder"};return{status:at.SUCCESS,output:t}}if("too_many_mounts_v2"===e.error[".tag"]){const t=e.error.too_many_mounts_v2;if("total_mounts_exceeded"===t[".tag"]||"home_mounts_exceeded"===t[".tag"]||"tree_size_exceeded"===t[".tag"]){const e={...t.metadata,name:r.name,".tag":"link_only",tooManyMountsError:t};return{status:at.SUCCESS,output:e}}}else if("bad_path"===e.error[".tag"]){const t=e.error.bad_path;if("is_family"===t[".tag"]||"contains_app_folder"===t[".tag"]||"is_app_folder"===t[".tag"]||"inside_app_folder"===t[".tag"]){const e={...Object.fromEntries(Object.entries(t).filter((([e])=>".tag"!==e))),name:r.name,".tag":"link_only"};return{status:at.SUCCESS,output:e}}}}return e}if("shared_folder"===r[".tag"]){const e=await t({shared_folder_id:r.sharedFolderId,actions:gt});return"SUCCESS"===e.status?{...e,output:{...e.output,".tag":"shared_folder"}}:e}if("collection"===r[".tag"]){const[e,a]=await Promise.all([t({shared_folder_id:r.nsId,actions:mt}),n({collection_type_filter:[{".tag":"manual"}]})]);if("SUCCESS"!==e.status)return e;if("SUCCESS"!==a.status)return a;const d=null===(i=a.output.collection_infos)||void 0===i?void 0:i.find((e=>e.id===r.collectionId)),c=(null==d?void 0:d.cover_photo_thumbnail)?null==d?void 0:d.cover_photo_thumbnail:null===(_=null===(l=null===(s=null===(o=null==d?void 0:d.sample_collection_items)||void 0===o?void 0:o[0])||void 0===s?void 0:s.target_file)||void 0===l?void 0:l.file_info)||void 0===_?void 0:_.thumbnail_url_tmpl;return{status:at.SUCCESS,output:{".tag":"collection",...e.output,collectionId:r.collectionId,thumbnailSrc:c}}}return{status:at.ERROR,error:{".tag":"invalid_object"},statusCode:0}}),[e,t,a,n])},type:"proxy"};const ft=Symbol("ON_INITIAL_LOAD_START"),vt=Symbol("ON_INITIAL_LOAD_FAILURE"),St=Symbol("ON_INITIAL_LOAD_CANCEL"),bt=Symbol("ON_INITIAL_LOAD_SUCCESS"),yt=Symbol("ON_FOLDER_ALREADY_SHARED"),{useEmitter:At,defaultEmitter:wt}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o=Fe(i).contentIdentifier,s={...Re(n),...Oe(r),...Pe(i)};if(e.key!==ft)if(e.key!==vt)e.key!==St?e.key!==bt?e.key!==yt||a.UDCL.logEvent("ops.sm24.already_shared",{tags:s}):a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"success",key:o,tags:s}):a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"canceled",key:o,tags:s});else{let t="none";if("response"in e.payload.error)try{const a=e.payload.error.response.error;".tag"in a&&(t=a[".tag"]||"none")}catch(e){t="loggingFailure"}a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"failed",key:o,tags:{...s,errorType:e.payload.error.type,errorTag:t}})}else a.UDCL.logStart("ops.sm24.initial_data_load",{key:o,tags:s})})),Tt=e=>{const t=tt(Et),n=At();return k.useCallback((async()=>{const r=e.$nonce.get(),o=e.$options.get(),s=e.$state.get();let l=o.objectIdentifier;"loaded"===s.status&&(l=s.objectIdentifier),n.select(ft).emit(null);const _=t=>{e.$state.set({status:"error",errorType:"INITIAL_LOAD_ERROR",loadError:t}),n.select(vt).emit({error:t})},d=new Promise((async e=>{const a=await t(l);if("file_folder"===l[".tag"]){if("SUCCESS"===a.status){const t=a.output;return l={".tag":"file_folder",name:l.name,path:l.path,parentSharedFolderId:t.parent_shared_folder_id},void e(Promise.resolve(a))}if("ERROR"===a.status&&"bad_path"===a.error[".tag"]&&"already_shared"===a.error.bad_path[".tag"])return l={".tag":"shared_folder",sharedFolderId:a.error.bad_path.shared_folder_id},e(t(l)),void n.select(yt).emit(null)}e(Promise.resolve(a))})),c=await a.getSharingApiv2ResponseWithErrors(a.sharingPrefsPackage.fetchQuery(i.queryClient,{})),u=await a.getSharingApiv2ResponseWithErrors(a.sharingAccountInfoPackage.fetchQuery(i.queryClient,{})),g=await i.queryClient.fetchQuery(["object-metadata",o.objectIdentifier],(()=>d));r===e.$nonce.get()?"SUCCESS"===u.status&&"SUCCESS"===g.status&&"SUCCESS"===c.status?(e.$state.set({status:"loaded",objectIdentifier:l,memberActionsInProgress:{},memberAccountIdsAlreadyFetched:{},accountMetadata:u.output,memberAccounts:{},objectMetadata:g.output,sharingPrefs:c.output}),n.select(bt).emit(null)):"SUCCESS"!==g.status?"ERROR"===g.status?_({type:"METADATA_ERROR",response:g}):_({type:"METADATA_FATAL",response:g}):"SUCCESS"!==c.status?"ERROR"===c.status?_({type:"SHARING_PREFS_ERROR",response:c}):_({type:"SHARING_PREFS_FATAL",response:c}):"SUCCESS"!==u.status?_({type:"SHARING_ACCOUNT_INFO_ERROR"}):_({type:"OTHER"}):n.select(St).emit(null)}),[e,t,n])},It=e=>{const t=tt(Et),a=(e=>k.useCallback((t=>{(e.$options.get().onRefreshError||(()=>{}))(t)}),[e]))(e);return k.useCallback((async()=>{const n=e.$state.get();if("loaded"!==n.status)return;const r=e.$nonce.get(),i=await t(n.objectIdentifier),o=e.$state.get();return e.$nonce.get()!==r||"loaded"!==o.status?null:"ERROR"===i.status?(a({type:"METADATA_ERROR",response:i}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"METADATA_ERROR",response:i}})):"FATAL"===i.status?(a({type:"FATAL",response:i}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"FATAL",response:i}})):(e.$state.set({...o,objectMetadata:i.output}),null)}),[e,t,a])},Ct=e=>"file"===e[".tag"]?e.fileId:"file_folder"===e[".tag"]?e.path:"shared_folder"===e[".tag"]?`ns:${e.sharedFolderId}`:`ns:${e.nsId}`,Rt=e=>{const t=Tt(e),[n,r]=k.useState(null);k.useEffect((()=>{const i=(e=>null===e.sessionId?null:"file"===e.objectIdentifier[".tag"]?`file:${e.sessionId}:${Ct(e.objectIdentifier)}`:"file_folder"===e.objectIdentifier[".tag"]?`folder:${e.sessionId}:${Ct(e.objectIdentifier)}`:`shared_folder:${e.sessionId}:${Ct(e.objectIdentifier)}`)(e.$options.get());if(null===i)return null!==n&&r(null),void("unloaded"!==e.$state.get().status&&a.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"unloaded"})})));i===n&&"unloaded"!==e.$state.get().status||(a.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"loading"})})),r(i),t())}))},kt=e=>{const t=It(e),n=Tt(e),r=(e=>k.useCallback((t=>{const a=e.$state.get();"loaded"===a.status&&(e.$state.set({...a,objectIdentifier:t}),i.queryClient.invalidateQueries({queryKey:["object-metadata"]}))}),[e]))(e),o=a.useStore(e.$state);return k.useMemo((()=>({...o,refreshObjectMetadata:t,refreshModal:n,onObjectIdentifierChanged:r})),[o,t,n,r])},Mt=e=>{const t=(e=>a.useInitStore(e,(e=>({$nonce:a.store(0),$options:e,$state:a.store({status:"unloaded"})}))))(e);return Rt(t),(e=>{k.useEffect((()=>()=>{a.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"unloaded"})}))}),[])})(t),kt(t)},Lt=({children:e,...t})=>{const a=Mt(t);return k.createElement(k.Fragment,null,e(a))};Lt.displayName="ShareModalDataLoader";const Nt=k.createContext({status:"unloaded"}),Ot=({children:e,...t})=>k.createElement(Lt,{...t},(t=>k.createElement(Nt.Provider,{value:t},e)));Ot.displayName="Provider";const xt=()=>k.useContext(Nt);function Dt({message:e,variant:t}){if(!e)return null;const n="error"===t?"alert":"attention";return k.createElement(a.Banner,{type:n},k.createElement(a.Banner.Message,{className:"scl-sharing-modal-validation-warning__message"},e))}const Pt=({teamName:e,parentFolderName:t,isRestoreAccessEnabled:n,onRestoreAccessClick:i})=>{const o=r.useIntl(),s=k.useCallback((()=>{i(e)}),[e,i]),l=""!==t?o.formatMessage({id:"KG/fFv",defaultMessage:"This folder isn’t shared with everyone who has access to parent folder <b>{parent}</b>."},{parent:t,b:e=>k.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}):o.formatMessage({id:"kIOCH3",defaultMessage:"This folder isn’t shared with everyone on {team_name}."},{team_name:q.em_snippet(e,a.SNIPPET_SIZES.DISPLAY_NAME)}),_=o.formatMessage({id:"96XDs/",defaultMessage:"Share with everyone"});return k.createElement(a.Banner,{withLeftIcon:k.createElement(a.UIIcon,{src:a.InfoLine})},k.createElement(a.Banner.Message,null,k.createElement(a.Text,null,l,n&&" ",n&&k.createElement(a.Button,{"aria-label":_,key:"restore access",variant:"transparent",size:"medium",onClick:s,style:{fontFamily:"var(--type__body__standard--fontfamily)",fontWeight:"var(--type__body__standard--fontweight_strong)",fontSize:"var(--type__body__standard--fontsize)",letterSpacing:0}},_))))};Pt.displayName="ConfidentialFolderSection";const Ft=ot({name:"users.setSharingPrefs"},(e=>t=>it(e.usersSetSharingPrefs(t)))),$t="https://help.dropbox.com/files-folders/share/shared-folder-faq#cantcreate",Ht=e=>e.formatMessage({id:"RYuEPZ",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),Bt=e=>e.formatMessage({id:"c7+ulZ",defaultMessage:"This email isn’t on your Dropbox team."}),Ut=e=>e.formatMessage({id:"YxKEkv",defaultMessage:"One or more names or email addresses you entered are invalid."}),Vt=e=>e.formatMessage({id:"LKdcDm",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),zt=e=>e.formatMessage({id:"mvBmmQ",defaultMessage:"This email isn’t on your Dropbox team."}),jt=e=>e.formatMessage({id:"0IC8VF",defaultMessage:"You don’t have permission to share with some of these people."}),Gt=e=>e.formatMessage({id:"8tC+2X",defaultMessage:"Only groups can be added to team folders."}),qt=e=>e.formatMessage({id:"UrkgWp",defaultMessage:"You don’t have permission to share with some of these people due to restrictions on their end."}),Wt=e=>e.formatMessage({id:"uZEjQr",defaultMessage:"Some of the targets are invalid."}),Kt=e=>e.formatMessage({id:"KxgNgG",defaultMessage:"Add message (optional)"}),Yt=e=>e.formatMessage({id:"30bVmM",defaultMessage:"Add a note"}),Qt=e=>e.formatMessage({id:"Qd1iC2",defaultMessage:"Sharing..."}),Zt=(e,t,a)=>a&&"public"===a[".tag"]?"editor"===t[".tag"]?(e=>e.formatMessage({id:"jAzCAz",defaultMessage:"can edit"}))(e):(e=>e.formatMessage({id:"wZejJ8",defaultMessage:"can view"}))(e):"editor"===t[".tag"]?(e=>e.formatMessage({id:"GKgRRt",defaultMessage:"can edit"}))(e):(e=>e.formatMessage({id:"eCFw0p",defaultMessage:"can view"}))(e),Xt=e=>e.formatMessage({id:"nf2M+i",defaultMessage:"There was a problem completing this request."}),Jt=e=>e.formatMessage({id:"PbG9/M",defaultMessage:"You don’t have access to this content."}),ea=e=>e.formatMessage({id:"ktVMZy",defaultMessage:"Your team settings don’t allow sharing outside your team."}),ta=e=>e.formatMessage({id:"ccjg/d",defaultMessage:"You entered an invalid name or email address."}),aa=e=>e.formatMessage({id:"KWUYO4",defaultMessage:"You’ve hit the limit of invites for today. Try again later."}),na=e=>e.formatMessage({id:"CTRWVL",defaultMessage:"You don’t have permission to do this. Contact the owner."}),ra=e=>e.formatMessage({id:"xoQiJt",defaultMessage:"You haven’t verified your email. Check your email and try again."}),ia=e=>e.formatMessage({id:"kJSilf",defaultMessage:"Couldn’t share, but it might work if you reload the page and try again."}),oa=e=>e.formatMessage({id:"ZA1r4s",defaultMessage:"You need a upgrade your account to do this."}),sa=e=>e.formatMessage({id:"ebZyPl",defaultMessage:"You’re sharing with too many people."}),la=e=>e.formatMessage({id:"Bcojaq",defaultMessage:"Contact support"}),_a=(e,t)=>e.formatMessage({id:"0UrAT5",defaultMessage:"Couldn’t create shared folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t}),da=e=>e.formatMessage({id:"/sRvdA",defaultMessage:"Folder updates in progress — please try again later."}),ca=(e,t,n)=>{const r=n.name,i=a.getParentFolderName(n);return t?e.formatMessage({id:"5xCeTo",defaultMessage:"Removing members from <strong>{folderName}</strong>…"},{folderName:q.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>k.createElement("strong",null,e)}):""===i?e.formatMessage({id:"90I244",defaultMessage:"Sharing <strong>{folderName}</strong> with everyone…"},{folderName:q.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>k.createElement("strong",null,e)}):e.formatMessage({id:"16RnmU",defaultMessage:"Sharing <strong>{folderName}</strong> with members of <strong>{parentFolderName}</strong>…"},{folderName:q.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:q.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>k.createElement("strong",null,e)})},ua=(e,t,n)=>{const r=n.name,i=a.getParentFolderName(n);return t?e.formatMessage({id:"7POTZF",defaultMessage:"Members removed from <strong>{folderName}</strong>."},{folderName:q.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>k.createElement("strong",null,e)}):void 0===i||""===i?e.formatMessage({id:"nni9pE",defaultMessage:"<strong>{folderName}</strong> shared with everyone."},{folderName:q.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>k.createElement("strong",null,e)}):e.formatMessage({id:"qvP8A+",defaultMessage:"<strong>{folderName}</strong> shared with members of <strong>{parentFolderName}</strong>."},{folderName:q.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:q.em_snippet(i,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>k.createElement("strong",null,e)})},ga=(e,t)=>t?e.formatMessage({id:"1HgFQB",defaultMessage:"Couldn’t remove members. Try again."}):e.formatMessage({id:"ypun4U",defaultMessage:"Couldn’t share folder. Try sharing again."}),ma=e=>e.formatMessage({id:"B/Ja4o",defaultMessage:"Undo"}),pa="share-modal-evolution-access-level-dropdown",ha=`${pa}__audience-text`,Ea=`${pa}__unportaled-menu`,fa=({store:e})=>{const t=r.useIntl(),n=a.useStore(e.$canPerformAnyEditLinkActions),i=a.useStore(e.$canPerformAnyViewLinkActions),o=a.useStore(e.$objectMetadata),s=a.useStore(e.$linkAccessLevel),l="link_only"===o[".tag"],_=a.useStore(e.$isInviteSending),d=(!l&&n?1:0)+(i?1:0),c=(e=>{const t=Je();return k.useCallback((a=>{const n=e.$linkAccessLevel.get();t("SHARE_MODAL_SHARE__LINK_ACCESS_LEVEL__CHANGE",{previous:n,next:{".tag":a}}),e.$linkAccessLevel.set({".tag":a})}),[e,t])})(e);return k.createElement(a.Box,{className:a.cx([`${pa}`,d>1?`${pa}__with-menu`:void 0]),borderRadius:"Small",style:{minWidth:"auto",display:"flex",whiteSpace:"pre-wrap",flexWrap:"wrap",alignItems:"center"},"data-testid":"access-level-dropdown"},k.createElement(a.Text,{className:ha,"data-testid":"link-audience",color:_?"disabled":"standard",size:"small"},(e=>e.formatMessage({id:"OGm4kF",defaultMessage:"People added"}))(t)," "),1===d?k.createElement(a.Text,{className:ha,isBold:!0,size:"small",color:_?"disabled":"standard"},"editor"===s[".tag"]?Zt(t,a.EDITOR):Zt(t,a.VIEWER)):k.createElement(a.Menu.Wrapper,{onSelection:c,isPortaled:!1,style:{verticalAlign:"bottom",whiteSpace:"nowrap"},className:Ea},(({getContentProps:e,getTriggerProps:r})=>k.createElement(k.Fragment,null,k.createElement(a.Button,{...r(),variant:"transparent",withDropdownIcon:!0,size:"small",style:{marginTop:"1px",position:"relative"},disabled:_},"editor"===s[".tag"]?Zt(t,a.EDITOR):Zt(t,a.VIEWER)),k.createElement(a.Menu.Content,{"data-sharing-sdk":"1",...e(),placement:"bottom-end"},k.createElement(a.Menu.Segment,null,i?k.createElement(a.Menu.SelectItem,{key:"view",value:"viewer",selected:"editor"!==s[".tag"]},k.createElement(a.Text,null,Zt(t,a.VIEWER))):null,n?k.createElement(a.Menu.SelectItem,{key:"edit",value:"editor",selected:"editor"===s[".tag"]},k.createElement(a.Text,null,Zt(t,a.EDITOR))):null))))))};fa.displayName="AccessLevelDropdown";const va=ot({name:"sharing.validateTargets"},(e=>t=>it(e.sharingTargetsValidate(t)))),Sa=e=>a.create("email",{email:e}),ba=e=>"user"===e[".tag"]?""===e.dbx_account_id?`EMAIL:${e.email}`:`DBX_ID:${e.dbx_account_id}`:"group"===e[".tag"]?`DBX_ID:${e.group_id}`:"email"===e[".tag"]?`EMAIL:${e.email}`:a.exhausts(e,"UNKNOWN"),ya=e=>"user"===e[".tag"]&&e.photo_url||null,Aa=(e,t)=>"user"===e[".tag"]||"email"===e[".tag"]?e.email:"group"===e[".tag"]?t.formatMessage({id:"XMHn5C",defaultMessage:"{count, plural, one{# member} other{# members}}"},{count:e.group_size||0}):"",wa=e=>"email"===e[".tag"]?{".tag":"email",email:e.email}:"group"===e[".tag"]?{".tag":"dropbox_id",dropbox_id:e.group_id}:"user"===e[".tag"]?""===e.dbx_account_id?{".tag":"email",email:e.email}:{".tag":"dropbox_id",dropbox_id:e.dbx_account_id}:{".tag":"other"},Ta=e=>"dropbox_id"===e[".tag"]?`DBX_ID:${e.dropbox_id}`:"email"===e[".tag"]?`EMAIL:${e.email}`:"other"===e[".tag"]?"OTHER":a.exhausts(e,"UNKNOWN"),Ia=e=>e.reduce(((e,t)=>({[Ta(t.member)]:t,...e})),{}),Ca=e=>{const t=(e=>{const t=tt(va),n=Je();return k.useCallback((async()=>{const r=e.$inviteTargets.get();if(0===r.length)return void e.$inviteTargetValidations.set({});const i=e.$linkAccessLevel.get(),o=e.$objectMetadata.get(),s=e.$inviteTargetsWithInvalidEmails.get().reduce(((e,t)=>({...e,[ba(t)]:{member:wa(t),result:{".tag":"disallowed",disallowed:{".tag":"invalid_member"}},target_invite_eligibility:{".tag":"other"}}})),{});if(e.$inviteTargetValidations.set({...e.$inviteTargetValidations.get(),...s}),0===e.$inviteTargetsWithValidEmails.get().length)return;const l=Object.values(e.$inviteTargetValidations.get()).map((e=>e?Ta(e.member):null)),_=e.$inviteTargetsWithValidEmails.get().filter((e=>{const t=Ta(wa(e));return!l.includes(t)}));if(0===_.length)return;const d=a.getIsFile(o)?"file":"folder",c=e.$objectIdentifierId.get();n("SHARE_MODAL_SHARE__PREVALIDATION__API_START",null);const u=await t({access_level:i,content_id:c,content_type:{".tag":d},members:_.map(wa)});if("ERROR"===u.status)return void n("SHARE_MODAL_SHARE__PREVALIDATION__API_ERROR",{error:u.error});if("FATAL"===u.status)return void n("SHARE_MODAL_SHARE__PREVALIDATION__API_FATAL",{error:u.error});n("SHARE_MODAL_SHARE__PREVALIDATION__API_SUCCESS",null);const g=e.$inviteTargets.get(),m=e.$linkAccessLevel.get(),p=e.$objectMetadata.get(),h=Ct(e.$objectIdentifier.get());r===g&&i===m&&c===h&&o===p&&e.$inviteTargetValidations.set({...e.$inviteTargetValidations.get(),...Ia(u.output.results)})}),[e,t,n])})(e);k.useEffect((()=>{const a=[e.$inviteTargets.obs(t),e.$linkAccessLevel.obs((()=>{t()})),e.$objectIdentifierId.obs((()=>{e.$inviteTargetValidations.set({}),t()}))];return e.$props.get().inviteTargets.length>0&&t(),()=>a.forEach((e=>e()))}),[e,t])},Ra=(e,t)=>({options:e,useAction:t}),ka=(e,t)=>({success:!1,type:e,value:t}),Ma=(e,t)=>({success:!0,type:e,value:t}),La=e=>({success:!1,type:"TypeExhaustion",value:{value:e}}),Na=e=>({success:!1,type:"UncaughtException",value:{error:e}}),Oa=e=>{const t=e.options.name,a=e.useAction(),n=Je();return k.useCallback((async e=>{let r;n("ACTION__START",{name:t,input:e});try{r=await a(e)}catch(e){r=Na(e)}return n("ACTION__COMPLETE",{name:t,input:e,output:r}),r}),[n,a,t])},xa=ot({name:"sharing.set_access_inheritance"},(e=>t=>it(e.sharingSetAccessInheritance(t)))),Da=(e,t)=>{const a=(null==t?void 0:t.timeout)||1e4,n=(null==t?void 0:t.interval)||1e3;return new Promise((t=>{const r=setTimeout((()=>t({status:"TIMEOUT"})),a),i=async()=>{try{const a=await e();if("COMPLETE"===a.status)return clearTimeout(r),void t(a);setTimeout(i,n)}catch(e){clearTimeout(r),t({status:"ERROR",error:e})}};i()}))},Pa=ot({name:"sharing.checkShareInternalJobStatus"},(e=>t=>it(e.sharingCheckShareInternalJobStatus(t)))),Fa=Ra({name:"CheckSetAccessInheritanceJobStatus"},(()=>{const e=tt(Pa);return k.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?ka("NetworkFailure",{response:a}):"ERROR"===a.status?ka("ApiError",{response:a}):"in_progress"===a.output[".tag"]?Ma("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?ka("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?Ma("Complete",{response:{...a,output:a.output}}):La(a.output)}),[e])})),$a=Ra({name:"PollCheckSetAccessInheritanceJobStatus"},(()=>{const e=Oa(Fa);return k.useCallback((async({asyncJobId:t,timeout:a,interval:n})=>{const r=await Da((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:n});return"TIMEOUT"===r.status?ka("Timeout",null):"ERROR"===r.status?Na(r.error):r.output.success?Ma("Complete",r.output.value):r.output}),[e])})),Ha=Ra({name:"SetAccessInheritance"},(()=>{const e=tt(xa),t=Oa($a);return k.useCallback((async({setAccessInheritanceArg:a,timeout:n,interval:r})=>{const i=await e(a);if("ERROR"===i.status)return ka("ApiError",{response:i});if("FATAL"===i.status)return ka("NetworkFailure",{response:i});if("complete"===i.output[".tag"])return Ma("Complete",{response:{...i,output:i.output}});if("async_job_id"!==i.output[".tag"])return La(i.output);const o=await t({asyncJobId:i.output.async_job_id,timeout:n,interval:r});return o.success?Ma("PollingComplete",o.value):"ApiError"===o.type?ka("PollingApiError",o.value):"NetworkFailure"===o.type?ka("PollingNetworkFailure",o.value):"Failed"===o.type?ka("PollingFailed",o.value):"Timeout"===o.type?ka("PollingTimeout",o.value):o}),[e,t])})),Ba=ot({name:"sharing.share_folder"},(e=>t=>it(e.sharingAlphaShareFolder(t)))),Ua=Ra({name:"CheckShareFileFolderJobStatus"},(()=>{const e=tt(Pa);return k.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?ka("NetworkFailure",{response:a}):"ERROR"===a.status?ka("ApiError",{response:a}):"in_progress"===a.output[".tag"]?Ma("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?ka("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?Ma("Complete",{response:{...a,output:a.output}}):La(a.output)}),[e])})),Va=Ra({name:"PollCheckShareFileFolderJobStatus"},(()=>{const e=Oa(Ua);return k.useCallback((async({asyncJobId:t,timeout:a,interval:n})=>{const r=await Da((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:n});return"TIMEOUT"===r.status?ka("Timeout",null):"ERROR"===r.status?Na(r.error):r.output.success?Ma("Complete",r.output.value):r.output}),[e])})),za=Ra({name:"ShareFileFolder"},(()=>{const e=tt(Ba),t=Oa(Va);return k.useCallback((async({path:a,confidentiality:n,timeout:r,interval:i})=>{const o=await e({path:a,confidentiality:n});if("ERROR"===o.status)return ka("ApiError",{response:o});if("FATAL"===o.status)return ka("NetworkFailure",{response:o});if("complete"===o.output[".tag"])return Ma("Complete",{response:{...o,output:o.output}});if("async_job_id"!==o.output[".tag"])return La(o.output);const s=await t({asyncJobId:o.output.async_job_id,timeout:r,interval:i});return s.success?Ma("PollingComplete",s.value):"ApiError"===s.type?ka("PollingApiError",s.value):"NetworkFailure"===s.type?ka("PollingNetworkFailure",s.value):"Failed"===s.type?ka("PollingFailed",s.value):"Timeout"===s.type?ka("PollingTimeout",s.value):s}),[e,t])}));const ja=e=>window.open(e,"_blank"),Ga=k.createContext(ja),qa=({openUrl:e,children:t})=>k.createElement(Ga.Provider,{value:e},t);qa.displayName="Provider";const Wa=()=>{const e=k.useContext(Ga);return k.useCallback((t=>{e(t)}),[e])};var Ka;t.Platforms=void 0,(Ka=t.Platforms||(t.Platforms={})).SANDBOX="SANDBOX",Ka.METASERVER="METASERVER",Ka.PAPER="PAPER",Ka.DESKTOP="DESKTOP",Ka.MS_TEAMS="MS_TEAMS",Ka.MS_TEAMS_MOBILE="MS_TEAMS_MOBILE";const Ya=k.createContext(t.Platforms.SANDBOX),Qa=({platform:e,children:t})=>k.createElement(Ya.Provider,{value:e},t);Qa.displayName="Provider";const Za=()=>k.useContext(Ya),Xa=e=>e.formatMessage({id:"0NA7+K",defaultMessage:"Close"}),Ja=()=>{const e=r.useIntl(),n=tn(),i=Wa(),o=Za()===t.Platforms.DESKTOP,s=o?{style:{position:"absolute",bottom:-13,left:0,right:0,borderRadius:0}}:{};return{showCompleted:t=>n((n=>k.createElement(a.Snackbar$1,{...n,...s,timeout:o?0:void 0},k.createElement(a.UIIcon,{src:a.CheckmarkLine}),k.createElement(a.Snackbar$1.Message,null,t.message),t.actionMessage&&t.actionOnClick&&k.createElement(a.Snackbar$1.Actions,null,k.createElement(a.Button,{variant:"transparent",onClick:t.actionOnClick},t.actionMessage)),k.createElement(a.Snackbar$1.Actions,null,k.createElement(a.Button,{variant:"transparent",onClick:n.onRequestClose},Xa(e)))))),showInProgress:e=>n((t=>k.createElement(a.Snackbar$1,{...t,...s,timeout:0},k.createElement(a.Spinner,{size:"small"}),k.createElement(a.Snackbar$1.Message,null,e.message)))),showFailure:t=>n((n=>{const r=function(e){const t=window.document.createElement("a");t.href=e;let a=t.protocol||window.location.protocol;":"===t.protocol&&(a=window.location.protocol);const n=t.hostname||window.location.hostname;let r=t.port||window.location.port;"443"===r&&"https:"===a&&(r="");let i=n;return r&&(i=i+":"+r),a+"//"+i+(0===t.pathname.indexOf("/")?t.pathname:`/${t.pathname}`)+t.search+t.hash}(t.helpUrl||""),l=k.useCallback((()=>{i(r)}),[r]);return k.createElement(a.Snackbar$1,{...n,...s,timeout:o?0:void 0},k.createElement(a.UIIcon,{src:a.FailLine}),k.createElement(a.Snackbar$1.Message,null,t.message),k.createElement(a.Snackbar$1.Actions,null,t.helpMessage&&t.helpUrl?k.createElement(a.Button,{variant:"transparent",onClick:l},t.helpMessage):null,k.createElement(a.Button,{variant:"transparent",onClick:n.onRequestClose},Xa(e))))}))}},en=k.createContext({store:{$item:a.store(null),$props:a.store({})}}),tn=()=>{const{store:e}=k.useContext(en);return t=>{var a,n;null===(n=(a=e.$props.get()).onSnackbarShownChange)||void 0===n||n.call(a,!0);const r=Math.random().toString();return e.$item.set({key:r,Snackbar:t}),()=>{var t,a;const n=e.$item.get();n&&n.key===r&&(e.$item.set(null),null===(a=(t=e.$props.get()).onSnackbarShownChange)||void 0===a||a.call(t,!1))}}},an=()=>{const e=r.useIntl(),t=(()=>{const e=r.useIntl(),t=tn();return k.useCallback((n=>t((t=>k.createElement(a.Snackbar$1,{...t},k.createElement(a.Snackbar$1.Message,null,n),k.createElement(a.Snackbar$1.Actions,null,k.createElement(a.Button,{variant:"transparent",inverse:!0},Xa(e))))))),[e,t])})();return k.useCallback((()=>t(e.formatMessage({id:"+iNJRS",defaultMessage:"There was a problem completing this request."}))),[e,t])},nn=()=>{const{store:e}=k.useContext(en),t=a.useStore(e.$item),n=(e=>{const{store:t}=k.useContext(en);return k.useCallback((()=>{var a,n;const r=t.$item.get();r&&r.key===e&&(t.$item.set(null),null===(n=(a=t.$props.get()).onSnackbarShownChange)||void 0===n||n.call(a,!1))}),[t,e])})(t?t.key:"");return t?M.createPortal(k.createElement("div",{key:t.key,style:{position:"fixed",display:"flex",zIndex:2e4,width:"100%",bottom:"1em",justifyContent:"center"},"data-sharing-sdk":"1"},k.createElement(t.Snackbar,{style:{flexGrow:1},key:t.key,open:!0,onRequestClose:n})),document.body):null},rn=({children:e,onSnackbarShownChange:t})=>{const n=a.useInitStore({onSnackbarShownChange:t},(e=>({$item:a.store(null),$props:e}))),r=k.useMemo((()=>({store:n})),[n]);return k.createElement(en.Provider,{value:r},k.createElement(k.Fragment,null,e,k.createElement(nn,null)))};rn.displayName="Provider";const on={".tag":"public"},sn={".tag":"team_only"},ln={".tag":"password"},_n={".tag":"team_and_password"},dn={".tag":"shared_folder_only"},cn={".tag":"no_one"},un={".tag":"only_you"},gn={".tag":"other"},mn={".tag":"day_1"},pn={".tag":"day_180"},hn={".tag":"day_3"},En={".tag":"day_30"},fn={".tag":"day_7"},vn={".tag":"day_90"},Sn={".tag":"none"},bn={".tag":"year_1"},yn={".tag":"other"},An={".tag":"allowed"},wn={".tag":"not_allowed"},Tn={".tag":"other"},In={".tag":"optional"},Cn={".tag":"required"},Rn={".tag":"other"},kn={".tag":"admin_invite_expand_eligibility"},Mn={".tag":"member_suggestion_expand_eligibility"},Ln={".tag":"member_invite_expand_eligibility"},Nn={".tag":"member_invite_partial_eligibility"},On={".tag":"not_enabled"},xn=e=>!!e.confidential_folder_links_enabled,Dn={".tag":"anyone"},Pn={".tag":"team"},Fn={".tag":"team_and_approved"},$n={".tag":"other"},Hn={".tag":"from_team_only"},Bn={".tag":"from_anyone"},Un={".tag":"other"},Vn={".tag":"default_public"},zn={".tag":"default_team_only"},jn={".tag":"team_only"},Gn={".tag":"default_no_one"},qn={".tag":"other"},Wn={".tag":"admins_and_members"},Kn={".tag":"admins_only"},Yn={".tag":"members"},Qn={".tag":"anyone"},Zn={".tag":"other"},Xn={".tag":"optional"},Jn={".tag":"required"},er={".tag":"other"},tr={".tag":"day_1"},ar={".tag":"day_180"},nr={".tag":"day_3"},rr={".tag":"day_30"},ir={".tag":"day_7"},or={".tag":"day_90"},sr={".tag":"none"},lr={".tag":"year_1"},_r={".tag":"other"},dr={".tag":"default"},cr={".tag":"edit"},ur={".tag":"view"},gr=e=>"email"===e[".tag"]?l.Contact.buildFromRawEmail(e.email):"group"===e[".tag"]?new l.Contact({type:a.ContactTypes.NEW_STYLE_GROUP,dbx_team_id:e.dbx_team_id,members:e.members,name:e.name,group_id:e.group_id,group_size:e.group_size}):"user"===e[".tag"]?e.dbx_account_id?new l.Contact({type:a.ContactTypes.EMAIL,dbx_team_id:e.dbx_team_id,...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,invalid:!_.validateEmail(e.email),dbx_account_id:e.dbx_account_id,email:e.email}):l.Contact.buildFromRawEmail(e.email):a.exhausts(e,l.Contact.buildFromRawEmail("")),mr=e=>"invalid"===e.state?{".tag":"disallowed",disallowed:{".tag":"other"}}:"ok"===e.state?"NOT_DROPBOX_USER"===e.msg?{".tag":"allowed",allowed:{".tag":"not_dropbox_user"}}:{".tag":"allowed",allowed:{".tag":"no_warning"}}:"warn"===e.state?e.msg===a.CONTACT_ERROR_MESSAGES.OUT_OF_TEAM?{".tag":"allowed",allowed:{".tag":"outside_of_team"}}:{".tag":"allowed",allowed:{".tag":"other"}}:{".tag":"other"},pr=e=>"owner"===e?L:"reader"===e?N:"writer"===e?O:"reader_no_comment"===e?x:D,hr=e=>void 0===e?a.OTHER:"editor"===e?a.EDITOR:"viewer"===e?a.VIEWER:a.exhausts(e,a.OTHER),Er=e=>"public"===e?on:"team_only"===e?sn:"password"===e?ln:void 0,fr=e=>"public"===e?a.PUBLIC:"team"===e?a.TEAM:"password"===e?a.PASSWORD:"no_one"===e?a.NO_ONE:a.OTHER$1,vr=e=>{var t,a,n,r,i,o,s,l,_,d,c,u,g;const m=[];return void 0===e||(void 0!==(null===(t=e.change_options)||void 0===t?void 0:t.allow)&&m.push({action:{".tag":"change_options"},allow:e.change_options.allow}),void 0!==(null===(a=e.disable_viewer_info)||void 0===a?void 0:a.allow)&&m.push({action:{".tag":"disable_viewer_info"},allow:e.disable_viewer_info.allow}),void 0!==(null===(n=e.edit_contents)||void 0===n?void 0:n.allow)&&m.push({action:{".tag":"edit_contents"},allow:e.edit_contents.allow}),void 0!==(null===(r=e.enable_viewer_info)||void 0===r?void 0:r.allow)&&m.push({action:{".tag":"enable_viewer_info"},allow:e.enable_viewer_info.allow}),void 0!==(null===(i=e.invite_editor)||void 0===i?void 0:i.allow)&&m.push({action:{".tag":"invite_editor"},allow:e.invite_editor.allow}),void 0!==(null===(o=e.invite_viewer)||void 0===o?void 0:o.allow)&&m.push({action:{".tag":"invite_viewer"},allow:e.invite_viewer.allow}),void 0!==(null===(s=e.invite_viewer_no_comment)||void 0===s?void 0:s.allow)&&m.push({action:{".tag":"invite_viewer_no_comment"},allow:e.invite_viewer_no_comment.allow}),void 0!==(null===(l=e.leave_a_copy)||void 0===l?void 0:l.allow)&&m.push({action:{".tag":"leave_a_copy"},allow:e.leave_a_copy.allow}),void 0!==(null===(_=e.relinquish_membership)||void 0===_?void 0:_.allow)&&m.push({action:{".tag":"relinquish_membership"},allow:e.relinquish_membership.allow}),void 0!==(null===(d=e.update_confidentiality)||void 0===d?void 0:d.allow)&&m.push({action:{".tag":"update_confidentiality"},allow:e.update_confidentiality.allow}),void 0!==(null===(c=e.unmount)||void 0===c?void 0:c.allow)&&m.push({action:{".tag":"unmount"},allow:e.unmount.allow}),void 0!==(null===(u=e.unshare)||void 0===u?void 0:u.allow)&&m.push({action:{".tag":"unshare"},allow:e.unshare.allow}),void 0!==(null===(g=e.create_link)||void 0===g?void 0:g.allow)&&m.push({action:{".tag":"create_link"},allow:e.create_link.allow})),m},Sr=e=>{var t,a,n,r,i,o,s,l,_,d,c,u,g,m,p;const h=[];return void 0===e||(void 0!==(null===(t=e.create_edit_link)||void 0===t?void 0:t.allow)&&h.push({action:{".tag":"create_edit_link"},allow:e.create_edit_link.allow}),void 0!==(null===(a=e.create_view_link)||void 0===a?void 0:a.allow)&&h.push({action:{".tag":"create_view_link"},allow:e.create_view_link.allow}),void 0!==(null===(n=e.change_options)||void 0===n?void 0:n.allow)&&h.push({action:{".tag":"change_options"},allow:e.change_options.allow}),void 0!==(null===(r=e.disable_viewer_info)||void 0===r?void 0:r.allow)&&h.push({action:{".tag":"disable_viewer_info"},allow:e.disable_viewer_info.allow}),void 0!==(null===(i=e.edit_contents)||void 0===i?void 0:i.allow)&&h.push({action:{".tag":"edit_contents"},allow:e.edit_contents.allow}),void 0!==(null===(o=e.enable_viewer_info)||void 0===o?void 0:o.allow)&&h.push({action:{".tag":"enable_viewer_info"},allow:e.enable_viewer_info.allow}),void 0!==(null===(s=e.invite_viewer)||void 0===s?void 0:s.allow)&&h.push({action:{".tag":"invite_viewer"},allow:e.invite_viewer.allow}),void 0!==(null===(l=e.invite_editor)||void 0===l?void 0:l.allow)&&h.push({action:{".tag":"invite_editor"},allow:e.invite_editor.allow}),void 0!==(null===(_=e.invite_viewer_no_comment)||void 0===_?void 0:_.allow)&&h.push({action:{".tag":"invite_viewer_no_comment"},allow:e.invite_viewer_no_comment.allow}),void 0!==(null===(d=e.relinquish_membership)||void 0===d?void 0:d.allow)&&h.push({action:{".tag":"relinquish_membership"},allow:e.relinquish_membership.allow}),void 0!==(null===(c=e.remove_download_policy)||void 0===c?void 0:c.allow)&&h.push({action:{".tag":"remove_download_policy"},allow:e.remove_download_policy.allow}),void 0!==(null===(u=e.set_download_policy)||void 0===u?void 0:u.allow)&&h.push({action:{".tag":"set_download_policy"},allow:e.set_download_policy.allow}),void 0!==(null===(g=e.unshare)||void 0===g?void 0:g.allow)&&h.push({action:{".tag":"unshare"},allow:e.unshare.allow}),void 0!==(null===(m=e.create_link)||void 0===m?void 0:m.allow)&&h.push({action:{".tag":"create_link"},allow:e.create_link.allow}),void 0!==(null===(p=e.share_message_as_comment)||void 0===p?void 0:p.allow)&&h.push({action:{".tag":"share_message_as_comment"},allow:e.share_message_as_comment.allow})),h},br=(e,t,a)=>{var n,r,i,o,s,l,_,d;if(void 0===e)throw new Error("Adapter error.");if(e.isFolder()){if(e.isNewSharedFolder()){const n=e;return{".tag":"file_folder",access_type:pr(e.access_type),is_inside_team_folder:t,is_team_folder:a,owner_team:n.owner_team,parent_shared_folder_id:n.parent_shared_folder_id?String(n.parent_shared_folder_id):void 0,path_lower:n.path_lower,parent_folder_name:n.parent_folder_name,...void 0!==n.is_confidential?{is_confidential:n.is_confidential}:{},name:e.name,policy:{member_policy:n.policy.member_policy?{".tag":n.policy.member_policy}:void 0,resolved_member_policy:n.policy.resolved_member_policy?{".tag":n.policy.resolved_member_policy}:void 0,acl_update_policy:n.policy.acl_update_policy?{".tag":n.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:n.policy.shared_link_policy?{".tag":n.policy.shared_link_policy}:{".tag":"other"},viewer_info_policy:n.policy.viewer_info_policy?{".tag":n.policy.viewer_info_policy}:void 0},permissions:vr(e.permissions),members_cursor:e.members_cursor,owner_team_policies:yr(n.owner_team_policies),folder_id:n.folder_id}}{const r=e;return{".tag":"shared_folder",access_type:pr(e.access_type),is_inside_team_folder:t,is_team_folder:a,owner_team:r.owner_team,parent_shared_folder_id:r.parent_shared_folder_id?String(r.parent_shared_folder_id):void 0,path_lower:r.path_lower,parent_folder_name:r.parent_folder_name,...void 0!==r.is_confidential?{is_confidential:r.is_confidential}:{},name:e.name,permissions:vr(e.permissions),policy:{member_policy:r.policy.member_policy?{".tag":r.policy.member_policy}:void 0,resolved_member_policy:r.policy.resolved_member_policy?{".tag":r.policy.resolved_member_policy}:void 0,acl_update_policy:r.policy.acl_update_policy?{".tag":r.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:r.policy.shared_link_policy?{".tag":r.policy.shared_link_policy}:{".tag":"other"},download_policy:r.policy.download_policy?{".tag":r.policy.download_policy}:{".tag":"other"},viewer_info_policy:r.policy.viewer_info_policy?{".tag":r.policy.viewer_info_policy}:void 0},preview_url:r.preview_url||"",shared_folder_id:r.shared_folder_id.toString(),time_invited:(null===(n=r.time_invited)||void 0===n?void 0:n.toString())||"",folder_size:r.folder_size,can_mount:r.can_mount,invite_info:r.invite_info,owner_team_policies:yr(r.owner_team_policies),is_encrypted:r.is_encrypted,folder_id:r.folder_id}}}{const t=e;return{".tag":"file",access_type:pr(t.access_type),download_policy:{".tag":"other"},id:t.id,name:t.name,owner_team:t.owner_team,parent_shared_folder_id:t.parent_shared_folder_id?String(t.parent_shared_folder_id):void 0,path_display:t.path_display,path_lower:t.path_lower,permissions:Sr(t.permissions),policy:{member_policy:(null===(r=t.policy)||void 0===r?void 0:r.member_policy)?{".tag":t.policy.member_policy}:void 0,resolved_member_policy:(null===(i=t.policy)||void 0===i?void 0:i.resolved_member_policy)?{".tag":t.policy.resolved_member_policy}:void 0,acl_update_policy:(null===(o=t.policy)||void 0===o?void 0:o.acl_update_policy)?{".tag":t.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:(null===(s=t.policy)||void 0===s?void 0:s.shared_link_policy)?{".tag":t.policy.shared_link_policy}:{".tag":"other"},download_policy:(null===(l=t.policy)||void 0===l?void 0:l.download_policy)?{".tag":t.policy.download_policy}:{".tag":"other"},viewer_info_policy:(null===(_=t.policy)||void 0===_?void 0:_.viewer_info_policy)?{".tag":t.policy.viewer_info_policy}:void 0},preview_url:t.preview_url||"",time_invited:null===(d=t.time_invited)||void 0===d?void 0:d.toString(),is_cloud_doc:t.is_cloud_doc,owner_team_policies:yr(t.owner_team_policies)}}},yr=e=>{if(e)return{shared_folder_member_policy:Ar(e.shared_folder_member_policy),shared_folder_join_policy:wr(e.shared_folder_join_policy),shared_link_create_policy:Tr(e.shared_link_create_policy),group_creation_policy:Ir(e.group_creation_policy),shared_folder_link_restriction_policy:Cr(e.shared_folder_link_restriction_policy),enforce_link_password_policy:Rr(e.enforce_link_password_policy),default_link_expiration_days_policy:kr(e.default_link_expiration_days_policy),shared_link_default_permissions_policy:Mr(e.shared_link_default_permissions_policy)}},Ar=e=>{switch(e){case"team":return Pn;case"team_and_approved":return Fn;case"other":return $n;default:return Dn}},wr=e=>{switch(e){case"from_team_only":return Hn;case"other":return Un;default:return Bn}},Tr=e=>{switch(e){case"default_team_only":return zn;case"team_only":return jn;case"default_no_one":return Gn;case"other":return qn;default:return Vn}},Ir=e=>"admins_only"===e?Kn:Wn,Cr=e=>{switch(e){case"members":return Yn;case"other":return Zn;default:return Qn}},Rr=e=>{switch(e){case"required":return Jn;case"other":return er;default:return Xn}},kr=e=>{switch(e){case"day_1":return tr;case"day_180":return ar;case"day_3":return nr;case"day_30":return rr;case"day_7":return ir;case"day_90":return or;case"year_1":return lr;case"other":return _r;default:return sr}},Mr=e=>{switch(e){case"default":default:return dr;case"edit":return cr;case"view":return ur}},Lr=e=>{switch(e){case a.LinkAudienceDisallowedReason.DeleteAndRecreate:return a.DISALLOWED_REASON_DELETE_AND_RECREATE;case a.LinkAudienceDisallowedReason.RestrictedBySharedFolder:return a.DISALLOWED_REASON_RESTRICTED_BY_SHARED_FOLDER;case a.LinkAudienceDisallowedReason.RestrictedByTeam:return a.DISALLOWED_REASON_RESTRICTED_BY_TEAM;case a.LinkAudienceDisallowedReason.UserAccountType:return a.DISALLOWED_REASON_USER_ACCOUNT_TYPE;case a.LinkAudienceDisallowedReason.UserNotOnTeam:return a.DISALLOWED_REASON_USER_NOT_ON_TEAM;case a.LinkAudienceDisallowedReason.PermissionDenied:return a.DISALLOWED_REASON_PERMISSION_DENIED;default:return}},Nr=e=>{if(void 0!==e)return e.map((e=>({audience:fr(e.audience),allowed:e.allowed,disallowed_reason:Lr(e.disallowed_reason)})))},Or=e=>{switch(e){case"day_1":return mn;case"day_180":return pn;case"day_3":return hn;case"day_30":return En;case"day_7":return fn;case"day_90":return vn;case"none":return Sn;case"year_1":return bn;case"other":return yn;default:return}},xr=e=>{switch(e){case"allow":return An;case"not_allowed":return wn;case"other":return Tn;default:return}},Dr=e=>{switch(e){case"optional":return In;case"required":return Cn;case"other":return Rn;default:return}},Pr=e=>({id:e.id,name:e.name}),Fr=e=>{switch(e){case"admin_invite_expand_eligibility":return kn;case"member_suggestion_expand_eligibility":return Mn;case"member_invite_expand_eligibility":return Ln;case"member_invite_partial_eligibility":return Nn;default:return On}};function $r(e){return{class:"sharing_sender",action:"initiate",object:"post_share_action",properties:e}}const Hr=Symbol("ON_SHOW_ADMIN_INVITE_AFTER_SHARING_MODAL"),Br=Symbol("ON_SHOW_GUEST_PASS_ADMIN_INVITE_AFTER_SHARING_MODAL"),Ur=Symbol("ON_SHOW_MEMBER_INVITE_AFTER_SHARING_MODAL"),{useEmitter:Vr,defaultEmitter:zr}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o={...Re(n),...Oe(r),...Pe(i),isSm24:"true"};e.key!==Hr?e.key!==Br?e.key!==Ur||a.UDCL.logEvent($r({postShareAction:"member_invite_after_sharing_modal",numInviteEligibleUsers:e.payload.numInviteEligibleUsers}),{tags:o}):a.UDCL.logEvent($r({postShareAction:"guest_pass_admin_invite_after_sharing_modal",numInviteEligibleUsers:e.payload.numInviteEligibleUsers}),{tags:o}):a.UDCL.logEvent($r({postShareAction:"admin_invite_after_sharing_modal",numInviteEligibleUsers:e.payload.numInviteEligibleUsers}),{tags:o})})),jr=()=>{const t=a.useGetContextValue(),{variant:n}=a.useExperimentVariant("sm24_invite_after_sharing"),r=Vr();return k.useCallback((async a=>{var i,o;if(Wr(a.objectIdentifier,a.objectMetadata),"ON"!==n)return;const{inviteEligibleNotSeenContacts:s,inviteEligibleSeenContacts:l}=qr(a.inviteTargets,a.targetsValidateResult),_=K(s,l,[]),d=null===(i=a.sharingPrefs.invite_after_sharing_modal_variant)||void 0===i?void 0:i[".tag"];if(d&&Q(s,[],d,!1)){const n=null===(o=t(Ce))||void 0===o?void 0:o.tiburonOrigin;if("admin_invite_expand_eligibility"===d)if(1===_.length){const t=_[0],a=Date.now(),i=async function(){const{showGuestPassAdminInviteAfterSharingModal:t}=await new Promise((function(t,a){e(["./c_modals_guest_pass_guest_pass_admin_invite_after_sharing_modal"],t,a)}));return t}(),o=Gr();J(t.email).then((e=>{e?i.then((e=>{r.select(Br).emit({numInviteEligibleUsers:_.length}),e({eligibleUser:t,modalOrigin:n})})):o.then((e=>{r.select(Hr).emit({numInviteEligibleUsers:_.length}),e({eligibleUsers:_,adminModalVariant:d,modalOrigin:n,modalLoadingStartTime:a})}))}))}else{const e=Date.now();Gr().then((t=>{r.select(Hr).emit({numInviteEligibleUsers:_.length}),t({eligibleUsers:_,adminModalVariant:d,modalOrigin:n,modalLoadingStartTime:e})}))}else if(Y(d)){const t=Date.now(),i=a.sharingPrefs.num_available_licenses;(async function(){const{showMemberInviteAfterSharingModal:t}=await new Promise((function(t,a){e(["./c_modals_invite_after_sharing_member_invite_after_sharing_modal"],t,a)}));return t})().then((e=>{r.select(Ur).emit({numInviteEligibleUsers:_.length}),e({eligibleUsers:_,memberModalVariant:d,sharingOrigin:n,modalLoadingStartTime:t,numAvailableLicenses:i})}))}}}),[t,n,r])};async function Gr(){const{showAdminInviteAfterSharingModal:t}=await new Promise((function(t,a){e(["./c_modals_invite_after_sharing_admin_invite_after_sharing_modal"],t,a)}));return t}const qr=(e,t)=>{const a=Object.fromEntries(e.map((e=>[ba(e),e]))),n=[],r=[];for(const e of t.results){const t=Ta(e.member);a.hasOwnProperty(t)&&("eligible_not_seen"===e.target_invite_eligibility[".tag"]?n.push(a[t]):"eligible_seen"===e.target_invite_eligibility[".tag"]&&r.push(a[t]))}return{inviteEligibleNotSeenContacts:n.map((e=>gr(e))),inviteEligibleSeenContacts:r.map((e=>gr(e)))}},Wr=(e,t)=>{if(a.getIsFile(t)){const t=[Ct(e)];s.getStoreForSharedWith().dispatch(s.sharedFileDataOutOfDate(t))}else s.getStoreForSharedWith().dispatch(s.sharedFolderDataOutOfDate())},Kr=ot({name:"sharing.addFileMember"},(e=>t=>it(e.sharingAddFileMember(t)))),Yr=ot({name:"sharing.addFolderMember"},(e=>t=>it(e.sharingAddFolderMember(t)))),Qr=["access_denied","path","not_found","email_not_verified","settings_error","not_authorized","undefined_error","banned_member","failed_copy_to_clipboard","invalid_logged_out_cookie","internal_error","other","contacts_error","rate_limit","bad_member","access_error","cant_share_outside_team","no_permission","too_many_invitees","invalid_csrf_token","invalid","user_not_logged_in","too_many_files","total_mounts_exceeded","home_mounts_exceeded","tree_size_exceeded","invalid_shared_folder","invalid_comment","team_policy_disallows_member_policy","disallowed_shared_link_policy","insufficient_plan","invalid_email","network","team_folder","too_many_members","too_many_pending_invites","already_shared"];function Zr(e){return Qr.find((t=>t===(null==e?void 0:e.toLowerCase())))}const Xr=Symbol("ON_CLICK_PROGRESSIVE"),Jr=Symbol("ON_MOUSE_ENTER_PROGRESSIVE"),ei=Symbol("ON_MOUSE_LEAVE_PROGRESSIVE"),ti=Symbol("ON_IMMEDIATE_TRANSITION"),ai=Symbol("ON_INVITE__START"),ni=Symbol("ON_ADD_FILE_MEMBER_API_ERROR"),ri=Symbol("ON_ADD_FILE_MEMBER_API_FATAL"),ii=Symbol("ON_ADD_FILE_MEMBER_API_SUCCESS"),oi=Symbol("ON_SHARE_FILE_FOLDER_FAILURE"),si=Symbol("ON_SHARE_FILE_FOLDER_FAILURE_CONTINUE"),li=Symbol("ON_ADD_FOLDER_MEMBER_API_ERROR"),_i=Symbol("ON_ADD_FOLDER_MEMBER_API_FATAL"),di=Symbol("ON_ADD_FOLDER_MEMBER_API_SUCCESS"),ci=Symbol("ON_CLICK_COPY_LINK_FROM_INBAND"),ui=Symbol("ON_MOUSE_ENTER_COPY_LINK_FROM_INBAND"),gi=Symbol("ON_MOUSE_LEAVE_COPY_LINK_FROM_INBAND"),{useEmitter:mi,defaultEmitter:pi}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o=a.getShareModalTypeFromString("sm24"),s={...Re(n),...Oe(r),...Pe(i),isSm24:"true"},l={...ke(n),...xe(r),...Fe(i)};if(e.key===Xr)return a.UDCL.logEvent(we({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"inband_progressive"}}),void a.UDCL.logEvent(Ie({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"inband_progressive"}});if(e.key!==Jr)if(e.key!==ei)if(e.key!==ai)if(e.key!==ii&&e.key!==di)if(e.key!==ri&&e.key!==_i){if(e.key===oi){const t=Zr(c.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return a.UDCL.logEnd(c.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:!1,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void a.UDCL.logEvent("ops.sm24.share_file_folder_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key!==si){if(e.key===li){const t=Zr(c.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return a.UDCL.logEnd(c.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:!1,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void a.UDCL.logEvent("ops.sm24.add_folder_member_api_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key===ni){const t=Zr(c.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return a.UDCL.logEnd(c.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:!1,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void a.UDCL.logEvent("ops.sm24.add_file_member_api_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key!==ti)if(e.key!==ui){if(e.key===ci)return a.UDCL.logEvent(we({...l,flexibleSharingEntryPointAction:"copy_link_from_inband",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"copy_link_from_inband"}}),void a.UDCL.logEvent(Ie({...l,flexibleSharingEntryPointAction:"copy_link_from_inband",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...s,action:"copy_link_from_inband"}});if(e.key!==gi)return a.exhausts(e,void 0);a.UDCL.logEvent(Ie({...l,flexibleSharingEntryPointAction:"copy_link_from_inband",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"copy_link_from_inband"}})}else a.UDCL.logEvent(Te({...l,flexibleSharingEntryPointAction:"copy_link_from_inband"}),{tags:{...s,action:"copy_link_from_inband"}});else a.UDCL.logEvent(we({...l,flexibleSharingEntryPointAction:"inband_immediate",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"inband_immediate"}})}else a.UDCL.logEvent("ops.sm24.share_file_folder_failure",{tags:{...s,errorReason:e.payload.error}})}else a.UDCL.logEnd(c.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:!1,shareInviteErrorReason:"network",fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir}),{tags:{...s,errorReason:"network"},eventState:"failed",key:e.payload.actionKey});else a.UDCL.logEnd(c.PAP_Send_ShareInvite({validationTraceId:void 0,numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:!1,fromNotifyInherited:!1,sckeySha1:e.payload.sckeySha1,eventState:"success",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir}),{tags:s,eventState:"success",key:e.payload.actionKey});else a.UDCL.logStart(c.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:!1,fromNotifyInherited:!1,shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir}),{tags:s,key:e.payload.actionKey});else a.UDCL.logEvent(Ie({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...s,action:"inband_progressive"}});else a.UDCL.logEvent(Te({...l,flexibleSharingEntryPointAction:"inband_progressive"}),{tags:{...s,action:"inband_progressive"}})})),hi=e=>{const t=r.useIntl(),n=Ja(),i=Je(),o=tt(Kr),s=tt(Yr),l=tt(va),_=Oa(za),d=(()=>{const e=r.useIntl(),t=Ja();return k.useCallback((n=>"access_error"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:Jt(e)}),n.error[".tag"]):"user_error"===n.error[".tag"]&&"email_unverified"===n.error.user_error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:ra(e)}),n.error.user_error[".tag"]):"invalid_comment"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:Xt(e)}),n.error[".tag"]):"rate_limit"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:aa(e)}),n.error[".tag"]):(n.error[".tag"],a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:Xt(e)}),n.error[".tag"])),[e,t])})(),c=(()=>{const e=r.useIntl(),t=Ja();return k.useCallback((n=>"NetworkFailure"!==n.type&&"PollingNetworkFailure"!==n.type||429!==n.value.response.statusCode?"ApiError"===n.type&&"email_unverified"===n.value.response.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:ra(e)}),n.value.response.error[".tag"]):"ApiError"===n.type&&"no_permission"===n.value.response.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:na(e)}),n.value.response.error[".tag"]):"ApiError"!==n.type||"too_many_mounts"!==n.value.response.error[".tag"]||"tree_size_exceeded"!==n.value.response.error.too_many_mounts[".tag"]&&"home_mounts_exceeded"!==n.value.response.error.too_many_mounts[".tag"]&&"total_mounts_exceeded"!==n.value.response.error.too_many_mounts[".tag"]?"ApiError"===n.type&&"bad_path"===n.value.response.error[".tag"]&&"already_shared"===n.value.response.error.bad_path[".tag"]?n.value.response.error.bad_path[".tag"]:"PollingApiError"===n.type&&"internal_error"===n.value.response.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:ia(e),helpMessage:la(e),helpUrl:"/support"}),n.value.response.error[".tag"]):(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:Xt(e)}),"PollingTimeout"===n.type?"network":"PollingFailed"===n.type?"failed":"ApiError"===n.type||"PollingApiError"===n.type?n.value.response.error[".tag"]:"undefined"):(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:_a(e,n.value.response.error.too_many_mounts.limit-n.value.response.error.too_many_mounts.current_count),helpUrl:$t}),n.value.response.error.too_many_mounts[".tag"]):(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:da(e),helpUrl:"/help/9259"}),"network")),[e,t])})(),u=(()=>{const e=r.useIntl(),t=Ja();return k.useCallback((n=>"access_error"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:Jt(e)}),n.error[".tag"]):"email_unverified"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:ra(e)}),n.error[".tag"]):"bad_member"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:ta(e)}),n.error[".tag"]):"cant_share_outside_team"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:ea(e)}),n.error[".tag"]):"too_many_members"===n.error[".tag"]||"too_many_pending_invites"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:sa(e)}),n.error[".tag"]):"insufficient_plan"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:oa(e)}),n.error[".tag"]):"team_folder"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:ea(e)}),n.error[".tag"]):"no_permission"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:na(e)}),n.error[".tag"]):"rate_limit"===n.error[".tag"]?(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:aa(e)}),n.error[".tag"]):(a.Snackbar.close("sharing-notification"),t.showFailure({intl:e,message:Xt(e)}),n.error[".tag"])),[e,t])})(),g=mi(),m=jr();return k.useCallback((async()=>{if(e.$isInviteSending.get())return;const r=e.$objectIdentifier.get(),p=e.$objectMetadata.get(),h=e.$inviteTargets.get(),E=e.$linkAccessLevel.get()[".tag"],f={numRecipients:h.length,accessLevel:"viewer"===E?"view":"edit",actionKey:Math.random().toString()};if(i("SHARE_MODAL_SHARE__INVITE__START",null),g.select(ai).emit(f),e.$props.get().onShareStart(null),e.$isInviteSending.set(!0),e.$inviteTargetsWithInvalidEmails.get().length>0)return;i("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_START",null);const v=Ct(r),S=await l({members:e.$inviteTargetsWithValidEmails.get().map(wa),content_type:{".tag":"file"===r[".tag"]?"file":"file_folder"===r[".tag"]?"folder":"shared_folder"},access_level:{".tag":E},content_id:v});"ERROR"===S.status&&i("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_ERROR",{error:S.error}),"FATAL"===S.status&&i("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_FATAL",{error:S.error}),"SUCCESS"===S.status&&(i("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_SUCCESS",null),e.$inviteTargetValidations.set(Ia(S.output.results)));const b=e.$validationResult.get();if(b&&"error"===b.level)return i("SHARE_MODAL_SHARE__INVITE__CANCELLED",null),void e.$isInviteSending.set(!1);const y=e=>(i("SHARE_MODAL_SHARE__INVITE__NAVIGATE_ATTEMPT",null),e.preventDefault(),e.returnValue="",""),A=()=>{i("SHARE_MODAL_SHARE__INVITE__NAVIGATE_AWAY",null)};e.$props.get().onShareStart(null),window.addEventListener("beforeunload",y),window.addEventListener("unload",A);const w=()=>{e.$isInviteSending.set(!1),window.removeEventListener("beforeunload",y),window.removeEventListener("unload",A),e.$props.get().onShareFailure(null)},T=e.$props.get().inviteMessage,I=e.$shouldPostMessageAsComment.get();if("file"===r[".tag"]){i("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_START",null);const e=await o({access_level:{".tag":E},file:v,members:h.map(wa),custom_message:T,add_message_as_comment:I&&T.length>0});if("ERROR"===e.status){i("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_ERROR",{response:e});const t=d(e);return g.select(ni).emit({...f,error:t}),void w()}if("FATAL"===e.status)return i("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_FATAL",{response:e}),g.select(ri).emit(f),w(),a.Snackbar.close("sharing-notification"),void n.showFailure({intl:t,message:ia(t),helpMessage:la(t),helpUrl:"/support"});i("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_SUCCESS",{response:e});const r=e.output[0]&&e.output[0].sckey_sha1&&e.output[0].sckey_sha1;g.select(ii).emit({...f,sckeySha1:r})}if("file_folder"===r[".tag"]||"shared_folder"===r[".tag"]||"collection"===r[".tag"]){let o="file_folder"===r[".tag"]?"":"collection"===r[".tag"]?r.nsId:r.sharedFolderId;if("file_folder"===r[".tag"]){i("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__START",null);const t=await _({path:r.path,timeout:12e4,interval:1e3});if(t.success)o=t.value.response.output.shared_folder_id;else{if("ApiError"!==t.type||"bad_path"!==t.value.response.error[".tag"]||"already_shared"!==t.value.response.error.bad_path[".tag"]){w(),i("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__FAILURE",{output:t});const e=c(t);return void g.select(oi).emit({...f,error:e})}{o=t.value.response.error.bad_path.shared_folder_id;const e=c(t);g.select(si).emit({...f,error:e})}}i("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__SUCCESS",null),e.$props.get().onObjectIdentifierChanged({".tag":"shared_folder",sharedFolderId:o}),await e.$props.get().onRefreshObjectMetadata()}i("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_START",null);const l=await s({shared_folder_id:o,...{...T?{custom_message:T}:{}},members:h.map((e=>({access_level:{".tag":E},member:wa(e)})))});if("ERROR"===l.status){i("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_ERROR",{response:l});const e=u(l);return g.select(li).emit({...f,error:e}),void w()}if("FATAL"===l.status)return i("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_FATAL",{response:l}),g.select(_i).emit(f),w(),a.Snackbar.close("sharing-notification"),void n.showFailure({intl:t,message:ia(t)});i("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_SUCCESS",{response:l});const d=void 0;g.select(di).emit({...f,sckeySha1:d})}e.$isInviteSending.set(!1),window.removeEventListener("beforeunload",y),window.removeEventListener("unload",A),a.Snackbar.close("sharing-notification"),a.Snackbar.complete(((e,t)=>e.formatMessage({id:"lvjqTm",defaultMessage:"Shared <st>{name}</st>."},{st:e=>k.createElement("strong",{key:t.name},e),name:q.em_snippet(t.name,a.SNIPPET_SIZES.FILENAME)}))(t,p),"sharing-notification"),e.$props.get().onInbandShareSuccess(null),"SUCCESS"===S.status&&m({objectMetadata:p,objectIdentifier:r,inviteTargets:h,targetsValidateResult:S.output,sharingPrefs:e.$sharingPrefs.get()})}),[e,o,l,s,_,n,t,i,d,c,u,g,m])},Ei=e=>{const t=r.useIntl(),n=Je(),i=Ja(),o=Oa(Ha),s=Oa(za),l=(e=>{const t=r.useIntl(),n=Je(),i=Ja(),o=e.$objectMetadata.get();return k.useCallback((async(r,s,l,_,d=!1)=>{d?await e.$props.get().onRefreshModal():await e.$props.get().onRefreshObjectMetadata(),a.Snackbar.close("sharing-notification"),i.showCompleted({intl:t,message:ua(t,s,o),actionMessage:l?ma(t):void 0,actionOnClick:l?()=>null==_?void 0:_(r):void 0}),n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_CONFIDENTIALITY__FINISH",null)}),[t,n,o,i,e.$props])})(e),_=e.$objectMetadata.get();return k.useCallback((async(r,d,c,u)=>{if("shared_folder"!==r[".tag"]&&"file_folder"!==r[".tag"])return;n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_CONFIDENTIALITY__START",null),a.Snackbar.close("sharing-notification"),i.showInProgress({intl:t,message:ca(t,d,_)});let g=r;if("file_folder"===g[".tag"]){n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_START",null);const r=await s({path:g.path,confidentiality:d?{".tag":"confidential"}:{".tag":"not_confidential"},timeout:12e4,interval:1e3});if(r.success)return n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null),g={".tag":"shared_folder",sharedFolderId:r.value.response.output.shared_folder_id},e.$props.get().onObjectIdentifierChanged(g),void l(g,d,c,u);if("ApiError"!==r.type||"bad_path"!==r.value.response.error[".tag"]||"already_shared"!==r.value.response.error.bad_path[".tag"])return n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_FAILURE",null),a.Snackbar.close("sharing-notification"),void i.showFailure({intl:t,message:ga(t,d)});n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null),g={".tag":"shared_folder",sharedFolderId:r.value.response.error.bad_path.shared_folder_id},e.$props.get().onObjectIdentifierChanged(g),await e.$props.get().onRefreshObjectMetadata(),n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null)}n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_START",null);if(!(await o({setAccessInheritanceArg:{access_inheritance:d?{".tag":"no_inherit"}:{".tag":"inherit"},shared_folder_id:g.sharedFolderId},timeout:12e4,interval:1e3})).success)return n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_FAILURE",null),a.Snackbar.close("sharing-notification"),void i.showFailure({intl:t,message:ga(t,d)});n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_SUCCESS",null),l(g,d,c,u,!0)}),[t,n,_,l,o,s,i,e.$props])},fi=(e,t,n)=>n?((e,t)=>e.formatMessage({id:"6jTcuT",defaultMessage:"Share with {teamName}"},{teamName:q.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,t):(e=>e.formatMessage({id:"P5jM9e",defaultMessage:"Share"}))(e),vi=(e,t,n,r,i)=>i?((e,t,n)=>e.formatMessage({id:"ipUgQi",defaultMessage:"Share <b>{folderName}</b> with everyone at {teamName}?"},{folderName:q.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),teamName:q.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>k.createElement("b",{style:{fontWeight:"var(--type__title__standard--fontweight_strong)"}},e)}))(e,n,t):((e,t,n)=>e.formatMessage({id:"znRNbl",defaultMessage:"Share <b>{folderName}</b> with everyone who can access <b>{parentFolderName}</b>?"},{folderName:q.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:q.em_snippet(n,a.SNIPPET_SIZES.FOLDER_NAME),b:e=>k.createElement("b",{style:{fontWeight:"var(--type__title__standard--fontweight_strong)"}},e)}))(e,n,r),Si=(e,t,a,n,r)=>r?((e,t,a)=>e.formatMessage({id:"R8xJiq",defaultMessage:"<b>{folderName}</b> won’t be shared privately any more. Everyone at {teamName} will have access to this folder."},{folderName:t,teamName:a,b:e=>k.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}))(e,a,t):((e,t)=>e.formatMessage({id:"ioGEl6",defaultMessage:"Everyone who can access <b>{parentFolderName}</b> will be able to access this folder."},{parentFolderName:t,b:e=>k.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}))(e,n),bi=({store:e})=>{const t=r.useIntl(),n=a.useStore(e.$changeConfidentialityData),i=(e=>k.useCallback((()=>{e.$changeConfidentialityData.set(null)}),[e]))(e),o=(e=>{const t=Ei(e),a=e.$objectIdentifier.get();return k.useCallback((async e=>t(a,e,!0,(async a=>t(a,!e,!1)))),[a,t])})(e),s=a.useStore(e.$objectMetadata);if(!n)return null;const l=a.getName(s),_=a.getParentFolderName(s),d=""===_,c=fi(t,n.teamName,d),u=vi(t,n.teamName,l,_,d),g=Si(t,n.teamName,l,_,d);return k.createElement(k.Fragment,null,k.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:"Close",onRequestClose:i},k.createElement(a.Modal.Header,{"data-sharing-sdk":"1",hasBottomSpacing:"title-standard"},k.createElement(a.Modal.Title,null,u)),k.createElement(a.Modal.Body,{"data-sharing-sdk":"1"},g),k.createElement(a.Modal.Footer,{"data-sharing-sdk":"1"},k.createElement(a.Button,{variant:"opacity",onClick:i},(e=>e.formatMessage({id:"i3tRYX",defaultMessage:"Cancel"}))(t)),k.createElement(a.Button,{variant:"primary",onClick:()=>{o(!1),i()}},c))))};bi.displayName="ChangeConfidentialityModal";a.injectInternalStyle("/static/metaserver/static/js/sharing/features/shareme24/inband/message-field.module.out-vfl148xHh.css",(e=>"._message-field_1fqk0_1 textarea:focus{box-shadow:none}._message-field_1fqk0_1{margin-bottom:0}"));const yi="_message-field_1fqk0_1",Ai=({store:e})=>{const t=r.useIntl(),n=a.useStore(e.$inviteTargets),i=a.useStore(e.$props).inviteMessage,o=a.useStore(e.$isInviteSending),s=(e=>{const t=Je();return k.useCallback((a=>{t("SHARE_MODAL_SHARE__MESSAGE_CHANGED",null),e.$props.get().onInviteMessageChange(a.target.value)}),[e,t])})(e);return 0===n.length&&0===i.length?k.createElement(k.Fragment,null):k.createElement(a.Box,{className:yi,paddingTop:"Micro Large"},k.createElement(a.TextArea,{style:{height:"auto"},placeholder:Kt(t),"aria-label":Yt(t),onChange:s,disabled:o,"data-testid":"ib-message-field-textarea"}))};Ai.displayName="MessageField";const wi=/^['#&A-Za-z0-9._%+-]+@[A-Za-z0-9-][A-Za-z0-9.-]*\.[A-Za-z]{2,15}$/;var Ti,Ii,Ci;!function(e){e.OTHER="other",e.DEFAULT_NO_ONE="default_no_one",e.DEFAULT_PUBLIC="default_public",e.DEFAULT_TEAM_ONLY="default_team_only",e.TEAM_ONLY="team_only"}(Ti||(Ti={})),function(e){e.NOT_SHOWN="not_shown",e.ACTIVE="active",e.INACTIVE="inactive"}(Ii||(Ii={})),function(e){e.PENDING="pending",e.INITIAL="initial",e.SUCCESS="success",e.ERROR="error"}(Ci||(Ci={}));const Ri=e=>{const t=r.useIntl(),n=Je(),i=k.useRef(null),o=k.useRef(null),s=k.useRef(null);return a.useInitStore(e,(e=>{const r=a.proxy((()=>e.get().accountMetadata)),l=a.proxy((()=>e.get().hasUpdatedAccountMetadata)),_=a.proxy((()=>e.get().objectIdentifier)),d=a.proxy((()=>e.get().objectMetadata)),c=a.proxy((()=>e.get().sharingPrefs)),u=a.proxy((()=>e.get().useRedesignedStyle)),g=a.proxy((()=>Ct(_.get()))),m=a.proxy((()=>e.get().inviteTargets),(t=>e.get().onInviteTargetsChange(t))),p=a.proxy((()=>a.getIsFolder(d.get()))),h=a.proxy((()=>a.getIsConfidentialFolder(d.get()))),E=a.proxy((()=>a.getIsCloudDoc(d.get()))),f=a.proxy((()=>a.getIsCloudEnhancedFile(d.get()))),v=a.store({}),S=a.proxy((()=>a.getCanInvite(d.get(),a.VIEWER))),b=a.proxy((()=>a.getCanInvite(d.get(),a.EDITOR))),y=a.proxy((()=>{const e=xn(c.get());return a.getCanCreateLink(d.get(),{".tag":"viewer"},e,r.get().is_tmr_member)})),A=a.proxy((()=>{const e=xn(c.get());return a.getIsLinkOnlyMode(d.get())?a.getCanCreateLink(d.get(),{".tag":"viewer"},e,r.get().is_tmr_member):a.getCanCreateLink(d.get(),{".tag":"editor"},e,r.get().is_tmr_member)})),w=a.store(!1),T=a.proxy((()=>y.get()||S.get())),I=a.proxy((()=>A.get()||b.get())),C=a.proxy((()=>I.get()||T.get())),R=(e=>{const t=e.default_sharing_access_level_setting;if(!t)return a.EDITOR;switch(t[".tag"]){case a.SharingAccessLevel.UNKNOWN:case a.SharingAccessLevel.EDIT:return a.EDITOR;case a.SharingAccessLevel.VIEW:return a.VIEWER;default:return a.EDITOR}})(c.get()),k=I.get()?R:a.VIEWER,M=a.store(k),L=a.proxy((()=>a.getCanInvite(d.get(),M.get()))),N=a.proxy((()=>!!c.get().create_view_file_link_enabled)),O=a.proxy((()=>"viewer"===M.get()[".tag"]?T.get():"editor"===M.get()[".tag"]&&I.get())),x=a.proxy((()=>!!c.get().create_view_folder_link_enabled)),D=a.proxy((()=>p.get()?"editor"===M.get()[".tag"]||x.get():E.get()?!f.get()||("editor"===M.get()[".tag"]||N.get()):"viewer"===M.get()[".tag"]&&N.get())),P=a.proxy((()=>"personal"!==r.get().role&&r.get().is_team_member&&r.get().team_policies||null)),F=a.proxy((()=>d.get().owner_team_policies||null)),$=a.proxy((()=>{var e,t;const a=null===(e=F.get())||void 0===e?void 0:e.shared_folder_link_restriction_policy[".tag"],n=D.get()?F.get():P.get(),r=null==n?void 0:n.shared_link_create_policy[".tag"];return"members"===a?Ti.DEFAULT_NO_ONE:r===Ti.OTHER?Ti.DEFAULT_PUBLIC:null!==(t=r)&&void 0!==t?t:Ti.DEFAULT_PUBLIC})),H=a.proxy((()=>a.getCanDoAction(d.get(),{".tag":"share_message_as_comment"}))),B=a.store(!1),U=a.proxy((()=>m.get().filter((e=>"group"===e[".tag"]||wi.test(e.email))))),V=a.proxy((()=>m.get().filter((e=>"group"!==e[".tag"]&&!wi.test(e.email))))),z=a.proxy((e=>{let r=null;const i=m.get(),o=v.get(),s=Object.values(o).reduce(((e,t)=>"allowed"===t.result[".tag"]&&"outside_of_team"===t.result.allowed[".tag"]||"disallowed"===t.result[".tag"]&&"outside_of_team"===t.result.disallowed[".tag"]?e+1:e),0);for(const e of i){const i=o[ba(e)];if(i)if("disallowed"===i.result[".tag"]){const o=i.result.disallowed[".tag"];if("invalid_member"===o){r={level:"error",message:Ut(t)};break}if("outside_of_team"===o)r={level:"error",message:s>1?Vt(t):zt(t)};else if("no_permission"===o){const n=d.get();r=a.getIsCollection(n)&&"group"===e[".tag"]?{level:"error",message:t.formatMessage({id:"vLSoUY",defaultMessage:"Collection sharing for groups is currently not supported"})}:{level:"error",message:jt(t)}}else"target_is_individual"===o?r={level:"error",message:Gt(t)}:"target_not_same_team_restricted"===o?r={level:"error",message:qt(t)}:(n("SHARE_MODAL_SHARE__PREVALIDATION__UNKNOWN_TAG",{value:o}),r={level:"error",message:Wt(t)})}else if(!r&&"allowed"===i.result[".tag"]){const e=i.result.allowed[".tag"];if("no_warning"===e)continue;"outside_of_team"===e?r=r||{level:"warn",message:s>1?Ht(t):Bt(t)}:n("SHARE_MODAL_SHARE__PREVALIDATION__UNKNOWN_TAG",{value:e})}}return e&&r&&e.level===r.level&&e.message===r.message?e:r})),j=a.proxy((()=>!1)),G=a.proxy((()=>j.get()?a.VIEWER:M.get())),q=a.proxy((()=>"editor"===G.get()[".tag"]?A.get():y.get())),W=a.store(null),K=a.store(null),Y=a.store(null),Q=a.store(null),Z=a.proxy((()=>!1==!!d.get().path_lower)),X=a.proxy((()=>{var e;return"editor"===(null===(e=d.get().access_type)||void 0===e?void 0:e[".tag"])})),J=a.store(!1),ee=a.store(null),te=a.store(m.get().length>0?Ii.INACTIVE:Ii.NOT_SHOWN),ae=a.proxy((()=>e.get().inbandTransitionDone)),ne=a.store(!1),re=a.proxy((()=>e.get().onButtonsAnimationStart)),ie=a.store(!1),oe=a.store(0),se=a.store(0),le=a.proxy((()=>e.get().shouldShowCopyLinkButton)),_e=a.store(Ci.INITIAL),de=a.store(!1),ce=a.store(0),ue=a.store(0),ge=a.proxy((()=>e.get().isAddMembersDirectlyInMemberListEnabled||!1)),me=a.proxy((()=>e.get().isBrandingPanelOpen||!1));return{$accountMetadata:r,$canCreateLink:q,$canPerformAnyActions:C,$canPerformAnyActionsAtCurrentAccessLevel:O,$canPerformAnyEditLinkActions:I,$canPerformAnyViewLinkActions:T,$canPostMessageAsComment:H,$canInvite:L,$copyLinkLinkAccessLevel:G,$hasAccessTypeEditor:X,$recentlyCreatedAndCopiedLinkAccessLevel:Q,$inviteTargets:m,$inviteTargetsWithInvalidEmails:V,$inviteTargetsWithValidEmails:U,$inviteTargetValidations:v,$isDataBeingUpdated:J,$isFolder:p,$isConfidentialFolder:h,$isInviteSending:B,$creatingLinkAccessLevel:W,$isMounted:Z,$linkAccessLevel:M,$objectIdentifier:_,$objectIdentifierId:g,$objectMetadata:d,$recentlyCreatedLinkAccessLevel:Y,$recentlyCreatedLinkMetadata:K,$props:e,$shouldPostMessageAsComment:w,$sharingPrefs:c,$validationResult:z,$teamPolicyDefaultAudience:$,linkRef:i,$changeConfidentialityData:ee,$hasUpdatedAccountMetadata:l,$useRedesignedStyle:u,$progressiveInbandState:te,inbandActionAreaRef:o,$inbandTransitionDone:ae,inputRef:s,$isSuggestionsOpen:ne,$onButtonsAnimationStart:re,$isProgressiveButtonHovered:ie,$progressiveButtonHoverStartTime:oe,$componentViewTime:se,$shouldShowCopyLinkButton:le,$copyLinkStage:_e,$copyLinkButtonViewTime:ue,$isCopyLinkButtonHovered:de,$copyLinkButtonHoverStartTime:ce,$isAddMembersDirectlyInMemberListEnabled:ge,$isBrandingPanelOpen:me}}))},ki=k.createContext({redirectWindowToken:null}),Mi=()=>k.useContext(ki).redirectWindowToken,Li=({children:e,...t})=>{const a=k.useMemo((()=>({redirectWindowToken:t.redirectWindowToken})),[t.redirectWindowToken]);return k.createElement(ki.Provider,{value:a},e)};Li.displayName="Provider";const Ni=e=>e,Oi=ot({name:"sharing.targetsSearch"},(e=>async t=>{const a=await it(e.sharingTargetsSearch(t));return"SUCCESS"===a.status?{status:at.SUCCESS,output:a.output.entries.map(Ni)}:a})),xi=ot({name:"profileServices.listLinkedServices"},(e=>()=>it(e.profileServicesListLinkedServices()))),Di=(e,t)=>{const a=e.linked_services.find((e=>e.service_type[".tag"]===t[".tag"]));return!!a&&"is_connected"===a.connection_state[".tag"]},Pi=(e,t,a)=>{const n=e.linked_services.find((e=>e.service_type[".tag"]===t[".tag"]));return!!n&&n.granted_permissions.some((e=>e[".tag"]===a[".tag"]))},Fi=e=>{const t=e.toUpperCase().split(" ").filter((e=>e));return`${t.length>0?t[0][0]:""}${t.length>1?t[t.length-1][0]:""}`};function $i(e,t){if(!e)return"";const a=(e=e.toUpperCase()).trim().split(" "),n=Bi(a[0]),r=Bi(a[a.length-1]);if(a.length>=2)return Hi(t)?r[0]+n[0]:n[0]+r[0];const i=Bi(e);return Hi(t)&&!function(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>=128)return!1;return!0}(e)&&i.length>1?i[0]+i[1]:i[0]}function Hi(e){return-1!==["zh","ja","ko"].indexOf(e)}function Bi(e){const t=[],a=e.length;let n=0;for(;n<a;){const r=e[n];if(r>="\ud800"&&r<="\udb7f"){if(!(n<a-1))break;{const a=r+e[n+1];t.push(a),n+=2}}else t.push(r),n+=1}return t}a.injectInternalStyle("/static/metaserver/static/js/sharing/features/shareme24/tokenizer/tokenizer.module.out-vflODVaHE.css",(e=>"._share-tokenizer_tm0wp_1._ib-share-24-tokenizer_tm0wp_1{color-scheme:var(--dig-color-scheme);margin-top:var(--dig-spacing__dimension__4);max-height:80px;max-width:100%;min-width:auto;width:100%}._share-tokenizer_tm0wp_1._ib-share-24-scroll_tm0wp_10{color-scheme:var(--dig-color-scheme);overflow-y:scroll}._share-tokenizer-text-input-container_tm0wp_15{cursor:text;position:relative}._share-tokenizer-text-input-container_tm0wp_15,._share-tokenizer-text-input-container_tm0wp_15:has(input:focus){border:none;box-shadow:none;outline:none}#_share-tokenizer-wrapper_tm0wp_1{border-radius:var(--dig-radius__small);transform:translateY(8px)}input._share-tokenizer-text-input_tm0wp_15[type=text]{font-family:var(--type__body__standard--fontfamily);font-size:var(--type__body__standard--fontsize);line-height:var(--type__body__standard--lineheight_label);min-height:var(--dig-spacing__dimension__24);min-width:2ch;width:0}"));const Ui="_share-tokenizer_tm0wp_1",Vi="_ib-share-24-tokenizer_tm0wp_1",zi="_ib-share-24-scroll_tm0wp_10",ji="_share-tokenizer-text-input-container_tm0wp_15",Gi="_share-tokenizer-wrapper_tm0wp_1",qi="_share-tokenizer-text-input_tm0wp_15",Wi=/['&A-Za-z0-9\._%+-]+@[A-Za-z0-9-][A-Za-z0-9\.-]*\.[A-Za-z]{2,15}/gi,Ki=/[,|;>\s]/,Yi="IMPORT_CONTACTS",Qi=[Yi],Zi="Google",Xi="/static/images/index/google-logo-color.svg",Ji=e=>(e.match(Wi)||[]).map(Sa),eo=e=>k.useCallback((t=>{const n=t.currentTarget.value,r=(i=n,Ki.test(i)?Ji(i):[]);var i;a.batch((()=>{e.$isTypeaheadForcedOpen.set(!1),r.length>0?(e.$inviteTargets.set([...e.$inviteTargets.get(),...r]),e.$query.set("")):e.$query.set(n)}))}),[e]),to=e=>e.map((e=>{if("email"===e[".tag"]||"user"===e[".tag"]){const t=e.email.trim();return t.length===e.email.length?e:{...e,email:t}}return e})),ao=e=>{const t={};return e.filter((e=>{const a=ba(e);return!t[a]&&(t[a]=!0,!0)}))},no=e=>{const t=(e=>{const t=tt(Oi),n=Je(),r=an();return k.useCallback((async()=>{let i;const o=e.$objectMetadata.get();a.getIsFile(o)&&(i=o.id);const s=e.$query.get(),l=await t({content_id:i,query:s,force_refresh:!1,limit:10});if(e.$query.get()===s){if(n("TARGETS_TOKENIZER__TARGETS_SEARCH__API_START",null),"SUCCESS"!==l.status)return"ERROR"===l.status?n("TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR",{response:l}):n("TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL",{response:l}),r(),void e.$searchSuggestionsRaw.set([]);n("TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS",{response:l}),a.batch((()=>{e.$latestSuggestionsQuery.set(s),e.$searchSuggestionsRaw.set(l.output)}))}}),[e,t,r,n])})(e);k.useEffect((()=>{const a=[e.$query.obs((e=>{t()}))];return()=>a.forEach((e=>e()))}),[e,t])},ro=e=>{const t=tt(xi);return k.useCallback((async()=>{if(e.$isLinkedServicesUpdating.get())return;const n=await t(null);"SUCCESS"===n.status?a.batch((()=>{e.$linkedServices.set(n.output),e.$isLinkedServicesUpdating.set(!1)})):a.batch((()=>{e.$linkedServices.set(null),e.$isLinkedServicesUpdating.set(!1)}))}),[e,t])},io=e=>{const t=r.useIntl(),n=Ja(),i=Je(),o=ro(e),s=Mi();return k.useCallback((async()=>{if(e.$isConnectingToGoogle.get()||null===s)return;e.$isConnectingToGoogle.set(!0);let r=null;const l=()=>{n.showFailure({message:t.formatMessage({id:"sgP44K",defaultMessage:"Failed to connect your contacts from Google"}),intl:t}),null!==r&&clearInterval(r),window.removeEventListener("message",c),o().then((()=>{e.$isConnectingToGoogle.set(!1)}))},_=new URLSearchParams({service:"1",is_popup:"true",action:"link_contacts",prompt_select:"true",token:s,user_id:e.$user.get().id.toString(),is_desktop:"false"}),d=window.open(`/profile_services/start_auth_flow?${_.toString()}`,"Google","width=600,height=600,resizable=1,scrollbars=1");if(null===d)return l();r=setInterval((()=>{d.closed&&l()}),1e3);const c=s=>{let _;try{_=JSON.parse(s.data)}catch(e){return}if(a.isObjectOf({type:a.isExactly("db:profile_service:auth_complete"),payload:a.isObjectOf({success:a.isBoolean})})(_)){if(_.payload.success)return u=d,i("TEAMS_WEB",{name:a.TeamsWebEventName.ImportContactsComplete,extra:{provider:"google",path:window.location.pathname}}),n.showCompleted({message:t.formatMessage({id:"Au33+R",defaultMessage:"Successfully connected your contacts from Google"}),intl:t}),null!==r&&clearInterval(r),window.removeEventListener("message",c),o().then((()=>{e.$isConnectingToGoogle.set(!1)})),void(null==u||u.close());var u;l(),d.close()}};window.addEventListener("message",c)}),[e,t,n,i,o,s])},oo=(e,t)=>"user"===e[".tag"]?$i(e.name,t.locale):"group"===e[".tag"]?Fi(e.name):"email"===e[".tag"]?"":a.exhausts(e,""),so=(e,t)=>"user"===e[".tag"]?t&&t!==e.dbx_team_id?e.email:e.name:"group"===e[".tag"]?e.name:"email"===e[".tag"]?e.email:"",lo=({store:e,target:t,isDisabled:n})=>{const i=r.useIntl(),o=((e,t)=>k.useCallback((()=>{const n=e.$inviteTargets.get().filter((e=>e!==t));a.batch((()=>{e.$inviteTargets.set(n),e.$query.set("")}))}),[e,t]))(e,t),s=e.$user.get().team_dbtid,l=q.em_snippet(so(t,s),a.SNIPPET_SIZES.EMAIL_SHORT,.6),_="user"===t[".tag"]&&s&&s!==t.dbx_team_id?"":oo(t,i),d=ya(t),c=ba(t),u=a.useStore(e.$inviteTargetValidation)[c],m=u&&"allowed"===u.result[".tag"]&&"no_warning"!==u.result.allowed[".tag"]&&"not_dropbox_user"!==u.result.allowed[".tag"],p=u&&"disallowed"===u.result[".tag"],h=!!_||!!d,E=h&&k.createElement(a.Avatar,{src:d||"",size:"xsmall",hasNoOutline:!0},_);return k.createElement(g.Chip,{size:"small",onDelete:o,variant:m?"attention":p?"alert":"standard",disabled:n},h&&k.createElement(g.Chip.AvatarAccessory,null,E),k.createElement(g.Chip.Content,null,l))};lo.displayName="EmailChip";const _o=({target:e})=>{const t=r.useIntl(),n=ba(e),i=oo(e,t),o=so(e),s=Aa(e,t),l=ya(e),_=a.avatarColorForUserIdentifier(i);return k.createElement(u.Typeahead.Row,{"data-testid":"typeahead-suggestion",className:"targets-tokenizer-suggestion",key:n,value:e,withTitle:o,withSubtitle:s,withLeftAccessory:k.createElement(a.Avatar,{src:l||"",backgroundColor:_,hasNoOutline:!0},i)})};_o.displayName="Suggestion";const co=({store:e})=>{const t=r.useIntl(),n=a.useStore(e.$isConnectingToGoogle),i=a.useStore(e.$isConnectedToGoogle),o=a.useStore(e.$isLinkedServicesUpdating);return Mi()?n?k.createElement(u.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:Yi,withLeftAccessory:k.createElement(a.Avatar,{src:Xi}),value:Yi,withTitle:Zi,withSubtitle:t.formatMessage({id:"JbMFlW",defaultMessage:"Importing contacts"})}):o?null:i?k.createElement(u.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:Yi,withLeftAccessory:k.createElement(a.Avatar,{src:Xi}),value:Yi,withTitle:Zi,withSubtitle:t.formatMessage({id:"2/+46g",defaultMessage:"Connected"})}):k.createElement(u.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:Yi,withLeftAccessory:k.createElement(a.Avatar,{src:Xi}),value:Yi,withTitle:Zi,withSubtitle:t.formatMessage({id:"CkYgqG",defaultMessage:"Sign in to import contacts"})}):null};co.displayName="ImportContacts";const uo=e=>{var t,n;const i=(e=>a.useInitStore(e,(e=>{var t;const n=a.store(!1),r=a.store(!1),i=a.store(!1),o=a.store(null!==(t=e.get().autoFocus)&&void 0!==t&&t),s=a.store(null),l=a.store(""),_=a.store(""),d=a.proxy((()=>e.get().user)),c=a.proxy((()=>e.get().accessLevel)),u=a.proxy((()=>e.get().isEmailSectionActive)),g=a.proxy((()=>e.get().inviteTargets),(t=>e.get().onInviteTargetsChange(to(ao(t))))),m=a.proxy((()=>e.get().inviteTargetValidation)),p=a.proxy((()=>e.get().objectMetadata)),h=a.proxy((()=>a.getCanInvite(p.get(),c.get()))),E=a.proxy((()=>{const e=s.get();return e?Di(e,{".tag":"google"})&&Pi(e,{".tag":"google"},{".tag":"contacts"}):null})),f=a.proxy((()=>d.get().is_team)),v=a.proxy((()=>a.getIsTeamSharedFolder(p.get()))),S=a.proxy((()=>e.get().autoFocus)),b=a.proxy((()=>i.get())),y=a.store([]),A=a.proxy((e=>{const t=v.get(),a=d.get().email,n=g.get().map(ba),r={},i=y.get().filter((e=>{const i=ba(e);return!(r[i]||(r[i]=!0,n.includes(i)||!G(t,d.get().is_tmr_member)&&"group"!==e[".tag"]||"email"===e[".tag"]||"user"===e[".tag"]&&e.email===a))}));return null!==e&&e.length===i.length&&e.every(((e,t)=>e===i[t]),!0)?e:i})),w=a.proxy((e=>{const t=v.get(),a=l.get(),n=t||""===a,r=[...A.get().slice(0,9),...n?[]:Qi];return null!==e&&e.length===r.length&&e.reduce(((e,t,a)=>e&&t===r[a]),!0)?e:r}));return{$accessLevel:c,$user:d,$canInvite:h,$inviteTargets:g,$inviteTargetValidation:m,$isConnectedToGoogle:E,$isConnectingToGoogle:n,$isFocused:r,$isLinkedServicesUpdating:i,$isTeamAccount:f,$isTeamFolder:v,$isTypeaheadForcedOpen:o,$isUpdatingGoogleConnectionStatus:b,$linkedServices:s,$objectMetadata:p,$query:l,$latestSuggestionsQuery:_,$searchSuggestionsRaw:y,$searchSuggestions:A,$suggestions:w,$isEmailSectionActive:u,$autoFocus:S,$props:e}})))(e),o=r.useIntl(),s=k.useRef(null),l=a.useStore(i.$query),_=a.useStore(i.$inviteTargets),d=k.useRef(_.length),c=a.useStore(i.$suggestions),g=a.useStore(i.$canInvite),m=a.useStore(i.$isTypeaheadForcedOpen)&&g,p=null!==(t=a.useStore(i.$autoFocus))&&void 0!==t&&t,h=null!==(n=e.isAddMembersDirectlyInMemberListEnabled)&&void 0!==n&&n,E=h?"420px":"272px";no(i),(e=>{const t=tt(Oi),a=Je();k.useEffect((()=>{(async()=>{a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_START",null);const n=await t({content_id:void 0,query:"",force_refresh:!0,limit:10});"SUCCESS"===n.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS",{response:n}):"ERROR"===n.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR",{response:n}):a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL",{response:n}),"SUCCESS"===n.status&&e.$searchSuggestionsRaw.set(n.output)})()}),[])})(i),(e=>{const t=ro(e);k.useEffect((()=>{t()}),[t])})(i);const f=(e=>{const t=io(e);return k.useCallback((n=>{a.batch((()=>{var a,r;if(n===Yi){if(e.$isTypeaheadForcedOpen.set(!0),e.$isConnectingToGoogle.get())return;if(e.$isConnectedToGoogle.get())return;return e.$query.set(""),void t()}e.$query.set(""),e.$inviteTargets.set([...e.$inviteTargets.get(),n]),null===(r=null===(a=e.$props.get().inputRef)||void 0===a?void 0:a.current)||void 0===r||r.focus()}))}),[e,t])})(i),v=(e=>k.useCallback((t=>{const n=e.$query.get();if(13===t.keyCode&&t.shiftKey)return void t.preventDefault();8!==t.keyCode&&46!==t.keyCode||""===n&&e.$inviteTargets.get().length>0&&e.$inviteTargets.set(e.$inviteTargets.get().slice(0,-1));const r=n===e.$latestSuggestionsQuery.get(),i=Wi.test(n);if(13===t.keyCode){const t=document.getElementById("targets-tokenizer-input-search");if(t&&"scrollIntoView"in t&&t.scrollIntoView(),r&&!i&&e.$searchSuggestions.get().length>0)a.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),e.$searchSuggestions.get()[0]]),e.$query.set("")}));else if(""!==n){const t=Ji(n);t.length>0?a.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),...t]),e.$query.set("")})):a.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),Sa(n)]),e.$query.set("")}))}}}),[e]))(i),S=eo(i);let b=(e=>{const t=r.useIntl(),n=a.useStore(e.$isTeamFolder),i=a.useStore(e.$isTeamAccount),o=a.useStore(e.$user).is_tmr_member;return k.useMemo((()=>G(n,o)?i?t.formatMessage({id:"+nKRfb",defaultMessage:"Add an email, name, or group"}):t.formatMessage({id:"bdV6O3",defaultMessage:"Add an email or name"}):t.formatMessage({id:"VMGE6I",defaultMessage:"Group names"})),[n,i,t,o])})(i);b=_.length>0?"":b;const y=(e=>k.useCallback((({isOpen:t})=>{if(!t){const t=Ji(e.$query.get());a.batch((()=>{t.length>0&&(e.$inviteTargets.set([...e.$inviteTargets.get(),...t]),e.$query.set("")),e.$isTypeaheadForcedOpen.set(!1),e.$isFocused.set(!1)}))}}),[e]))(i),A=(e=>k.useCallback((()=>{var t,a;null===(a=(t=e.$props.get()).onUserInteraction)||void 0===a||a.call(t),e.$isTypeaheadForcedOpen.set(!1),e.$isFocused.set(!0)}),[e]))(i),w=(e=>k.useCallback((t=>t===Yi?k.createElement(co,{store:e}):k.createElement(_o,{target:t})),[e]))(i),T=k.useRef(!1),I=e.isInviteSending||!g,C=k.useCallback(((t,a)=>{const n=a.includes(Yi)?a.length-1:a.length,r=t&&n>0;if(T.current!==r){T.current=r;(e.onTargetsDropdownFocusChange||(()=>{}))(r)}e.isSuggestionsOpen&&e.isSuggestionsOpen.set(t)}),[e.onTargetsDropdownFocusChange,e.isSuggestionsOpen]),R=k.useCallback((()=>{e.isSuggestionsOpen&&!e.isSuggestionsOpen.get()&&i.$isTypeaheadForcedOpen.set(!0)}),[i.$isTypeaheadForcedOpen,e.isSuggestionsOpen]),M=k.useCallback((()=>{var t,a;null===(a=null===(t=e.inputRef)||void 0===t?void 0:t.current)||void 0===a||a.focus()}),[e.inputRef]);return k.useEffect((()=>{g&&0===e.inviteTargets.length&&M()}),[g,M,e.inviteTargets]),k.useEffect((()=>{if(d.current<_.length){const e=document.getElementById("targets-tokenizer-input-search");e&&"scrollIntoView"in e&&e.scrollIntoView({behavior:"smooth"})}d.current=_.length}),[_.length]),k.createElement("div",{ref:s},k.createElement(u.Typeahead.Wrapper,{onSelection:f,hasMaxHeight:!0,isPortaled:!1,className:a.cx("oa-pulsar-effect-SHARE_MODAL_TOKENIZER",Ui,Vi,{[zi]:_.length>0}),containerId:Gi,onToggle:y},(({getTriggerProps:t,getContentProps:n})=>{const{open:r,...d}=n({}),g=(r||m)&&c.length>0;return C(g,c),k.createElement(k.Fragment,null,k.createElement(a.TextInput.Container,{className:a.cx(ji),size:"small",onClick:M,style:{minWidth:E}},k.createElement(a.TextInput.ChipsContainer,null,_.map(((e,t)=>k.createElement(lo,{store:i,key:t,target:e,isDisabled:I}))),k.createElement(a.TextInput.Input,{...t({onChange:S,onKeyDown:v,onFocus:A}),className:qi,ref:e.inputRef,disabled:I,value:l,"aria-label":b,placeholder:b,"data-testid":"targets-tokenizer-input",id:"targets-tokenizer-input-search",autoComplete:"off",autoFocus:p,onClick:R}))),k.createElement(u.Typeahead.Container,{...d,triggerRef:s,open:g,"data-testid":"typeahead-container",auto:!1,placement:"bottom",style:h?0===e.inviteTargets.length?{width:"476px",transform:"translateX(-38px) translateY(20px)"}:{minWidth:"calc(100% + 44px)",left:"100.5%",transform:"translateX(-7.5%) "}:0===e.inviteTargets.length?{width:"338px",transform:"translateX(-38px) translateY(20px)"}:{minWidth:"calc(100% + 40px)",left:"119.5%",transform:"translateX(-9.5%) "}},k.createElement(u.Typeahead.Results,{title:o.formatMessage({id:"ZusjWv",defaultMessage:"Suggested people"}),results:c,renderRow:w,initialResults:""===l?3:10,maxResults:10})))})))};uo.displayName="TargetsTokenizer";const go=({store:e})=>{const t=a.useStore(e.$linkAccessLevel),n=a.useStore(e.$inviteTargets),r=a.useStore(e.$inviteTargetValidations),i=a.useStore(e.$objectMetadata),s=a.useStore(e.$isInviteSending),l=(e=>{const t=a.useStore(e.$accountMetadata);return k.useMemo((()=>o.convertAccountMetadataToUser(t)),[t])})(e),_=e.inbandActionAreaRef,d=e.inputRef,c=e.$isSuggestionsOpen,u=a.useStore(e.$isAddMembersDirectlyInMemberListEnabled),g=(e=>{const t=Je();return k.useCallback((a=>{t("SHARE_MODAL_SHARE__INVITE_TARGETS__CHANGE",null),e.$props.get().onInviteTargetsChange(a),e.$progressiveInbandState.set(Ii.ACTIVE)}),[e,t])})(e);return k.createElement(uo,{accessLevel:t,objectMetadata:i,inviteTargets:n,onInviteTargetsChange:g,onTargetsDropdownFocusChange:e.$props.get().onTargetsDropdownFocusChange,inviteTargetValidation:r,user:l,isInviteSending:s,inbandActionAreaRef:_,inputRef:d,isSuggestionsOpen:c,isAddMembersDirectlyInMemberListEnabled:u})};go.displayName="TargetsTokenizer";const mo=({store:e})=>{const t=r.useIntl(),n=Wa(),i=o.getIsTeamAdmin(e.$accountMetadata.get()),s=i?(e=>e.formatMessage({id:"QV0fMP",defaultMessage:"To share this folder, manage access in the admin console."}))(t):(e=>e.formatMessage({id:"E/G/gP",defaultMessage:"Only admin and group managers can share this content.{br}Reach out and ask them to share it."},{br:k.createElement("br",null)}))(t),l=i?(e=>e.formatMessage({id:"S839MU",defaultMessage:"Go to admin console"}))(t):(e=>e.formatMessage({id:"0KHhX0",defaultMessage:"Find admin"}))(t);return k.createElement("div",{style:{textAlign:"center"}},k.createElement(a.Text,{size:"medium","data-testid":"tmr-team-folder-subtitle"},s),k.createElement("div",null,k.createElement(a.Button,{variant:"borderless",size:"small",style:{marginTop:"32px"},onClick:()=>{n(i?"/team/admin/content/home":"/team?_tk=left_nav_team")}},l)))};mo.displayName="TmrTeamFolder";const po=({store:e})=>{var t;const[n,i]=k.useState(!1),s=k.useRef(null),l=mi(),_=a.useStore(e.$canPerformAnyActions),d=a.useStore(e.$canPerformAnyActionsAtCurrentAccessLevel),c=a.useStore(e.$objectMetadata),u=a.getIsFolder(c),g=a.useStore(e.$canInvite),p=a.useStore(e.$linkAccessLevel),h=a.getIsNSLinkOnlyMode(c),E=!g||"link_only"===c[".tag"],f=o.isUserOnSameTeamAsTmrFolder(e.$accountMetadata.get(),e.$objectMetadata.get()),v=!!a.getOwnerTeam(c),S=null!==(t=a.getOwnerTeamName(c))&&void 0!==t?t:"",b=a.getIsTeamSharedFolder(c),y=$t,A=Wa(),w=k.useCallback((e=>{A(e)}),[A]),T=(e=>k.useCallback((()=>{e.$progressiveInbandState.set(Ii.ACTIVE)}),[e]))(e),I=k.useCallback((()=>{const t=e.$isProgressiveButtonHovered.get()?Date.now()-e.$progressiveButtonHoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();l.select(Xr).emit({dwellTime:t,timeSinceView:a}),e.$props.get().onStartInband(),T()}),[l,e,T]),C=k.useCallback((()=>{e.$progressiveButtonHoverStartTime.set(Date.now()),e.$isProgressiveButtonHovered.set(!0),l.select(Jr).emit(null),i(!0)}),[l,e]),R=k.useCallback((()=>{const t=e.$isProgressiveButtonHovered.get()?Date.now()-e.$progressiveButtonHoverStartTime.get():void 0;e.$isProgressiveButtonHovered.set(!1),l.select(ei).emit({dwellTime:t}),i(!1)}),[l,e]),M=E||f||!_||!d,L=()=>{let t=null;if(E)t=(()=>{switch("link_only"===c[".tag"]?h?"isNSLinkOnlyMode":"isFamily":"isLimitedPermissions"){case"isNSLinkOnlyMode":return k.createElement(a.Text,null,((e,t)=>{if(t.tooManyMountsError&&("total_mounts_exceeded"===t.tooManyMountsError[".tag"]||"home_mounts_exceeded"===t.tooManyMountsError[".tag"]||"tree_size_exceeded"===t.tooManyMountsError[".tag"])){const a=t.tooManyMountsError.limits_info;if(a){const t=a.limit,n=a.new_count-t;return e.formatMessage({id:"f3Mx9B",defaultMessage:"This folder can only be shared as a link because your Dropbox folder is {number, plural, one{1 shared folder} other {{number} shared folders}} over limit."},{number:n})}}})(r.intl,c),k.createElement(a.Link,{style:{marginLeft:3},hasNoUnderline:!0,onClick:()=>w(y),href:"",isBold:!0},r.intl.formatMessage({id:"b0sjjf",defaultMessage:"Learn more"})));case"isLimitedPermissions":return v&&!o.isUserOnSameTeamAsObject(e.$accountMetadata.get(),e.$objectMetadata.get())?b?k.createElement(a.Text,null,(t=r.intl,void 0!==(n=S)?t.formatMessage({id:"ToMYBy",defaultMessage:"This folder can only be managed by the {ownerTeamName} team."},{ownerTeamName:n}):t.formatMessage({id:"ReqZ5Y",defaultMessage:"This folder can only be managed by the owner team."}))):u?k.createElement(a.Text,null,(e=>e.formatMessage({id:"5iJXBE",defaultMessage:"You don’t have permission to manage membership of this folder"}))(r.intl)):k.createElement(a.Text,null,(e=>e.formatMessage({id:"WVaUHn",defaultMessage:"You don’t have permission to manage membership of this file"}))(r.intl)):k.createElement(a.Text,null,(e=>e.formatMessage({id:"TnTBTY",defaultMessage:"This can only be shared with the link."}))(r.intl));case"isFamily":return k.createElement(a.Text,null,(e=>e.formatMessage({id:"O1FxvA",defaultMessage:"This folder can only be shared as a link."}))(r.intl))}var t,n})();else if(!f||_&&d){if(!_){const t=o.isUserOnSameTeamAsObject(e.$accountMetadata.get(),e.$objectMetadata.get()),n=r.intl.formatMessage({id:"QpEuIr",defaultMessage:"You can view this folder, but you’ll need to ask the folder owner to give you permission to share it."}),i=(e=>e.formatMessage({id:"/8sefF",defaultMessage:"You can view this folder, but only the folder owner can share it."}))(r.intl);return k.createElement(a.Text,null,t?n:i)}d||(t=k.createElement(a.Text,null,"editor"===p[".tag"]?u?(e=>e.formatMessage({id:"dooCWY",defaultMessage:"You can only share a link for viewing for this folder."}))(r.intl):(e=>e.formatMessage({id:"XbAqHv",defaultMessage:"You can only share a link for viewing for this type of file."}))(r.intl):(e=>e.formatMessage({id:"X+IYXP",defaultMessage:"This link type isn’t supported."}))(r.intl)))}else t=k.createElement(mo,{store:e});return t?k.createElement(a.Tooltip.Control,{open:n,placement:"left",triggerRef:s,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1)},t):null},N="inband-sharing-entry-button",O=a.useStore(e.$useRedesignedStyle),x=a.useStore(e.$isAddMembersDirectlyInMemberListEnabled),D=o.getIsTeam(e.$accountMetadata.get()),P=k.createElement(k.Fragment,null,k.createElement(ve,{ref:s,onMouseEnter:C,onMouseLeave:R,useRedesignedStyle:O},k.createElement(Ee,{onClick:I,disabled:M,"data-testid":N,autoFocus:!0,useRedesignedStyle:O},k.createElement(pe,{useRedesignedStyle:O},k.createElement(a.UIIcon,{src:m.ShareLine,size:"medium"})),k.createElement(Se,{useRedesignedStyle:O},k.createElement(ye,{useRedesignedStyle:O},k.createElement(a.Truncate,{lines:2},r.intl.formatMessage({id:"SC4EWs",defaultMessage:"Add people"})))))),L());const F=k.createElement(k.Fragment,null,k.createElement(ve,{ref:s,onMouseEnter:C,onMouseLeave:R,useRedesignedStyle:O},k.createElement(fe,{onClick:I,disabled:M,"data-testid":N,autoFocus:!0,useRedesignedStyle:O},k.createElement(pe,{useRedesignedStyle:O},k.createElement(a.UIIcon,{src:m.ShareLine,size:"small"})),k.createElement(Se,{useRedesignedStyle:O},k.createElement(a.Text,{color:"subtle",style:{marginLeft:-3,marginTop:4}},k.createElement(a.Truncate,{lines:2},D?(e=>e.formatMessage({id:"I1N8uC",defaultMessage:"Add an email, name, or group"}))(r.intl):(e=>e.formatMessage({id:"RynZbM",defaultMessage:"Add an email or name"}))(r.intl)))))),L());return x?F:P};po.displayName="InbandShareButton";a.injectInternalStyle("/static/metaserver/static/js/sharing/features/shareme24/inband/share-modal-share.module.out-vfluaplNE.css",(e=>"._action-section_1nnpn_1{border-radius:var(--dig-radius__small);box-shadow:var(--dig-utilities__boxshadow__raised);position:relative;z-index:1}._action-section-top_1nnpn_8{padding:var(--dig-spacing__micro__medium);padding-bottom:var(--dig-spacing__micro__xsmall)}._action-section-top-no-targets_1nnpn_13{padding:var(--dig-spacing__micro__medium);padding-bottom:0}._action-section-bottom_1nnpn_18{box-shadow:0 0 12px 0 var(--dig-color__shadow__elevated);padding:var(--dig-spacing__micro__small) var(--dig-spacing__micro__medium)}._action-section-bottom-no-targets_1nnpn_23{padding:var(--dig-spacing__micro__medium);padding-top:0}._action-section_1nnpn_1:hover{box-shadow:var(--dig-utilities__boxshadow__floating)}._action-section-active_1nnpn_32,._action-section-active_1nnpn_32:hover,._action-section_1nnpn_1:focus-within{box-shadow:var(--dig-utilities__boxshadow__focus-ring)}._add-icon_1nnpn_38,._add-icon_1nnpn_38>svg{transition:min-width var(--duration__surface) var(--easing__transition),width var(--duration__surface) var(--easing__transition),background-color var(--duration__surface) var(--easing__transition),color var(--duration__surface) var(--easing__transition),height var(--duration__surface) var(--easing__transition),margin-top var(--duration__surface) var(--easing__transition)}._action-section-active_1nnpn_32 ._add-icon_1nnpn_38,._action-section_1nnpn_1:focus-within ._add-icon_1nnpn_38,._action-section_1nnpn_1:hover ._add-icon_1nnpn_38{background:var(--dig-color__primary__base);color:var(--dig-color__background__base)}._action-section_1nnpn_1 ._add-icon_1nnpn_38>svg{color:var(--dig-color__text__base)}._action-section-active_1nnpn_32 ._add-icon_1nnpn_38>svg,._action-section_1nnpn_1:focus-within ._add-icon_1nnpn_38>svg,._action-section_1nnpn_1:hover ._add-icon_1nnpn_38>svg{color:var(--dig-color__background__base)}._action-section-active_1nnpn_32 ._add-icon-sending_1nnpn_65,._action-section_1nnpn_1:focus-within ._add-icon-sending_1nnpn_65,._action-section_1nnpn_1:hover ._add-icon-sending_1nnpn_65{background:var(--dig-color__disabled__base)}._action-section_1nnpn_1 ._add-icon-sending_1nnpn_65>svg,._action-section-active_1nnpn_32 ._add-icon-sending_1nnpn_65>svg,._action-section_1nnpn_1:focus-within ._add-icon-sending_1nnpn_65>svg,._action-section_1nnpn_1:hover ._add-icon-sending_1nnpn_65>svg{color:var(--dig-color__disabled__on-surface)}._action-section-no-targets_1nnpn_78:hover{cursor:text}._add-icon-standard_1nnpn_82{height:var(--dig-spacing__dimension__36);margin-top:0;min-width:var(--dig-spacing__dimension__36);width:var(--dig-spacing__dimension__36)}._add-icon-small_1nnpn_89{height:var(--dig-spacing__dimension__24);margin-top:var(--dig-spacing__dimension__6);min-width:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}._add-icon-small_1nnpn_89 svg{height:var(--dig-spacing__dimension__16);width:var(--dig-spacing__dimension__16)}._action-section-active_1nnpn_32 ._add-icon-standard_1nnpn_82,._action-section_1nnpn_1:focus-within ._add-icon-standard_1nnpn_82{height:var(--dig-spacing__dimension__24);margin-top:var(--dig-spacing__dimension__6);min-width:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}._action-section-active_1nnpn_32 ._add-icon-standard_1nnpn_82>svg,._action-section_1nnpn_1:focus-within ._add-icon-standard_1nnpn_82>svg{height:var(--dig-spacing__dimension__16);width:var(--dig-spacing__dimension__16)}._add-icon-shrink_1nnpn_115{animation:_shrink-icon_1nnpn_1 var(--duration__micro-fast) var(--easing__transition) forwards}._add-icon-shrink_1nnpn_115>svg{animation:_shrink-icon-svg_1nnpn_1 var(--duration__micro-fast) var(--easing__transition) forwards}@keyframes _shrink-icon_1nnpn_1{0%{height:var(--dig-spacing__dimension__36);margin-top:0;min-width:var(--dig-spacing__dimension__36);width:var(--dig-spacing__dimension__36)}to{height:var(--dig-spacing__dimension__24);margin-top:var(--dig-spacing__dimension__6);min-width:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}}@keyframes _shrink-icon-svg_1nnpn_1{0%{height:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}to{height:var(--dig-spacing__dimension__16);width:var(--dig-spacing__dimension__16)}}._action-row_1nnpn_149{display:flex;flex-direction:column;row-gap:var(--dig-spacing__micro__medium);width:100%}._add-members-directly-action-section_1nnpn_157{border-radius:var(--dig-radius__small);border-style:solid;border-width:2px;position:relative;z-index:1}._add-members-directly-action-section_1nnpn_157 ._add-icon_1nnpn_38{margin-top:0}._add-members-directly-action-section-not-active_1nnpn_169{border-color:var(--dig-color__border__subtle)}._add-members-directly-action-section-active_1nnpn_173,._add-members-directly-action-section_1nnpn_157:focus-within{border-color:var(--dig-color__utility__focus-ring)}._add-members-directly-action-section-active_1nnpn_173 ._add-icon_1nnpn_38,._add-members-directly-action-section_1nnpn_157:focus-within ._add-icon_1nnpn_38,._add-members-directly-action-section_1nnpn_157:hover ._add-icon_1nnpn_38{background:var(--dig-color__primary__base);color:var(--dig-color__background__base)}._add-members-directly-action-section-bottom_1nnpn_185{padding:var(--dig-spacing__micro__medium);padding-top:var(--dig-spacing__micro__medium)}._add-members-directly-action-section-active_1nnpn_173 ._add-icon-sending_1nnpn_65,._add-members-directly-action-section_1nnpn_157:focus-within ._add-icon-sending_1nnpn_65,._add-members-directly-action-section_1nnpn_157:hover ._add-icon-sending_1nnpn_65{background:var(--dig-color__disabled__base)}._add-members-directly-action-section_1nnpn_157 ._add-icon-sending_1nnpn_65>svg,._add-members-directly-action-section-active_1nnpn_173 ._add-icon-sending_1nnpn_65>svg,._add-members-directly-action-section_1nnpn_157:focus-within ._add-icon-sending_1nnpn_65>svg,._add-members-directly-action-section_1nnpn_157:hover ._add-icon-sending_1nnpn_65>svg{color:var(--dig-color__disabled__on-surface)}"));const ho="_action-section_1nnpn_1",Eo="_action-section-top_1nnpn_8",fo="_action-section-top-no-targets_1nnpn_13",vo="_action-section-bottom_1nnpn_18",So="_action-section-bottom-no-targets_1nnpn_23",bo="_action-section-active_1nnpn_32",yo="_add-icon_1nnpn_38",Ao="_add-icon-sending_1nnpn_65",wo="_action-section-no-targets_1nnpn_78",To="_add-icon-small_1nnpn_89",Io="_add-icon-shrink_1nnpn_115",Co="_action-row_1nnpn_149",Ro="_add-members-directly-action-section_1nnpn_157",ko="_add-members-directly-action-section-not-active_1nnpn_169",Mo="_add-members-directly-action-section-active_1nnpn_173",Lo="_add-members-directly-action-section-bottom_1nnpn_185",No=({store:e})=>{const t=a.useStore(e.$isInviteSending),n=mi(),i=k.useCallback((()=>{const t=e.$isCopyLinkButtonHovered.get()?Date.now()-e.$copyLinkButtonHoverStartTime.get():void 0,a=Date.now()-e.$copyLinkButtonViewTime.get();n.select(ci).emit({dwellTime:t,timeSinceView:a})}),[n,e]),o=k.useCallback((()=>{e.$copyLinkButtonHoverStartTime.set(Date.now()),e.$isCopyLinkButtonHovered.set(!0),n.select(ui).emit(null)}),[n,e]),s=k.useCallback((()=>{const t=e.$isCopyLinkButtonHovered.get()?Date.now()-e.$copyLinkButtonHoverStartTime.get():void 0;e.$isCopyLinkButtonHovered.set(!1),n.select(gi).emit({dwellTime:t})}),[n,e]);k.useEffect((()=>{e.$copyLinkButtonViewTime.set(Date.now())}),[e]);const l=a.useStore(e.$copyLinkStage),_=k.useCallback((()=>{e.$copyLinkStage.set(Ci.SUCCESS),e.$props.get().onCopyLinkSuccess(null),setTimeout((()=>{e.$copyLinkStage.set(Ci.INITIAL)}),5e3)}),[e]),d=k.useCallback((()=>{e.$props.get().onShareFailure(null),e.$copyLinkStage.set(Ci.INITIAL)}),[e]),c=k.useCallback((()=>{i(),e.$copyLinkStage.set(Ci.PENDING),e.$props.get().onShareStart(null),e.$props.get().onCopyLinkClick(_,d)}),[i,e,_,d]),u=k.createElement(k.Fragment,null,k.createElement(a.Button,{variant:"outline",size:"medium",onClick:c,onMouseEnter:o,onMouseLeave:s,withIconStart:k.createElement(a.UIIcon,{src:a.LinkLine}),disabled:t,"data-testid":"initial-inband-copy-link-button"},r.intl.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"})));const g=k.createElement(k.Fragment,null,k.createElement(k.Fragment,null,k.createElement(a.Button,{variant:"outline",size:"medium",disabled:!0,onMouseEnter:o,onMouseLeave:s,isLoading:!0,style:{width:"109px"},"data-testid":"pending-inband-copy-link-button"}))),m=k.createElement(k.Fragment,null,k.createElement(a.Button,{variant:"outline",size:"medium",onClick:c,onMouseEnter:o,onMouseLeave:s,withIconStart:k.createElement(a.UIIcon,{src:a.LinkLine}),disabled:t,"data-testid":"result-inband-copy-link-button"},(e=>e.formatMessage({id:"UPtSgG",defaultMessage:"Link copied!"}))(r.intl)));return k.createElement(k.Fragment,null,k.createElement("div",null,l===Ci.INITIAL&&u,l===Ci.PENDING&&g,l===Ci.SUCCESS&&m))};No.displayName="LoadedButton";const Oo=({store:e})=>k.createElement(No,{store:e});Oo.displayName="InbandCopyLinkButton";const xo={other:"other",default_no_one:"no_one",default_public:"public",default_team_only:"team",team_only:"team"},Do=(e,t,n,r)=>{const o=tt(Ft);return k.useEffect((()=>{r&&e&&t&&n&&xo[t]!==n&&(async(e,t)=>{await e({last_seen_team_policy_audience:t}),a.sharingPrefsPackage.invalidateQueries(i.queryClient)})(o,{".tag":xo[t]})}),[o,r,e,n,t])},Po=({store:e})=>{var t;const n=r.useIntl();k.useState(null);const i=e.inbandActionAreaRef,o=a.useStore(e.$progressiveInbandState),s=a.useStore(e.$isInviteSending),l=a.useStore(e.$isConfidentialFolder),_=a.useStore(e.$objectMetadata),d=a.useStore(e.$validationResult),c=a.useStore(e.$inviteTargets),u=hi(e),g=(e=>k.useCallback((t=>{e.$changeConfidentialityData.set({teamName:t})}),[e.$changeConfidentialityData]))(e),p=null!==(t=a.getOwnerTeamName(_))&&void 0!==t?t:"",h=a.useStore(e.$isSuggestionsOpen),E=c.length>0,f=o!==Ii.NOT_SHOWN,v=o===Ii.ACTIVE,S=a.useStore(e.$onButtonsAnimationStart),b=o===Ii.ACTIVE;b&&S();const y=a.useStore(e.$shouldShowCopyLinkButton),A=a.useStore(e.$isAddMembersDirectlyInMemberListEnabled);return k.createElement("div",{className:Co},k.createElement("div",{id:"shareme24-ib-action-container",style:{width:"100%"},ref:i,"data-testid":"ib-action-area",role:"region"},k.createElement(a.Box,{className:"banner-group",marginBottom:l||d?"Micro Small":"0"},l?k.createElement(Pt,{teamName:p,parentFolderName:a.getParentFolderName(_),isRestoreAccessEnabled:a.getCanDoAction(_,a.UPDATE_CONFIDENTIALITY_TAG),onRestoreAccessClick:g}):null,k.createElement(bi,{store:e}),null===d?null:k.createElement("div",{className:"banner-wrapper"},k.createElement(Dt,{message:d.message,variant:d.level}))),k.createElement(a.Box,{flexDirection:"column",className:A?a.cx(Ro,{[Mo]:v||h,[ko]:!v}):a.cx(ho,{[bo]:v||h,[wo]:!E}),backgroundColor:"Background Base",onClick:()=>{var t;!(null===(t=e.inputRef)||void 0===t?void 0:t.current)||E||h||e.inputRef.current.focus()}},k.createElement(a.Box,{className:E?Eo:fo},k.createElement(a.Box,{display:"flex",flexDirection:"row",style:{minHeight:"var(--dig-spacing__dimension__36)"},alignItems:A?"center":void 0},k.createElement(a.Box,{className:a.cx(yo,{[To]:A,[Io]:!A,[Ao]:s}),backgroundColor:s?"Disabled Base":"Background Subtle",borderRadius:"Circular",color:"Text Base",display:"flex",alignItems:"center",justifyContent:"center"},k.createElement(a.UIIcon,{src:m.ShareLine,size:"medium"})),k.createElement(go,{store:e})),E&&k.createElement(Ai,{store:e})),k.createElement(a.Box,{className:E?A?Lo:vo:So},f&&E&&k.createElement(a.Box,{display:"flex",justifyContent:"space-between",style:{height:"40px"}},k.createElement(fa,{store:e}),s?(()=>{const e=Qt(n);return k.createElement(a.Box,{display:"flex"},k.createElement(a.Box,{marginRight:"Micro XSmall"},k.createElement(a.Spinner,{size:"xsmall","aria-valuetext":null==e?void 0:e.toString(),monochromatic:!0,withTrack:!0})),k.createElement(a.Text,null,e))})():k.createElement(a.Button,{disabled:s||null!==d&&"error"===d.level||!E,style:{flexShrink:0,alignSelf:"center"},onClick:u,variant:"primary",size:"medium",fullWidth:!1,"data-uxa-log":"sharing-modal-footer-button-send-email","data-testid":"ib-share-send-email-button"},((e,t,a)=>a?Qt(e):(e=>e.formatMessage({id:"lHCrsZ",defaultMessage:"Share"}))(e))(n,0,s)))))),y&&b&&k.createElement(a.Box,{className:Co},k.createElement(Oo,{store:e})))};Po.displayName="InbandShare";const Fo=({store:e})=>{const t=a.useStore(e.$canPerformAnyActions),n=a.useStore(e.$canPerformAnyActionsAtCurrentAccessLevel),r=o.isUserOnSameTeamAsTmrFolder(e.$accountMetadata.get(),e.$objectMetadata.get()),i=a.useStore(e.$canInvite),s=a.useStore(e.$objectMetadata),l=!i||"link_only"===s[".tag"]||r||!t||!n,_=a.useStore(e.$progressiveInbandState),d=_!==Ii.NOT_SHOWN,c=k.useRef(!1),u=mi();return k.useEffect((()=>{if(!c.current&&_===Ii.ACTIVE){c.current=!0;const t=Date.now()-e.$componentViewTime.get();e.$props.get().onStartInband(),u.select(ti).emit({timeSinceView:t})}}),[e,_,u]),d&&!l?k.createElement(Po,{store:e}):k.createElement(po,{store:e})};Fo.displayName="ShareModalShareInner";const $o=e=>{const t=xt(),a=e.useRedesignedStyle,n=()=>k.createElement(ve,{useRedesignedStyle:a},k.createElement(Ee,{disabled:!0,useRedesignedStyle:a},k.createElement(p.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),k.createElement(p.Skeleton.Text,{size:"large",width:200})));return"loading"===t.status?k.createElement(n,null):"loaded"===t.status?k.createElement(Ho,{...e,accountMetadata:t.accountMetadata,objectIdentifier:t.objectIdentifier,objectMetadata:t.objectMetadata,sharingPrefs:t.sharingPrefs,onObjectIdentifierChanged:e=>t.onObjectIdentifierChanged(e),onRefreshModal:()=>Promise.resolve(),onRefreshObjectMetadata:()=>t.refreshObjectMetadata().then((()=>{}))}):null};$o.displayName="Inband";const Ho=e=>{const t=Ri(e);Ca(t);const n=a.useStore(t.$inviteTargets),r=a.useStore(t.$linkAccessLevel),i=a.useStore(t.$accountMetadata),o="personal"!==i.role&&i.is_team_member,s=a.useStore(t.$teamPolicyDefaultAudience),l=a.useStore(t.$sharingPrefs),_=l.last_seen_team_policy_audience?l.last_seen_team_policy_audience[".tag"]:void 0,d=!!a.useStore(t.$hasUpdatedAccountMetadata);return k.useEffect((()=>{t.$componentViewTime.set(Date.now())}),[t]),Do(o,s,_,d),k.createElement(et,{sharingInviteTargets:n,sharingAccessLevel:r},k.createElement(Fo,{store:t}))};Ho.displayName="InbandInner";const Bo=e=>e.formatMessage({id:"8sEPDx",defaultMessage:"Settings"}),Uo=Symbol("ON_CLICK"),Vo=Symbol("ON_MOUSE_ENTER"),zo=Symbol("ON_MOUSE_LEAVE"),{useEmitter:jo,defaultEmitter:Go}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o={...Re(n),...Oe(r),...Pe(i)},s={...ke(n),...xe(r),...Fe(i)};if(e.key===Uo)return a.UDCL.logEvent(we({...s,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"settings"}}),void a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"settings"}});e.key!==Vo?e.key!==zo||a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"settings"}}):a.UDCL.logEvent(Te({...s,flexibleSharingEntryPointAction:"settings"}),{tags:{...o,action:"settings"}})})),qo=({store:e})=>{const[t,n]=k.useState(!1),i=k.useRef(null),o=jo(),s=k.useCallback((()=>{const t=e.$data.get(),a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,n=Date.now()-e.$componentViewTime.get();o.select(Uo).emit({dwellTime:a,timeSinceView:n}),e.$isHovered.set(!1),e.$props.get().onClickSettingsButton({shouldOpenLinkSettings:"loaded"===t.status&&"link_only"===t.objectMetadata[".tag"]})}),[e,o]),l=k.useCallback((()=>{o.select(Vo).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,o]),_=k.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;o.select(zo).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,o]);k.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const d=e.$props.get().useRedesignedStyle;return k.createElement(k.Fragment,null,k.createElement(be,{"data-testid":"settings-button",onClick:s,onMouseEnter:l,onMouseLeave:_,ref:i,variant:e.$props.get().buttonVariant,useRedesignedStyle:d},k.createElement(a.UIIcon,{src:h.SettingsLine,"aria-label":Bo(r.intl)})),k.createElement(a.Tooltip.Control,{open:t,placement:"top",triggerRef:i,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},k.createElement(a.Text,null,Bo(r.intl))))};qo.displayName="LoadedButton";const Wo=({store:e})=>k.createElement(qo,{store:e});Wo.displayName="Inner";const Ko=e=>{const t=(e=>{const t=xt(),n=a.useInitStore(t,(e=>e));return a.useInitStore(e,(e=>{const t=a.store(!1),r=a.store(0),i=a.store(0);return{$props:e,$data:n,$isHovered:t,$hoverStartTime:r,$componentViewTime:i}}))})(e);return k.createElement(Wo,{store:t})};Ko.displayName="SettingsButton";const Yo=e=>e.formatMessage({id:"FuFURj",defaultMessage:"Transfer a copy"}),Qo=Symbol("ON_CLICK"),Zo=Symbol("ON_MOUSE_ENTER"),Xo=Symbol("ON_MOUSE_LEAVE"),{useEmitter:Jo,defaultEmitter:es}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o={...Re(n),...Oe(r),...Pe(i)},s={...ke(n),...xe(r),...Fe(i)};if(e.key===Qo)return a.UDCL.logEvent(we({...s,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"transfer"}}),void a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"transfer"}});e.key!==Zo?e.key!==Xo||a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"transfer"}}):a.UDCL.logEvent(Te({...s,flexibleSharingEntryPointAction:"transfer"}),{tags:{...o,action:"transfer"}})})),ts=({store:e})=>{const t=Jo(),n=k.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,n=Date.now()-e.$componentViewTime.get();t.select(Qo).emit({dwellTime:a,timeSinceView:n}),e.$isHovered.set(!1),e.$props.get().onClickTransferButton()}),[e,t]),i=k.useCallback((()=>{t.select(Zo).emit(null),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,t]),o=k.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(Xo).emit({dwellTime:a}),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,t]);k.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const s=e.$props.get().useRedesignedStyle;return k.createElement(k.Fragment,null,k.createElement(ve,{onMouseEnter:i,onMouseLeave:o,useRedesignedStyle:s},k.createElement(he,{"data-testid":"transfer-button",onClick:n,useRedesignedStyle:s},k.createElement(pe,{useRedesignedStyle:s},k.createElement(a.UIIcon,{src:E.DropboxTransferLine,size:"medium"})),k.createElement(Ae,{useRedesignedStyle:s}),k.createElement(Se,{useRedesignedStyle:s},k.createElement(ye,{useRedesignedStyle:s},k.createElement(a.Truncate,{lines:2},Yo(r.intl)))))))};ts.displayName="ChonkyBoiiLoadedButton";const as=({store:e})=>{const t=Jo(),[n,i]=k.useState(!1),o=k.useRef(null),{canUserUseTransfer:s,canContentUseTransfer:l}=a.useStore(e.$props),_=k.useCallback((()=>{t.select(Zo).emit(null),i(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,t]),d=k.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(Xo).emit({dwellTime:a}),i(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,t]);let c="";s?l||(c=(e=>e.formatMessage({id:"LvDT7L",defaultMessage:"This is not a file type that can be copied."}))(r.intl)):c=r.intl.formatMessage({id:"l+F4Tm",defaultMessage:"Ask an admin to allow Transfer a copy."});const u=e.$props.get().useRedesignedStyle;return k.createElement(k.Fragment,null,k.createElement(ve,{ref:o,onMouseEnter:_,onMouseLeave:d,useRedesignedStyle:u},k.createElement(he,{disabled:!0,useRedesignedStyle:u},k.createElement(pe,{useRedesignedStyle:u},k.createElement(a.UIIcon,{src:E.DropboxTransferLine,size:"medium"})),k.createElement(Ae,{useRedesignedStyle:u}),k.createElement(Se,{useRedesignedStyle:u},k.createElement(ye,{useRedesignedStyle:u},k.createElement(a.Truncate,{lines:2},Yo(r.intl)))))),k.createElement(a.Tooltip.Control,{open:n,placement:"top",triggerRef:o,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1)},k.createElement(a.Text,null,c)))};as.displayName="ChonkyBoiiDisabledButton";const ns=({store:e})=>{const{canUserUseTransfer:t,canContentUseTransfer:n}=a.useStore(e.$props);return t&&n?k.createElement(ts,{store:e}):k.createElement(as,{store:e})};ns.displayName="Inner";const rs=e=>{const t=(e=>{const t=xt(),n=a.useInitStore(t,(e=>e));return a.useInitStore(e,(e=>{const t=a.store(!1),r=a.store(0),i=a.store(0);return{$props:e,$data:n,$isHovered:t,$hoverStartTime:r,$componentViewTime:i}}))})(e);return k.createElement(ns,{store:t})};rs.displayName="TransferButton";const is=e=>e.formatMessage({id:"O6jjXZ",defaultMessage:"Create a view-only QR code"}),os=Symbol("ON_CLICK"),ss=Symbol("ON_MOUSE_ENTER"),ls=Symbol("ON_MOUSE_LEAVE"),{useEmitter:_s,defaultEmitter:ds}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o={...Re(n),...Oe(r),...Pe(i)},s={...ke(n),...xe(r),...Fe(i)};if(e.key===os)return a.UDCL.logEvent(we({...s,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"qr_code"}}),void a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"qr_code"}});e.key!==ss?e.key!==ls||a.UDCL.logEvent(Ie({...s,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"qr_code"}}):a.UDCL.logEvent(Te({...s,flexibleSharingEntryPointAction:"qr_code"}),{tags:{...o,action:"qr_code"}})})),cs=({store:e})=>{const[t,n]=k.useState(!1),i=k.useRef(null),o=_s(),s=k.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();o.select(os).emit({dwellTime:t,timeSinceView:a}),e.$isHovered.set(!1),e.$props.get().onClickQrCodeButton()}),[e,o]),l=k.useCallback((()=>{o.select(ss).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,o]),_=k.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;o.select(ls).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,o]);k.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const d=e.$props.get().useRedesignedStyle;return k.createElement(k.Fragment,null,k.createElement(be,{"data-testid":"qr-code-button",onClick:s,onMouseEnter:l,onMouseLeave:_,ref:i,variant:e.$props.get().buttonVariant,useRedesignedStyle:d},k.createElement(a.UIIcon,{src:h.QrCodeLine,"aria-label":is(r.intl)})),k.createElement(a.Tooltip.Control,{open:t,placement:"top",triggerRef:i,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},k.createElement(a.Text,null,is(r.intl))))};cs.displayName="LoadedButton";const us=({store:e})=>k.createElement(cs,{store:e});us.displayName="Inner";const gs=e=>{const t=(e=>{const t=xt(),n=a.useInitStore(t,(e=>e));return a.useInitStore(e,(e=>{const t=a.store(!1),r=a.store(0),i=a.store(0);return{$props:e,$data:n,$isHovered:t,$hoverStartTime:r,$componentViewTime:i}}))})(e);return k.createElement(us,{store:t})};gs.displayName="QrCodeButton";const ms=r.defineMessages({loading:{id:"w1RdJ3",defaultMessage:"Loading"},close:{id:"EXY+v8",defaultMessage:"Close"},more:{id:"cRMZ6S",defaultMessage:"More"},brandName:{id:"2Yvjh/",defaultMessage:"Brand name"},logo:{id:"0B7F2Q",defaultMessage:"Logo"},background:{id:"pqgpBy",defaultMessage:"Background"}});a.injectInternalStyle("/static/metaserver/static/js/branding/branding_button/branding_preview.module.out-vflCB7aLX.css",(e=>"._brandingPreview_1nqmi_1{background:var(--dig-color__background__subtle);border:1px solid var(--dig-color__border__subtle);height:0;padding-bottom:66%;position:relative;width:100%}._brandingPreviewInner_1nqmi_13{bottom:0;display:flex;flex-direction:column;left:0;position:absolute;right:0;top:0}._brandingPreviewHeader_1nqmi_23{align-items:center;background:var(--dig-color__background__base);box-sizing:border-box;display:flex;height:10%;justify-content:space-between;padding:1.25% 3.37553%}._brandingPreviewButtonGroup_1nqmi_33{display:flex;height:100%;justify-content:space-between;width:100%}._brandingPreviewHeaderSpacer_1nqmi_40{flex-grow:1}._brandingPreviewButton_1nqmi_33{background:var(--dig-color__background__subtle);border-radius:12.5081%;height:100%;margin-right:1.63559%;width:6.53814%}._brandingPreviewButton_1nqmi_33:last-child{background:var(--dig-color__primary-cta__base)}._brandingPreviewBody_1nqmi_56{flex-grow:1;overflow:hidden;position:relative}._brandingPreviewFile_1nqmi_62{box-shadow:var(--dig-utilities__boxshadow__raised);height:0;left:50%;padding-top:77.27273%;position:absolute;top:0;transform:translateX(-40%) translateY(4%);width:56.11814%}._brandingPreviewVideoContainer_1nqmi_73{align-items:stretch;bottom:0;display:flex;justify-content:center;left:0;position:absolute;right:0;top:0}._brandingPreviewVideo_1nqmi_73{display:block;object-fit:cover;object-position:center;width:100%}._brandingPreviewLogoContainer_1nqmi_91{left:10%;position:absolute;top:10%;width:8.13203%;z-index:1}._brandingPreviewFolderLogoContainer_1nqmi_99{align-items:center;display:flex;height:100%;justify-content:center;position:relative}._brandingPreviewLogo_1nqmi_91{max-height:40px;max-width:40px;width:100%}._brandingPreviewFolder_1nqmi_99{background:var(--dig-color__background__subtle);border-radius:2px}._brandingPreviewFolderSection_1nqmi_118{background:var(--color__standard__background);display:grid;gap:8px;grid-template-columns:repeat(3,26.01156%);grid-template-rows:repeat(2,45.45455%);height:57.14286%;justify-content:center;padding:6.49351% 13.50211% 0}._brandingPreviewFolderHeader_1nqmi_129{height:36.36364%;position:relative}"));const ps="_brandingPreview_1nqmi_1",hs="_brandingPreviewInner_1nqmi_13",Es="_brandingPreviewButton_1nqmi_33",fs="_brandingPreviewFolder_1nqmi_99",vs=({isFolder:e,logo:n,background:i,backgroundId:o})=>{const s=r.useIntl(),l=k.default.useMemo((()=>{if(o){if(!i)return{backgroundImage:`url(https://showcase-marketing.dropboxstatic.com/premium_kit/${o}/original.png)`};switch(i.type){case t.TypeBackground.image:return{backgroundImage:`url(${i.src})`};case t.TypeBackground.color:return{backgroundColor:i.colorHex};case t.TypeBackground.video:return{}}}return{}}),[i,o]),_=k.default.useMemo((()=>n?k.default.createElement("img",{className:"_brandingPreviewLogo_1nqmi_91",src:n.src,alt:s.formatMessage(ms.logo)}):k.default.createElement(a.UIIcon,{src:f.ImageLine})),[n,s]),d=k.default.useMemo((()=>k.default.createElement("div",{className:"_brandingPreviewVideoContainer_1nqmi_73"},k.default.createElement("video",{className:"_brandingPreviewVideo_1nqmi_73",autoPlay:!0,loop:!0,muted:!0,playsInline:!0},k.default.createElement("source",{src:null==i?void 0:i.src,type:"video/mp4"})))),[i]),c=k.default.useMemo((()=>k.default.createElement("div",{className:ps},k.default.createElement("div",{className:hs},k.default.createElement("div",{className:"_brandingPreviewFolderHeader_1nqmi_129",style:{backgroundSize:"cover",backgroundPosition:"center center",...l}},"video"===(null==i?void 0:i.type)&&d,k.default.createElement("div",{className:"_brandingPreviewFolderLogoContainer_1nqmi_99"},_)),k.default.createElement("div",{className:"_brandingPreviewFolderSection_1nqmi_118"},k.default.createElement("div",{className:fs}),k.default.createElement("div",{className:fs}),k.default.createElement("div",{className:fs}),k.default.createElement("div",{className:fs}),k.default.createElement("div",{className:fs}),k.default.createElement("div",{className:fs}))))),[i,l,d,_]),u=k.default.useMemo((()=>k.default.createElement("div",{className:ps},k.default.createElement("div",{className:hs},k.default.createElement("div",{className:"_brandingPreviewHeader_1nqmi_23"},k.default.createElement("div",{className:Es}),k.default.createElement("div",{className:Es}),k.default.createElement("div",{className:Es}),k.default.createElement("div",{className:Es}),k.default.createElement("div",{className:"_brandingPreviewHeaderSpacer_1nqmi_40"}),k.default.createElement("div",{className:Es})),k.default.createElement("div",{className:"_brandingPreviewBody_1nqmi_56",style:{backgroundSize:"cover",backgroundPosition:"center center",...l}},"video"===(null==i?void 0:i.type)&&d,k.default.createElement("div",{className:"_brandingPreviewLogoContainer_1nqmi_91"},_),k.default.createElement("div",{className:"_brandingPreviewFile_1nqmi_62",style:{backgroundColor:"#fff"}}))))),[i,l,d,_]);return e?c:u};var Ss;!function(e){e.LOADING="loading",e.CLEAN="clean",e.DIRTY="dirty",e.SAVING="saving",e.ERROR="error"}(Ss||(Ss={}));a.injectInternalStyle("/static/metaserver/static/js/branding/branding_button/branding_panel.module.out-vflqYkgLA.css",(e=>"._brandingPanel_163pi_1{background:var(--dig-color__background__raised);border-radius:12px;box-shadow:var(--dig-utilities__boxshadow__raised);transform:translateX(-25%);width:280px}._brandingPanel_163pi_1._isLoading_163pi_11 ._brandingPanelSection_163pi_11{align-items:center;justify-content:center}._brandingPanelFooter_163pi_18,._brandingPanelSection_163pi_11,._brandingPanelTitle_163pi_16{box-sizing:border-box;display:flex;padding:var(--spacing__unit--1_5);width:100%}._brandingPanelFooter_163pi_18,._brandingPanelTitle_163pi_16{align-items:center;column-gap:var(--spacing__unit--1);flex-direction:row;justify-content:space-between}._brandingPanelTitle_163pi_16{border-bottom:1px solid var(--dig-color__border__subtle)}._brandingPanelSection_163pi_11{flex-direction:column;row-gap:var(--spacing__unit--2)}._brandingPanelFooter_163pi_18>*{flex-grow:1}"));const bs=({onRequestClose:e,onSaveSuccess:t,isFolder:n=!1,children:i})=>{const o=r.useIntl(),[s,l]=k.default.useState(Ss.LOADING),_=k.default.useMemo((()=>s===Ss.LOADING),[s]),d=k.default.useCallback((async()=>{try{l(Ss.CLEAN)}catch(e){}}),[]),c=k.default.useCallback((e=>{switch(e){case"reset":case"advanced":break;default:throw new Error("Invalid option")}}),[]),u=k.default.useCallback((()=>{null==e||e()}),[e]),g=k.default.useCallback((()=>{null==t||t()}),[t]);return k.default.useEffect((()=>{d()}),[d]),_?k.default.createElement(bs.Section,null,k.default.createElement(a.Spinner,{"aria-valuetext":o.formatMessage(ms.loading)})):k.default.createElement(k.default.Fragment,null,k.default.createElement(bs.Title,null,k.default.createElement(a.Title,{weightVariant:"emphasized",size:"small"},k.default.createElement(v.FormattedMessage,{id:"3r6Vu4",defaultMessage:"Add branding"})),k.default.createElement(a.Menu.Wrapper,{onSelection:c},(({getContentProps:e,getTriggerProps:t})=>k.default.createElement(k.default.Fragment,null,k.default.createElement(a.IconButton,{variant:"borderless",...t()},k.default.createElement(a.UIIcon,{src:a.MoreVerticalLine,"aria-label":o.formatMessage(ms.more)})),k.default.createElement(a.Menu.Content,{...e()},k.default.createElement(a.Menu.ActionItem,{key:"reset",value:"reset"},k.default.createElement(v.FormattedMessage,{id:"AKueE3",defaultMessage:"Reset"})),k.default.createElement(a.Menu.ActionItem,{key:"advanced",value:"advanced"},k.default.createElement(v.FormattedMessage,{id:"YLFiko",defaultMessage:"Advanced options"}))))))),k.default.createElement(bs.Section,{title:o.formatMessage(ms.brandName)}),k.default.createElement(bs.Section,null,k.default.createElement(vs,{isFolder:n})),k.default.createElement(bs.Section,{title:o.formatMessage(ms.background)}),k.default.createElement(bs.Section,null),k.default.createElement(bs.Footer,null,k.default.createElement(a.Button,{variant:"filled",onClick:u},k.default.createElement(v.FormattedMessage,{id:"1B7zHK",defaultMessage:"Cancel"})),k.default.createElement(a.Button,{variant:"primary",onClick:g},k.default.createElement(v.FormattedMessage,{id:"DNzH/r",defaultMessage:"Save"}))))};bs.Title=({children:e})=>k.default.createElement("div",{className:"_brandingPanelTitle_163pi_16"},e),bs.Section=({title:e,children:t})=>k.default.createElement("div",{className:"_brandingPanelSection_163pi_11"},e&&k.default.createElement(a.Text,{variant:"label",isBold:!0,size:"small",color:"subtle"},e),t),bs.Footer=({children:e})=>k.default.createElement("div",{className:"_brandingPanelFooter_163pi_18"},e);const ys=Symbol("ON_CLICK_OUTSIDE"),As=Symbol("ON_RESIZE"),ws=Symbol("ON_OPEN"),{useEmitter:Ts,defaultEmitter:Is}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(Ce),r=t(Ne),i=t(De),o={...Re(n),...Oe(r),...Pe(i)},s={...ke(n),...xe(r),...Fe(i)};e.key!==ws?e.key!==ys&&e.key!==As||a.UDCL.logEvent(we({...s,flexibleSharingEntryPointAction:e.payload.action,flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView||void 0}),{tags:{...o,action:e.payload.action}}):a.UDCL.logEvent(function(e){return{class:"sharing_sender",action:"view",object:"flexible_sharing_entrypoint",properties:e}}({...s}),{tags:o})}));a.injectInternalStyle("/static/metaserver/static/js/sharing/features/sharing_qr_code/get_qr_code_modal.module.out-vflNN1fVL.css",(e=>"._get-qr-code-modal_dbu8m_1>div{background-color:var(--dig-color__background__subtle);border:1px solid var(--dig-color__border__subtle)}._get-qr-code-modal-image_dbu8m_6{display:flex;width:100%}._get-qr-code-modal-spinner_dbu8m_11{align-items:center;aspect-ratio:1/1;display:flex;justify-content:center;width:100%}._get-qr-code-modal-body_dbu8m_19{padding-bottom:var(--spacing__unit--3);padding-top:calc(var(--spacing__unit--1)*6)}._get-qr-code-modal-filename_dbu8m_25{white-space:nowrap}@media (min-width:601px){._get-qr-code-modal-body_dbu8m_19{padding-top:var(--spacing__unit--3)}._get-qr-code-modal_dbu8m_1 button.dig-Modal-close-btn{display:none}}"));const Cs=()=>k.default.createElement("div",{className:"_get-qr-code-modal-spinner_dbu8m_11"},k.default.createElement(a.Spinner,{size:"medium"})),Rs=r.defineMessage({id:"UaJBfk",defaultMessage:"QR code for sharing"}),ks=r.defineMessage({id:"ZFsp0l",defaultMessage:"Download"}),Ms=r.defineMessage({id:"3O3ick",defaultMessage:"Anyone with this code can view. You can turn this link off in <a>link settings</a>."}),Ls=r.defineMessage({id:"bWq9cz",defaultMessage:"Couldn’t create QR code. You don’t have permission to create a QR code to this content."}),Ns=r.defineMessage({id:"tpMKHD",defaultMessage:"We can’t find this file anymore. Try checking activity or folder history to see what happened."}),Os=r.defineMessage({id:"zGqflr",defaultMessage:"You can’t share until you verify your email address."}),xs=r.defineMessage({id:"EioyeS",defaultMessage:"Couldn’t create, but it might be a fluke. Try reloading the page or ask us for help."});var Ds;!function(e){e.PATH_FORBIDDEN="path_forbidden",e.PATH_NOT_FOUND="path_not_found",e.EMAIL_NOT_VERIFIED="email_not_verified",e.SERVICE_UNAVAILABLE="service_unavailable",e.UNKNOWN="unknown"}(Ds||(Ds={}));const Ps=e=>`data:image/png;base64,${e}`,Fs=({base64QrCode:e})=>k.default.createElement("img",{"data-testid":"qr-code-modal-image",className:"_get-qr-code-modal-image_dbu8m_6",src:Ps(e),alt:r.intl.formatMessage(Rs)});Fs.displayName="GetQrCodeModalImage";const $s=({file:e,user:t,onSettingsClick:n,onGetQrCodeError:i})=>{const[o,s]=k.default.useState(!1),[l,_]=k.default.useState(""),d=e.file_id||e.fq_path,c=b.getFilename(e),u=k.default.useCallback(((n,r)=>{const i=a.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,o=y.get_browser_info();a.ShareTibEventLogger.log(t.id,n,i,{file_id:e.file_id,fq_path:e.fq_path,is_folder:e.is_dir,browser:o.browser,browser_version:o.version,...r})}),[t.id,e]),g=k.default.useCallback((()=>{s(!0);new a.FileShareApiClient({userApiProps:t}).getQrCode({fileIdOrPath:d}).then((e=>{var t;_(null!==(t=e.qrcode)&&void 0!==t?t:"");const n=e.link_url;if(n){const e=a.parseLink(n),t=e.doesContainShmodelLink?a.ShareTibEventLogger.get_shmodel_extra_for_logging(void 0,a.getCleanedSharingUrl(e)):a.ShareTibEventLogger.get_scl_extra_for_logging(void 0,a.getCleanedSharingUrl(e));u(a.TiburonEventName.CreateQrCode,t)}})).catch((e=>{var t;a.Snackbar.warn(r.intl.formatMessage((e=>{switch(e){case Ds.PATH_FORBIDDEN:return Ls;case Ds.PATH_NOT_FOUND:return Ns;case Ds.EMAIL_NOT_VERIFIED:return Os;case Ds.SERVICE_UNAVAILABLE:default:return xs}})(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t[".tag"]))),i&&i()})).finally((()=>{s(!1)}))}),[d,t,s,u]);k.default.useEffect((()=>{g()}),[g]);return k.default.createElement(k.default.Fragment,null,k.default.createElement(a.Box,{padding:"Micro XLarge",margin:"Macro Small",borderWidth:"1",borderColor:"Border Subtle",borderStyle:"Solid",backgroundColor:"Background Base",borderRadius:"XLarge"},!o&&l?k.default.createElement(Fs,{base64QrCode:l}):k.default.createElement(Cs,null),k.default.createElement(a.Box,{textAlign:"center",paddingTop:"Micro Large"},k.default.createElement(a.Text,{size:"medium",isBold:!0},a.Emstring.em_snippet(c,32,.5)))),k.default.createElement(a.Box,{marginX:"Macro Small",marginTop:"Micro Large",marginBottom:"Macro Small"},k.default.createElement(a.Button,{size:"large",variant:"primary",onClick:e=>{e.preventDefault(),((e,t)=>{const a=document.createElement("a");a.href=Ps(e),a.download=`${t}_QR.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a)})(l,c)},fullWidth:!0,disabled:o,"data-uxa-log":"download_qr_code_modal_button"},r.intl.formatMessage(ks)),k.default.createElement(a.Box,{marginTop:"Micro Large"},k.default.createElement(a.Text,null,r.intl.formatMessage(Ms,{a:e=>n?k.default.createElement(a.Link,{hasNoUnderline:!0,href:"#",onClick:e=>{e.preventDefault(),n()},"data-uxa-log":"settings_qr_code_modal_button"},e):k.default.createElement(a.Text,null,e)})))))};$s.displayName="GetQrCodeInner";const Hs=e=>{const{user:t,isLoading:n}=a.useActiveUser();return!n&&t?k.default.createElement($s,{...e,user:t}):null};Hs.displayName="GetQrCode";const Bs=({store:e})=>{const t=a.useStore(e.$props),n=Ts();k.useEffect((()=>{t.isOpen&&(n.select(ws).emit(null),e.$componentViewTime.set(Date.now()))}),[t.isOpen,n,e.$componentViewTime]);const r=a.useStore(e.$inbandTransitionDone),i=a.useStore(e.$isBrandingPanelOpen),o=(e=>k.useCallback((()=>{e.$inbandTransitionDone.set(!0)}),[e]))(e),s=a.useStore(e.$shouldHideNonInbandButtons),l=r||i,_=a.useStore(e.$currentScreen);k.useEffect((()=>{const t=()=>{if(e.$isClickawayLocked.get())return;const t=Date.now()-e.$componentViewTime.get(),a=e.$isInbandStarted.get()?"cancel_from_inband":"cancel";n.select(As).emit({timeSinceView:t,action:a}),e.$props.get().onRequestClose()};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[e,n]);const d=k.useCallback((()=>{if(e.$isClickawayLocked.get())return;const t=Date.now()-e.$componentViewTime.get(),a=e.$isInbandStarted.get()?"clickaway_from_inband":"clickaway";n.select(ys).emit({timeSinceView:t,action:a}),e.$props.get().onRequestClose()}),[e,n]),c=k.createElement(k.Fragment,null,k.createElement(ce,null,k.createElement(zs,{store:e})),!l&&k.createElement(ce,{styleName:a.cx({[ie]:s}),hidden:s||void 0,onAnimationEnd:()=>{o()}},k.createElement(ue,null,k.createElement(Us,{store:e})),k.createElement(ue,null,k.createElement(Vs,{store:e})))),{variant:u,isLoading:g}=a.useExperimentVariant("bmus_qr_code"),m="V1"===u,p=!g,h=k.useCallback((()=>{e.$props.get().settingsHandler({shouldOpenLinkSettings:!0}),e.$props.get().onActionClicked()}),[e]);a.useLogExposure("bmus_qr_code");const E=m?"filled":"transparent";return k.createElement(de,{onEscape:d,onClickOutside:d,anchorRef:t.displayModeRef,offsetDistance:5,placement:t.displayModePositioning,isOpen:t.isOpen},k.createElement(k.Fragment,null,_===ae.MAIN&&(i?k.createElement(qs,{store:e}):c),_===ae.MAIN&&!l&&k.createElement(ce,{styleName:a.cx(re,{[ie]:s,[ne]:m}),hidden:s||void 0,onAnimationEnd:()=>{o()}},k.createElement(Ws,{store:e}),p&&m&&k.createElement(Gs,{store:e,buttonVariant:E}),p&&k.createElement(js,{store:e,buttonVariant:E})),_===ae.QRCODE&&m&&k.createElement(Hs,{file:t.fileOrFolder,onSettingsClick:h,onGetQrCodeError:()=>{e.$props.get().onRequestClose()}})))};Bs.displayName="Inner";const Us=({store:e})=>{const t=a.useStore(e.$objectIdentifier),n=k.useCallback((()=>{e.$props.get().copyLinkHandler(!1,(()=>{}),(()=>{})),e.$props.get().onActionClicked()}),[e]),r="V4"===a.useStore(e.$progressiveInbandVariant);return k.createElement(Ge,{onClickCopyLinkButton:n,objectIdentifier:t,useRedesignedStyle:r})};Us.displayName="CopyLinkButton";const Vs=({store:e})=>{const t=a.useStore(e.$objectIdentifier),n=k.useCallback((()=>{e.$props.get().transferHandler(),e.$props.get().onActionClicked()}),[e]),r=a.useStore(e.$canContentUseTransfer),i=a.useStore(e.$canUserUseTransfer),o="V4"===a.useStore(e.$progressiveInbandVariant);return k.createElement(rs,{canContentUseTransfer:r,canUserUseTransfer:i,onClickTransferButton:n,objectIdentifier:t,useRedesignedStyle:o})};Vs.displayName="TransferButton";const zs=({store:e})=>{const t=a.useStore(e.$props),n=a.useStore(e.$inbandTransitionDone),r="V4"===a.useStore(e.$progressiveInbandVariant),i=(e=>k.useCallback((()=>{e.$shouldHideNonInbandButtons.set(!0)}),[e]))(e),[o,s]=k.useState([]),[l,_]=k.useState(""),d=k.useCallback((()=>{e.$isClickawayLocked.set(!0)}),[e]),c=k.useCallback((()=>{e.$isClickawayLocked.set(!1)}),[e]),u=k.useCallback((()=>{e.$isClickawayLocked.set(!1),e.$props.get().onInbandShareCompleted()}),[e]),g=k.useCallback((()=>{e.$isInbandStarted.set(!0)}),[e]),m=k.useCallback((()=>{e.$isClickawayLocked.set(!1)}),[e]),p=k.useCallback(((t,a)=>{e.$props.get().copyLinkHandler(!0,t,a)}),[e]);return k.createElement($o,{objectIdentifier:t.objectIdentifier,inviteMessage:l,inviteTargets:o,hasUpdatedAccountMetadata:!1,onLinkSettingsClick:()=>{},onCloseClick:()=>t.onRequestClose(),onManageAccessClick:()=>{},onTargetsDropdownFocusChange:()=>{},onInviteMessageChange:_,onInviteTargetsChange:s,onSettingsClick:()=>{},onShareStart:d,onShareFailure:c,onInbandShareSuccess:u,onCopyLinkSuccess:m,onButtonsAnimationStart:i,useRedesignedStyle:r,inbandTransitionDone:n,onStartInband:g,onCopyLinkClick:p,shouldShowCopyLinkButton:!0})};zs.displayName="InbandInviteButton";const js=({store:e,buttonVariant:t})=>{const n=a.useStore(e.$objectIdentifier),r=k.useCallback((t=>{e.$props.get().settingsHandler(t),e.$props.get().onActionClicked()}),[e]),i="V4"===a.useStore(e.$progressiveInbandVariant);return k.createElement(Ko,{onClickSettingsButton:r,objectIdentifier:n,useRedesignedStyle:i,buttonVariant:t})};js.displayName="SettingsButton";const Gs=({store:e,buttonVariant:t})=>{const n=k.useCallback((()=>{e.$currentScreen.set(ae.QRCODE)}),[e]),r="V4"===a.useStore(e.$progressiveInbandVariant);return k.createElement(gs,{onClickQrCodeButton:n,buttonVariant:t,useRedesignedStyle:r})};Gs.displayName="QrCodeButton";const qs=({store:e})=>{const t=a.useStore(e.$props);return k.createElement(bs,{fileExtension:t.fileOrFolder.ext,isFolder:t.fileOrFolder.is_dir,onSaveSuccess:()=>{},onRequestClose:()=>{e.$isBrandingPanelOpen.set(!1)}})};qs.displayName="BrandingPanel";const Ws=({store:e})=>{const t=a.useStore(e.$props),n=k.useMemo((()=>a.getFilename(t.fileOrFolder)),[t.fileOrFolder]),i=S.formatBytes(r.intl,t.fileOrFolder.bytes,2,!1),o="V1"===a.useExperimentVariant("bmus_qr_code").variant,s="V4"===a.useStore(e.$progressiveInbandVariant);return k.createElement("div",{className:a.cx(s?se:oe,{[_e]:o})},k.createElement(a.Text,{size:"medium",isBold:!0,className:le},k.createElement(a.Truncate,{location:.5},n)),k.createElement("div",null,k.createElement(a.Text,{size:"medium",color:"subtle",className:le},t.fileOrFolder.is_dir?r.intl.formatMessage({id:"4mDOPx",defaultMessage:"Folder"}):i)))};Ws.displayName="FileOrFolderInfoSection";const Ks=({children:e})=>{const t=xt();return k.createElement(a.ContextProvider,{context:De,value:"loaded"===t.status?t.objectMetadata:null},k.createElement(et,{sharingObjectMetadata:"loaded"===t.status?t.objectMetadata:void 0,sharingPrefs:"loaded"===t.status?t.sharingPrefs:void 0,sharingObjectIdentifier:"loaded"===t.status?t.objectIdentifier:void 0,shareMe24Metadata:{isShareMe24:!0}},e))};Ks.displayName="LoggingMetadataProvider";r.createIntl({locale:"en"});const Ys=({children:e,intl:t})=>t?k.createElement(r.Provider,{value:t},e):e;Ys.displayName="Provider";const Qs=ot({name:"sharing_receiving.SharingTiburonLogger"},(e=>t=>{const a={...t,extras:Xs(Js(JSON.stringify(t.extras)))};return it(e.sharingReceivingSharingTiburonLogger(a))})),Zs=e=>e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65,Xs=e=>{let t=2,a="";const n=e.length;let r=0;for(let i=0;i<n;i++)t=i%3,i>0&&4*i/3%76==0&&(a+="\r\n"),r|=e[i]<<(16>>>t&24),2!==t&&e.length-i!=1||(a+=String.fromCodePoint(Zs(r>>>18&63),Zs(r>>>12&63),Zs(r>>>6&63),Zs(63&r)),r=0);return a.substr(0,a.length-2+t)+(2===t?"":1===t?"=":"==")},Js=e=>{let t;const a=e.length;let n=0;for(let r=0;r<a;r++)t=e.codePointAt(r),t>65536&&r++,n+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;const r=new Uint8Array(n);let i=0,o=0;for(;i<n;)t=e.codePointAt(o),t<128?r[i++]=t:t<2048?(r[i++]=192+(t>>>6),r[i++]=128+(63&t)):t<65536?(r[i++]=224+(t>>>12),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t)):t<2097152?(r[i++]=240+(t>>>18),r[i++]=128+(t>>>12&63),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t),o++):t<67108864?(r[i++]=248+(t>>>24),r[i++]=128+(t>>>18&63),r[i++]=128+(t>>>12&63),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t),o++):(r[i++]=252+(t>>>30),r[i++]=128+(t>>>24&63),r[i++]=128+(t>>>18&63),r[i++]=128+(t>>>12&63),r[i++]=128+(t>>>6&63),r[i++]=128+(63&t),o++),o++;return r},el=e=>{if(e.access_type)switch(e.access_type[".tag"]){case"owner":return"owner";case"editor":return"writer";default:return"reader"}},tl=e=>({user_access_type:el(e),is_folder:a.getIsFolder(e),fq_path:e.path_lower,content_id:a.getIsFile(e)?e.id:a.getIsSharedFolder(e)?e.shared_folder_id:a.getIsFolder(e)?e.path_lower:a.getIsCollection(e)?e.collectionId:"",...{...a.getIsSharedFolder(e)||a.getIsCollection(e)?{ns_id:e.shared_folder_id}:{}},can_create_edit_link:a.getCanDoAction(e,a.CREATE_EDIT_LINK_TAG),can_create_view_link:a.getCanDoAction(e,a.CREATE_VIEW_LINK_TAG),can_edit_inband_invite:a.getCanDoAction(e,a.INVITE_EDITOR_TAG),can_view_inband_invite:a.getCanDoAction(e,a.INVITE_VIEWER_TAG),max_access:a.getCanDoAction(e,a.CREATE_EDIT_LINK_TAG)||a.getCanDoAction(e,a.INVITE_EDITOR_TAG)?"editor":"viewer"}),al=e=>e&&"other"!==e[".tag"]?"viewer"===e[".tag"]?"reader":"writer":null,nl=e=>{const t={link_id:e.id,link_access_level:(n=e.link_permissions.link_access_level,n?n[".tag"]:a.VIEWER[".tag"]),audience:a.getCurrentAudience(e)[".tag"]};var n;const r=(e=>{const t=new URL(e);if(t.search.includes("rlkey"))return{kind:"rlkey",val:t.searchParams.get("rlkey"),link_type:"righteous"};if(t.pathname.includes("/s/")||t.pathname.includes("/sh/")){const e=e=>e.pathname.includes("/raw/")||e.pathname.includes("/dl/")||e.pathname.includes("/print/"),a=e(t)?3:2;return{kind:"tkey",val:t.pathname.split("/")[a],link_type:"shmodel"}}return null})(e.url);return r&&(t[r.kind]=r.val,t.link_type=r.link_type),t},rl=e=>{const t={tray_style:e.loggingExtras.tray_style,tray_variants:e.loggingExtras.variants};return{platform_name:e.platformName,platform_version:e.platformVersion,build_channel:e.buildChannel,build_number:e.buildNumber,...t}},il=(e,t,n,r)=>{const i=t.shareModalSessionId,o=t.sharingObjectMetadata,s=t.desktopMetadata;return i&&(r={...r,modal_session_id:i}),t.sharingObjectIdentifier&&("file"===t.sharingObjectIdentifier[".tag"]?r={...r,file_id:t.sharingObjectIdentifier.fileId}:"shared_folder"===t.sharingObjectIdentifier[".tag"]?r={...r,ns_id:t.sharingObjectIdentifier.sharedFolderId}:"file_folder"===t.sharingObjectIdentifier[".tag"]?r={...r,fq_path:t.sharingObjectIdentifier.path}:"collection"===t.sharingObjectIdentifier[".tag"]&&(r={...r,ns_id:t.sharingObjectIdentifier.nsId,collection_id:t.sharingObjectIdentifier.collectionId})),o&&o.path_lower&&(r={...r,fq_path:o.path_lower}),o&&a.getIsFile(o)&&(r={...r,file_id:o.id}),o&&a.getIsSharedFolder(o)&&(r={...r,ns_id:o.shared_folder_id}),o&&a.getIsCollection(o)&&(r={...r,ns_id:o.shared_folder_id,collection_id:o.collectionId}),s&&(r={...r,...rl(s)}),{share_tiburon_event_type:e,share_tib_action_origin_type:n,extras:r}},ol=(e,t,a,n)=>{const r=t.shareModalSessionId,i=t.sharingLinkMetadata,o=t.sharingObjectMetadata,s=t.desktopMetadata;return r&&(n={...n,modal_session_id:r}),i&&(n={...n,...nl(i)}),o&&(n={...n,...tl(o)}),s&&(n={...n,...rl(s)}),{share_tiburon_event_type:e,share_tib_action_origin_type:a,extras:n}},sl=/^(?:([^:\/\\?#]+):)?(?:[\/\\]{2}([^\/\\?#]*))?([^?#]*)(?:\?([^#]*))?(?:[#](.*))?$/;class ll{constructor(e={}){this.dict={},this.add(e)}static parseString(e){if(!e)return{};const t={};return e.split("&").forEach((e=>{if(""!==e){const a=e.split("="),n=ll.decode(a[0]),r=ll.decode(a.slice(1).join("="));if(t.hasOwnProperty(n)){const e=t[n];let a;a="string"==typeof e?[e]:void 0===e?[]:e,a.push(r),t[n]=a}else t[n]=r}})),t}add(e,t){if("string"==typeof e)t&&(Array.isArray(t)?this.dict[e]=t.map(String):this.dict[e]=String(t));else for(const t in e)if(e.hasOwnProperty(t)){const a=e[t];null!=a&&(Array.isArray(a)?this.dict[t]=a.map(String):this.dict[t]=String(a))}return this}remove(e){return delete this.dict[e],this}replace(e){return this.dict=e,this}toString(e){const t=[],a=Object.keys(this.dict).sort(e);for(const e of a)if(this.dict.hasOwnProperty(e)){const a=this.dict[e];Array.isArray(a)?a.forEach((a=>{t.push(ll.encode(e)+"="+ll.encode(a))})):t.push(ll.encode(e)+"="+ll.encode(a))}return t.length?t.join("&"):""}static decode(e){return null==e?"":_l.decode(e.replace(/\+/g,"%20"))}static encode(e){return null==e?"":_l.encode(e).replace(/%20/g,"+")}}class _l{constructor(e={}){this.query=new ll,this.initFromObject(e)}initFromObject(e){this.setScheme(e.scheme),this.authority=e.authority||"",this.path=e.path||"",this.setQuery(e.query),this.fragment=e.fragment||""}getScheme(){return this.scheme}getAuthority(){return this.authority}getPath(){return this.path}getQuery(){return this.query.dict}getFragment(){return this.fragment}setScheme(e=""){return this.scheme=e,this}setAuthority(e=""){return this.authority=e,this}setPath(e=""){return this.path=e,this}setQuery(e={}){return this.query=new ll(e),this}setFragment(e=""){return this.fragment=e,this}updateQuery(e,t){return this.query.add(e,t),this}removeQuery(e){return this.query.remove(e),this}clone(){return new _l(this.toObject())}toObject(){return{scheme:this.getScheme(),authority:this.getAuthority(),path:this.getPath(),query:this.getQuery(),fragment:this.getFragment()}}toString(e){let t="";return this.scheme&&(t+=this.scheme+":"),this.authority&&(t+="//"+_l.encode(this.authority,":@[]")),t+this.toRelativeUri(e)}toRelativeUri(e){let t="";this.path&&(t+=_l.encode(this.path,"/"));const a=this.query.toString(e);return a&&(t+="?"+a),this.fragment&&(t+="#"+_l.encode(this.fragment,":@[]/&=+?#!")),t}static parse(e){const t=String(e).match(sl)||[],[,a,n,r,i,o]=t,s=new _l;return s.setScheme(a),s.setAuthority(_l.decode(n)),s.setPath(_l.decode(r)),s.setQuery(ll.parseString(i)),s.setFragment(_l.decode(o)),s}static decode(e){return e?decodeURIComponent(e):""}static encode(e,t=""){if(!e)return"";e=encodeURIComponent(e),t+="~";for(const a of t){const t=encodeURIComponent(a);e=e.replace(new RegExp(t,"g"),a)}return e}static encode_parts(e,t="/"){return e.split(t).map((e=>_l.encode(e))).join(t)}}function dl(e){if(!e)return;const t=_l.parse(e).getQuery();if(t&&"st"in t){const e=t.st;return Array.isArray(e)?e[0]:e}}_l.Query=ll;const cl=(e,t)=>{let a={is_alpha:!0};return t.sharingAccessLevel&&(a={...a,access:t.sharingAccessLevel[".tag"]}),e.createSharedLinkStartTime&&(a={...a,timing:Date.now()-e.createSharedLinkStartTime}),a={...a,include_ns_creation:!1},a},ul=e=>{if(e.shareMe24Metadata){if(e.shareMe24Metadata.isAddMembersDirectlyInMemberList)return a.ScreenName.ManageAccessScreen;if(e.shareMe24Metadata.isShareMe24)return a.ScreenName.ShareMe24ShareScreen}return a.ScreenName.ShareScreen},gl=()=>{const e=(()=>{const e=tt(Qs);return k.useMemo((()=>({SHARE_MODAL_SHARE__PREVALIDATION__API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptTargetValidation,t,r,n))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptTargetValidation,t,r,n))},SHARE_MODAL_SHARE__PREVALIDATION__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedTargetValidation,t,r,n))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedTargetValidation,t,r,n))},SHARE_MODAL_SHARE__PREVALIDATION__API_ERROR:({event:t,metadata:n,extras:r,origin:i})=>{e(il(a.TiburonEventName.FailTargetValidation,n,i,{...r,error:t.payload.error[".tag"]}))},SHARE_MODAL_SHARE__PREVALIDATION__API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailTargetValidation,t,r,{...n,error:"unknown server error"}))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_ERROR:({event:t,metadata:n,extras:r,origin:i})=>{e(il(a.TiburonEventName.FailTargetValidation,n,i,{...r,error:t.payload.error[".tag"]}))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailTargetValidation,t,r,{...n,error:"unknown server error"}))},SHARE_MODAL_MANAGE_ACCESS__MANAGE_ACCESS__CLICK:({metadata:t,extras:n,origin:r})=>{t.sharingObjectMembership&&(n={...n,access_level:t.sharingObjectMembership.access_type[".tag"]}),e(il(a.TiburonEventName.ClickManageAccess,t,r,n))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_MEMBER_ACCESS__CLICK:({event:t,metadata:n,extras:r,origin:i})=>{e(il(a.TiburonEventName.SelectChangeMemberPermission,n,i,{...r,new_access:"editor"===t.payload.next[".tag"]?"writer":"reader",old_access:"editor"===t.payload.previous[".tag"]?"writer":"reader"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedChangeMemberPermission,t,r,{...n,http_status_code:200,response_status:"success",is_alpha:!1}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedChangeMemberPermission,t,r,{...n,http_status_code:200,response_status:"success",is_alpha:!1}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailChangeMemberPermission,t,r,{...n,is_alpha:!1,http_status_code:0,error_tag:"undefined"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_ERROR:({event:t,metadata:n,extras:r,origin:i})=>{e(il(a.TiburonEventName.FailChangeMemberPermission,n,i,{...r,is_alpha:!1,http_status_code:t.payload.response.statusCode,error_tag:t.payload.response.error[".tag"]}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailChangeMemberPermission,t,r,{...n,is_alpha:!1,http_status_code:0,error_tag:"undefined"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_ERROR:({event:t,metadata:n,extras:r,origin:i})=>{e(il(a.TiburonEventName.FailChangeMemberPermission,n,i,{...r,is_alpha:!1,http_status_code:t.payload.response.statusCode,error_tag:t.payload.response.error[".tag"]}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_ERROR:({event:t,metadata:n,extras:r,origin:i})=>{e(il(a.TiburonEventName.FailTransferFolder,n,i,{...r,is_alpha:!1,http_status_code:t.payload.response.statusCode,error_tag:t.payload.response.error[".tag"]}))},SHARE_MODAL_SHARE__CREATE_LINK__API_START:({metadata:t,extras:n,origin:r,cache:i})=>{t.sharingAccessLevel&&(n={...n,access:t.sharingAccessLevel[".tag"]}),i.createSharedLinkStartTime=Date.now(),e(il(a.TiburonEventName.AttemptCreateSharedLinkWithSettings,t,r,n))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_START:({metadata:t,extras:n,origin:r,cache:i})=>{t.sharingAccessLevel&&(n={...n,access:t.sharingAccessLevel[".tag"]}),i.createSharedLinkStartTime=Date.now(),e(il(a.TiburonEventName.AttemptCreateSharedLinkWithSettings,t,r,n))},SHARE_MODAL_SHARE__CREATE_LINK__API_SUCCESS:({metadata:t,event:n,origin:r,extras:i,cache:o})=>{(t={...t,sharingLinkMetadata:n.payload.response.output}).sharingLinkMetadata&&(i={...i,...nl(t.sharingLinkMetadata)}),e(il(a.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,r,{http_status_Code:200,response_status:"success",...cl(o,t),...i}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_SUCCESS:({metadata:t,event:n,origin:r,extras:i,cache:o})=>{(t={...t,sharingLinkMetadata:n.payload.response.output}).sharingLinkMetadata&&(i={...i,...nl(t.sharingLinkMetadata)}),e(il(a.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,r,{http_status_Code:200,response_status:"success",...cl(o,t),...i}))},SHARE_MODAL_SHARE__CREATE_LINK__API_ERROR:({metadata:t,event:n,extras:r,origin:i,cache:o})=>{"shared_link_already_exists"!==n.payload.response.error[".tag"]?e(il(a.TiburonEventName.FailCreateSharedLinkWithSettings,t,i,{error_tag:n.payload.response.error[".tag"],http_status_code:n.payload.response.statusCode,fail_at:"link_creation",...cl(o,t),...r})):e(il(a.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,i,{http_status_code:n.payload.response.statusCode,response_status:"success",...cl(o,t),...r}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_ERROR:({metadata:t,extras:n,cache:r,origin:i,event:o})=>{"shared_link_already_exists"!==o.payload.response.error[".tag"]?e(il(a.TiburonEventName.FailCreateSharedLinkWithSettings,t,i,{error_tag:o.payload.response.error[".tag"],http_status_code:o.payload.response.statusCode,fail_at:"link_creation",...cl(r,t),...n})):e(il(a.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,i,{http_status_code:o.payload.response.statusCode,response_status:"success",...cl(r,t),...n}))},SHARE_MODAL_SHARE__CREATE_LINK__API_FATAL:({metadata:t,extras:n,origin:r,cache:i})=>{e(il(a.TiburonEventName.FailCreateSharedLinkWithSettings,t,r,{fail_at:"link_creation",...cl(i,t),http_status_code:0,error_tag:"undefined_error",...n}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_FATAL:({metadata:t,extras:n,origin:r,cache:i})=>{e(il(a.TiburonEventName.FailCreateSharedLinkWithSettings,t,r,{fail_at:"link_creation",...cl(i,t),http_status_code:0,error_tag:"undefined_error",...n}))},SHARE_MODAL_SHARE__CREATE_LINK__CLICK:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.ClickTibCreateLink,t,r,n))},SHARE_MODAL_SETTINGS__CREATE_LINK__CLICK:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.ClickTibCreateLink,t,r,n))},SHARE_MODAL_SHARE__INVITE__START:({metadata:t,extras:n,origin:r,cache:i})=>{i.inviteStartTime=Date.now(),e(il(a.TiburonEventName.ClickInbandShareButton,t,r,{in_progress:!1,access_level:al(t.sharingAccessLevel),screen:ul(t),...n}));const o=t.sharingLinkMetadata;o&&e(ol(a.TiburonEventName.ClickShareButtonLinkSettingsStatus,t,r,{...n,isPasswordRequired:o.link_permissions.require_password||!1,isExpirationEnabled:!!o.expires,isDisabledDownloadEnabled:!o.link_permissions.allow_download}))},SHARE_MODAL_SHARE__COPY_LINK__CLICK:({metadata:t,extras:n,origin:r})=>{var i,o;e(ol(a.TiburonEventName.CopySharedLink,t,r,{...n,tokenized_contact_count:null===(i=t.sharingInviteTargets)||void 0===i?void 0:i.length,sender_trackey:dl(null===(o=t.sharingLinkMetadata)||void 0===o?void 0:o.url)}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_START:({metadata:t,event:n,origin:r,extras:i})=>{var o,s;t={...t,sharingLinkMetadata:n.payload.linkMetadata},e(ol(a.TiburonEventName.CopySharedLink,t,r,{...i,tokenized_contact_count:null===(o=t.sharingInviteTargets)||void 0===o?void 0:o.length,sender_trackey:dl(null===(s=t.sharingLinkMetadata)||void 0===s?void 0:s.url)}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_ERROR:({metadata:t,extras:n,origin:r})=>{var i;e(ol(a.TiburonEventName.CopySharedLinkFailure,t,r,{...n,tokenized_contact_count:null===(i=t.sharingInviteTargets)||void 0===i?void 0:i.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__COPY_LINK__COPY_ERROR:({metadata:t,extras:n,origin:r})=>{var i;e(ol(a.TiburonEventName.CopySharedLinkFailure,t,r,{...n,tokenized_contact_count:null===(i=t.sharingInviteTargets)||void 0===i?void 0:i.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_FORBIDDEN:({metadata:t,extras:n,origin:r})=>{var i;e(ol(a.TiburonEventName.CopySharedLinkFailure,t,r,{...n,tokenized_contact_count:null===(i=t.sharingInviteTargets)||void 0===i?void 0:i.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__INVITE__CANCELLED:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailInbandShare,t,r,{error_tag:"contacts_error",error_message:"contact validation error",num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,access_level:al(t.sharingAccessLevel),screen:ul(t),...n}))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_ERROR:({metadata:t,extras:n,origin:r,cache:i,event:o})=>{i.inviteStartTime&&(n.timing=Date.now()-i.inviteStartTime),e(ol(a.TiburonEventName.FailInbandShare,t,r,{...n,error_tag:o.payload.response.error[".tag"],http_status_code:o.payload.response.statusCode,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ul(t)}))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_FATAL:({metadata:t,extras:n,origin:r,cache:i})=>{i.inviteStartTime&&(n.timing=Date.now()-i.inviteStartTime),e(ol(a.TiburonEventName.FailInbandShare,t,r,{...n,error_tag:"undefined",http_status_code:0,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ul(t)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_ERROR:({event:t,metadata:n,extras:r,origin:i,cache:o})=>{o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),e(ol(a.TiburonEventName.FailInbandShare,n,i,{...r,error_tag:t.payload.response.error[".tag"],http_status_code:t.payload.response.statusCode,num_recipients:n.sharingInviteTargets?n.sharingInviteTargets.length:0,screen:ul(n)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_FATAL:({metadata:t,extras:n,origin:r,cache:i})=>{i.inviteStartTime&&(n={...n,timing:Date.now()-i.inviteStartTime}),e(ol(a.TiburonEventName.FailInbandShare,t,r,{...n,error_tag:"undefined",http_status_code:0,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ul(t)}))},SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__FAILURE:({event:t,metadata:n,extras:r,origin:i,cache:o})=>{var s;o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),"ApiError"===t.payload.output.type||"PollingApiError"===t.payload.output.type?r={...r,error_tag:t.payload.output.value.response.error[".tag"],http_status_code:t.payload.output.value.response.statusCode}:"NetworkFailure"===t.payload.output.type||"PollingNetworkFailure"===t.payload.output.type?r={...r,error_tag:"network",http_status_code:null!==(s=t.payload.output.value.response.statusCode)&&void 0!==s?s:0}:"PollingFailed"===t.payload.output.type?r={...r,error_tag:"failed",http_status_code:0}:"PollingTimeout"===t.payload.output.type&&(r={...r,error_tag:"network",http_status_code:408}),e(ol(a.TiburonEventName.FailInbandShare,n,i,{...r,num_recipients:n.sharingInviteTargets?n.sharingInviteTargets.length:0,screen:ul(n)}))},SHARE_MODAL_SETTINGS__PAGE_VIEW:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.ViewSettingsScreen,t,r,{...n,settings_tab:i.payload.selected_tab})),e(il(a.TiburonEventName.ViewSettingsTab,t,r,{...n,settings_tab:i.payload.selected_tab}))},SHARE_MODAL_SETTINGS__TAB_CHANGE:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.ViewSettingsTab,t,r,{...n,settings_tab:i.payload.selected_tab}))},SHARE_MODAL_MANAGE_ACCESS__SETTINGS_GEAR__CLICK:({metadata:t,extras:n,origin:r})=>{e(ol(a.TiburonEventName.ClickSettingsGear,t,r,{...n,screen:a.ScreenName.ManageAccessScreen}));const i=t.sharingObjectMetadata;i&&(a.getIsFile(i)?e(il(a.TiburonEventName.OpenFileSettingsModal,t,r,n)):a.getIsFolder(i)&&e(il(a.TiburonEventName.OpenFolderSettingsModal,t,r,n)))},SHARE_MODAL_MANAGE_ACCESS__SETTINGS_TEXT__CLICK:({metadata:t,extras:n,origin:r,event:i})=>{e(ol(a.TiburonEventName.ClickManageAccessPageSettingsText,t,r,{...n,screen:a.ScreenName.ManageAccessScreen,settings_tab:i.payload.settings_tab,link_access_level:i.payload.link_access_level,link_type:i.payload.link_type}));const o=t.sharingObjectMetadata;o&&e(il(a.getIsFile(o)?a.TiburonEventName.OpenFileSettingsModal:a.TiburonEventName.OpenFolderSettingsModal,t,r,n))},SHARE_MODAL_SHARE__SETTINGS_GEAR__CLICK:({metadata:t,extras:n,origin:r})=>{e(ol(a.TiburonEventName.ClickSettingsGear,t,r,{...n,screen:a.ScreenName.ShareScreen}));const i=t.sharingObjectMetadata;i&&(a.getIsFile(i)?e(il(a.TiburonEventName.OpenFileSettingsModal,t,r,n)):a.getIsFolder(i)&&e(il(a.TiburonEventName.OpenFolderSettingsModal,t,r,n)))},SHARE_MODAL_SHARE__SETTINGS_LINK__CLICK:({metadata:t,extras:n,origin:r})=>{n=t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?{...n,settings_tab:"edit_link_settings"}:{...n,settings_tab:"view_link_settings"},e(ol(a.TiburonEventName.ClickSettingsText,t,r,n))},SHARE_MODAL_SHARE__MODIFY_LINK__CLICK:({metadata:t,extras:n,origin:r})=>{n=t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?{...n,settings_tab:"edit_link_settings"}:{...n,settings_tab:"view_link_settings"},e(ol(a.TiburonEventName.OpenLinkSettingsModal,t,r,n))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_SUCCESS:({metadata:t,extras:n,origin:r,cache:i})=>{i.inviteStartTime&&(n={...n,timing:Date.now()-i.inviteStartTime}),e(il(a.TiburonEventName.SucceedInbandShare,t,r,{...n,access_level:al(t.sharingAccessLevel),num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ul(t)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_SUCCESS:({metadata:t,extras:n,cache:r,origin:i})=>{r.inviteStartTime&&(n={...n,timing:Date.now()-r.inviteStartTime}),e(il(a.TiburonEventName.SucceedInbandShare,t,i,{...n,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ul(t)}))},SHARE_MODAL_SHARE__INVITE__NAVIGATE_ATTEMPT:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptNavigateAwayDuringShare,t,r,n))},SHARE_MODAL_SHARE__INVITE__NAVIGATE_AWAY:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedNavigateAwayDuringShare,t,r,n))},SHARE_MODAL_SETTINGS__UPSELL_LINK__CLICKED:({event:t,metadata:n,extras:r,origin:i})=>{r={...r,element_trackingId:"link_settings_pro_upsell",element_href:t.payload.href},e(il(a.TiburonEventName.ElementClick,n,i,r))},SHARE_MODAL_SETTINGS__UPSELL_LINK__EXPOSED:({event:t,metadata:n,extras:r,origin:i})=>{r={...r,element_trackingId:"link_settings_pro_upsell",element_href:t.payload.href},e(il(a.TiburonEventName.ElementView,n,i,r))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptRemoveAllMembers,t,r,n))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_ERROR:({metadata:t,event:n,origin:r,extras:i})=>{e(il(a.TiburonEventName.FailRemoveAllMembers,t,r,{http_status_code:n.payload.response.statusCode,error_message:n.payload.response.error[".tag"],...i}))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailRemoveAllMembers,t,r,{http_status_code:0,error_message:"undefined_error",...n}))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedRemoveAllMembers,t,r,{http_status_code:200,response_status:"success",...n}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptRemoveMember,t,r,n))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptRemoveMember,t,r,n))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptRemoveMember,t,r,{relinquish_membership:!0,...n}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptRemoveMember,t,r,{relinquish_membership:!0,...n}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_ERROR:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.FailRemoveMember,t,r,{http_status_code:i.payload.response.statusCode,error_tag:i.payload.response.error[".tag"],...n}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailRemoveMember,t,r,{http_status_code:0,error_tag:"undefined_error",...n}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_ERROR:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.FailRemoveMember,t,r,{relinquish_membership:!0,http_status_code:i.payload.response.statusCode,error_tag:i.payload.response.error[".tag"],...n}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailRemoveMember,t,r,{relinquish_membership:!0,http_status_code:0,error_tag:"undefined_error",...n}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_FAILURE:({event:t,metadata:n,extras:r,origin:i,cache:o})=>{o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),"ApiError"===t.payload.output.type||"PollingApiError"===t.payload.output.type?r={...r,error_tag:t.payload.output.value.response.error[".tag"],http_status_code:t.payload.output.value.response.statusCode}:"NetworkFailure"===t.payload.output.type||"PollingNetworkFailure"===t.payload.output.type?r={...r,error_tag:"unknown",http_status_code:0}:"PollingFailed"===t.payload.output.type?r={...r,error_tag:"failed",http_status_code:0}:"PollingTimeout"===t.payload.output.type&&(r={...r,error_tag:"timeout",http_status_code:0}),e(ol(a.TiburonEventName.FailRemoveMember,n,i,r))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_FAILURE:({event:t,metadata:n,extras:r,origin:i,cache:o})=>{o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),"ApiError"===t.payload.output.type||"PollingApiError"===t.payload.output.type?r={...r,error_tag:t.payload.output.value.response.error[".tag"],http_status_code:t.payload.output.value.response.statusCode}:"NetworkFailure"===t.payload.output.type||"PollingNetworkFailure"===t.payload.output.type?r={...r,error_tag:"unknown",http_status_code:0}:"PollingFailed"===t.payload.output.type?r={...r,error_tag:"failed",http_status_code:0}:"PollingTimeout"===t.payload.output.type&&(r={...r,error_tag:"timeout",http_status_code:0}),e(ol(a.TiburonEventName.FailRemoveMember,n,i,{relinquish_membership:!0,...r}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedRemoveMember,t,r,{http_status_code:200,...n}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedRemoveMember,t,r,{http_status_code:200,...n}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedRemoveMember,t,r,{relinquish_membership:!0,http_status_code:200,...n}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedRemoveMember,t,r,{relinquish_membership:!0,http_status_code:200,...n}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptTransferFolder,t,r,n))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailTransferFolder,t,r,{http_status_code:0,error_tag:"undefined_error",...n}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedTransferFolder,t,r,{http_status_code:200,...n}))},SHARE_MODAL_DATA_LOADER__INITIAL_LOADER__START:({metadata:t,extras:n,origin:r,cache:i})=>{i.shareModalDataLoadStartTime=Date.now(),i.inviteStartTime=void 0,i.createSharedLinkStartTime=void 0,e(il(a.TiburonEventName.BeginShareFlow,t,r,n))},SHARE_MODAL_DATA_LOADER__INITIAL_LOADER__SUCCESS:({metadata:t,extras:n,origin:r,cache:i})=>{i.shareModalDataLoadStartTime&&(n={...n,timing:Date.now()-i.shareModalDataLoadStartTime}),e(il(a.TiburonEventName.ViewShareModal,t,r,n))},SHARE_MODAL_RELINQUISHED_SCREEN__VIEW:({metadata:t,extras:n,origin:r,cache:i})=>{n={...n,is_relinquished_screen:!0},i.shareModalDataLoadStartTime&&(n={...n,timing:Date.now()-i.shareModalDataLoadStartTime}),e(il(a.TiburonEventName.ViewShareModal,t,r,n))},SHARE_MODAL_ERROR_SCREEN__VIEW:({metadata:t,extras:n,origin:r,event:i})=>{if("response"in i.payload.initialLoadError){const e=i.payload.initialLoadError.response;let t;e.status!==at.FATAL&&(t=e.error[".tag"]);const a=e.error;n={...n,http_status_code:e.statusCode,error_summary:t,error_message:a,failing_endpoint:i.payload.initialLoadError.type}}else n={...n,event:i};e(il(a.TiburonEventName.ViewErrorScreen,t,r,n))},SHARE_MODAL_SETTINGS__LINK_AUDIENCE_CHANGE:({metadata:t,extras:n,origin:r,event:i})=>{if(t.sharingLinksMetadata){const e=a.getByAccessLevel(t.sharingLinksMetadata,i.payload.link_access_level);e&&(n={...n,...nl(e)})}e(il(a.TiburonEventName.ChangeSharedLinkAudience,t,r,{old_audience:i.payload.previous[".tag"],new_audience:i.payload.next[".tag"],screen:a.ScreenName.SettingsScreen,...n}))},SHARE_MODAL_MANAGE_ACCESS__PARENT_FOLDER_CHANGE_ACCESS_MODAL__VIEW:({metadata:t,extras:n,event:r,origin:i})=>{e(il(a.TiburonEventName.OpenParentFolderAccessModal,t,i,{...n,num_parent_folders:r.payload.numParents}))},SHARE_MODAL_MANAGE_ACCESS__PARENT_FOLDER_REMOVE_ACCESS_MODAL__VIEW:({metadata:t,extras:n,event:r,origin:i})=>{e(il(a.TiburonEventName.OpenParentFolderAccessModal,t,i,{...n,num_parent_folders:r.payload.numParents}))},SHARE_MODAL_SHARE__VIEW:({metadata:t,extras:n,origin:r})=>{var i,o;let s;t.sharingObjectMetadata&&(s=a.getCanDoAction(t.sharingObjectMetadata,a.INVITE_EDITOR_TAG)),"file_folder"!==(null===(i=t.sharingObjectMetadata)||void 0===i?void 0:i[".tag"])||s?"link_only"===(null===(o=t.sharingObjectMetadata)||void 0===o?void 0:o[".tag"])?(n=t.sharingObjectMetadata.tooManyMountsError?{...n,link_only_reason:t.sharingObjectMetadata.tooManyMountsError[".tag"]}:{...n,link_only_reason:"is_family"},e(ol(a.TiburonEventName.ViewLinkOnlyModal,t,r,{...n,share_tab:t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"}))):(e(ol(a.TiburonEventName.ViewShareScreen,t,r,{...n,share_tab:t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"})),e(ol(a.TiburonEventName.ViewShareTab,t,r,{...n,share_tab:t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"}))):n={...n,link_only_reason:"limited_permissions"}},SHARE_MODAL_SHARE__LINK_ACCESS_LEVEL__CHANGE:({metadata:t,extras:n,origin:r,event:i})=>{e(ol(a.TiburonEventName.ViewShareTab,t,r,{...n,share_tab:"editor"===i.payload.next[".tag"]?"edit_tab":"view_tab"}))},SHARE_MODAL_MANAGE_ACCESS__VIEW:({metadata:t,extras:n,origin:r,event:i})=>{e(ol(a.TiburonEventName.ViewManageAccessScreen,t,r,{...n,manage_tab:i.payload.manage_tab,share_modal_initial_screen:i.payload.share_modal_initial_screen}))},SHARE_MODAL_MANAGE_ACCESS_TAB__VIEW:({metadata:t,extras:n,origin:r,event:i})=>{e(ol(a.TiburonEventName.ViewManageAccessTab,t,r,{...n,manage_tab:i.payload.manage_tab,share_modal_initial_screen:i.payload.share_modal_initial_screen}))},SHARE_MODAL_SHARE__MANAGE_ACCESS__CLICK:({metadata:t,extras:n,origin:r})=>{e(ol(a.TiburonEventName.ClickWhoCanAccess,t,r,n))},SHARE_MODAL__REQUEST_CLOSE__CALLED:({metadata:t,extras:n,origin:r,event:i,cache:o})=>{t={...t,sharingObjectIdentifier:i.payload.objectIdentifier},t={...t,shareModalSessionId:i.payload.sessionId},o.inviteStartTime&&(n={...n,time_modal_opened:Date.now()-o.inviteStartTime}),e(il(a.TiburonEventName.CloseShareModal,t,r,n))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptTargetSearch,t,r,n))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedTargetSearch,t,r,n))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.FailTargetSearch,t,r,{...n,error:i.payload.response.error[".tag"]}))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailTargetSearch,t,r,{...n,error:"unknown"}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_START:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.AttemptDeleteSharedLink,t,r,n))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_ERROR:({metadata:t,event:n,origin:r,extras:i})=>{e(il(a.TiburonEventName.FailDeleteSharedLink,t,r,{http_status_code:n.payload.response.statusCode,error_message:n.payload.response.error[".tag"],...i}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_FATAL:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.FailDeleteSharedLink,t,r,{http_status_code:0,error_message:"undefined_error",...n}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_SUCCESS:({metadata:t,extras:n,origin:r})=>{e(il(a.TiburonEventName.SucceedDeleteSharedLink,t,r,{http_status_code:200,response_status:"success",...n}))},SHARE_MODAL_SETTINGS__CREATE_LINK__NAMESPACE_CREATE_ERROR:({metadata:t,extras:n,event:r,origin:i})=>{var o,s;n={...n,http_status_code:0,error_tag:"undefined_error",access:(null===(o=t.sharingAccessLevel)||void 0===o?void 0:o[".tag"])||"unknown"},n="ApiError"===r.payload.output.type||"PollingApiError"===r.payload.output.type?{...n,http_status_code:200,error_tag:r.payload.output.value.response.error[".tag"],access:(null===(s=t.sharingAccessLevel)||void 0===s?void 0:s[".tag"])||"unknown"}:"NetworkFailure"===r.payload.output.type||"PollingNetworkFailure"===r.payload.output.type?{...n,http_status_code:r.payload.output.value.response.statusCode||0}:{...n,error_tag:r.payload.output.type},e(il(a.TiburonEventName.FailCreateNamespaceAfterLinkCreated,t,i,n))},SHARE_MODAL_SHARE__CREATE_LINK__NAMESPACE_CREATE_ERROR:({metadata:t,extras:n,event:r,origin:i})=>{var o,s;n={...n,http_status_code:0,error_tag:"undefined_error",access:(null===(o=t.sharingAccessLevel)||void 0===o?void 0:o[".tag"])||"unknown"},n="ApiError"===r.payload.output.type||"PollingApiError"===r.payload.output.type?{...n,http_status_code:200,error_tag:r.payload.output.value.response.error[".tag"],access:(null===(s=t.sharingAccessLevel)||void 0===s?void 0:s[".tag"])||"unknown"}:"NetworkFailure"===r.payload.output.type||"PollingNetworkFailure"===r.payload.output.type?{...n,http_status_code:r.payload.output.value.response.statusCode||0}:{...n,error_tag:r.payload.output.type},e(il(a.TiburonEventName.FailCreateNamespaceAfterLinkCreated,t,i,n))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__ATTEMPT:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.AttemptSolveDefaultAudienceConflict,t,r,{...n,user_default_link_audience:i.payload.user_default_link_audience,team_default_link_audience:i.payload.team_default_link_audience,final_audience:i.payload.final_audience,is_team_user:i.payload.is_team_user}))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__FAIL:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.FailSolveDefaultAudienceConflict,t,r,{...n,user_default_link_audience:i.payload.user_default_link_audience,team_default_link_audience:i.payload.team_default_link_audience,final_audience:i.payload.final_audience,is_team_user:i.payload.is_team_user}))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__SUCCEED:({metadata:t,extras:n,origin:r,event:i})=>{e(il(a.TiburonEventName.SucceedSolveDefaultAudienceConflict,t,r,{...n,user_default_link_audience:i.payload.user_default_link_audience,team_default_link_audience:i.payload.team_default_link_audience,final_audience:i.payload.final_audience,is_team_user:i.payload.is_team_user}))}})),[e])})(),t=k.useMemo((()=>({})),[]);return k.useCallback(((a,n,r)=>{const i=e[a.type];if(i&&r)try{i({event:a,metadata:n,origin:r,cache:t,extras:{is_sdk:!0}})}catch(e){}}),[e,t])},ml=({sink:e,children:a,origin:n,actionInfo:r})=>{const i=(()=>{const e=Za();return k.useCallback(((a,n)=>{var r;("SANDBOX"===e||e===t.Platforms.DESKTOP&&"developer"===(null===(r=n.desktopMetadata)||void 0===r?void 0:r.buildChannel))&&window.console.log(a,n)}),[e])})(),o=gl(),s=k.useMemo((()=>Qe(e,i,o)),[e,i,o]);return k.createElement(Xe,{sink:s,origin:n,actionInfo:r},a)};ml.displayName="LoggingProviderWithBuiltIns";const pl=({loggingSink:e,sdk:a,children:n,redirectWindowToken:r=null,intl:i,platform:o=t.Platforms.SANDBOX,openUrl:s=null,origin:l,actionInfo:_,onSnackbarShownChange:d})=>k.createElement(Ys,{intl:i},k.createElement(Qa,{platform:o},k.createElement(qa,{openUrl:s||ja},k.createElement(We,{sdk:a},k.createElement(Li,{redirectWindowToken:r},k.createElement(ml,{sink:e||Ke,origin:l,actionInfo:_},k.createElement(rn,{onSnackbarShownChange:d},n)))))));pl.displayName="Provider";const hl=/^www\.dropbox\.com$/,El=/^meta-.*\.dev\.corp\.dropbox\.com$/,fl=(e,t)=>{if(!e.sharingObjectIdentifier)throw new Error("Missing objectIdentifier while trying to log to PAP");if(!e.sharingObjectMetadata)throw new Error("Missing objectMetadata while trying to log to PAP");if(!t)throw new Error("Missing actionInfo while trying to log to PAP")},vl=async(e,t)=>{const n=a.PAP_Copy_SharedLink({...e,contentAction:e.contentAction?a.getContentActionFromString(e.contentAction):void 0}),r={isDir:e.isDir?"true":"false"};"start"===e.eventState?a.UDCL.logStart(n,{tags:r,key:t}):a.UDCL.logEnd(n,{tags:r,key:t})},Sl=async(e,t)=>{const n=C.PAP_Create_SharedLink({...e,contentAction:e.contentAction?a.getContentActionFromString(e.contentAction):void 0});"start"===e.eventState?a.UDCL.logStart(n,{key:t}):a.UDCL.logEnd(n,{key:t})},bl=()=>(({logCopyLinkEvent:e,logCreateLinkEvent:t})=>k.useCallback(((n,r,i,o)=>{switch(n.type){case"SHARE_MODAL_SHARE__COPY_LINK__CLICK":fl(r,o),(n.payload.linkMetadata?a.getLinkMetadataSharedLinkProps(n.payload.linkMetadata):Promise.resolve({})).then((t=>e({...a.getBaseCopySharedLinkProps("start",o,r,!0),...t},a.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__COPY_LINK__COPY_SUCCESS":fl(r,o),a.getLinkMetadataSharedLinkProps(n.payload.linkMetadata).then((t=>e({...a.getBaseCopySharedLinkProps("success",o,r,!0),...t},a.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__COPY_LINK__COPY_ERROR":fl(r,o),a.getLinkMetadataSharedLinkProps(n.payload.linkMetadata).then((t=>e({...a.getBaseCopySharedLinkProps("rejected",o,r,!0),...t},a.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_START":fl(r,o),t(a.getBaseCreateSharedLinkProps("start",o,r),a.getFileIdOrPath(r)),e(a.getBaseCopySharedLinkProps("start",o,r,!1),a.getFileIdOrPath(r));break;case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_START":fl(r,o),t(a.getBaseCreateSharedLinkProps("start",o,r),a.getFileIdOrPath(r));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_SUCCESS":case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_SUCCESS":fl(r,o),a.getLinkMetadataSharedLinkProps(n.payload.response.output,200).then((e=>t({...a.getBaseCreateSharedLinkProps("success",o,r),...e},a.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_ERROR":case"SHARE_MODAL_SHARE__CREATE_LINK__API_FATAL":fl(r,o);const i=a.getErrorState$1(n.payload.response);t({...a.getBaseCreateSharedLinkProps(i,o,r),...a.getCreateLinkExceptionProps(n.payload.response)},a.getFileIdOrPath(r)),e({...a.getBaseCopySharedLinkProps(i,o,r,!1),...a.getCreateLinkExceptionProps(n.payload.response)},a.getFileIdOrPath(r));break;case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_ERROR":case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_FATAL":fl(r,o);const s=a.getErrorState$1(n.payload.response);t({...a.getBaseCreateSharedLinkProps(s,o,r),...a.getCreateLinkExceptionProps(n.payload.response)},a.getFileIdOrPath(r));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_ERROR":fl(r,o),a.getLinkMetadataSharedLinkProps(n.payload.linkMetadata,200).then((t=>e({...a.getBaseCopySharedLinkProps("rejected",o,r,!1),...t},a.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_FORBIDDEN":fl(r,o),a.getLinkMetadataSharedLinkProps(n.payload.linkMetadata,200).then((t=>e({...a.getBaseCopySharedLinkProps("canceled",o,r,!1),...t},a.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_SUCCESS":fl(r,o),a.getLinkMetadataSharedLinkProps(n.payload.linkMetadata,200).then((t=>e({...a.getBaseCopySharedLinkProps("success",o,r,!1),...t},a.getFileIdOrPath(r))))}}),[t,e]))({logCopyLinkEvent:vl,logCreateLinkEvent:Sl}),yl=({userApiProps:e,origin:n,actionInfo:i,children:o,platform:s=t.Platforms.METASERVER})=>{const l=bl(),_=k.default.useCallback((e=>{"TEAMS_WEB"===e.type&&a.TeamsWebActionsLogger.log(e.payload.name,e.payload.extra)}),[]),d=k.default.useMemo((()=>Qe(l,_)),[l,_]),c=k.default.useMemo((()=>(e=>{const t=window.location.hostname;if(!hl.test(t)&&!El.test(t))throw new Error("Cannot initialize the SDK on an unsupported domain.");const a=new A.DropboxAuth({domain:window.location.hostname,domainDelimiter:""});return new A.Dropbox({auth:a,fetch:(t,a)=>{const n=new Headers((null==a?void 0:a.headers)||[]),r=window.location.hostname;(hl.test(r)||El.test(r))&&n.append("X-CSRF-Token",T.readCsrfToken()||""),n.append("X-Dropbox-Uid",e.id.toString());const i=e.root_ns_id;null!==i&&n.append("Dropbox-API-Path-Root",JSON.stringify({".tag":"namespace_id",namespace_id:i.toString()}));const o={...a||{},headers:n};return fetch(t,o)}})})(e)),[e]),{data:u,isLoading:g,isError:m}=(()=>{const{data:e,isLoading:t,isError:a,error:n}=I.loginAndRegisterConstantsPrefetchRequest.useQuery({apiArg:null,pkgArg:null});return{data:null==e?void 0:e.apiData,isLoading:t,isError:a,error:n}})();return g||m?null:k.default.createElement(pl,{intl:r.intl,sdk:c,loggingSink:d,redirectWindowToken:null==u?void 0:u.redirectWindowToken,platform:s,origin:n,actionInfo:i},o)};yl.displayName="SharingSdkProviderInternal";t.Context=Ce,t.Context$1=Ne,t.Emstring=q,t.Inband=$o,t.Main=e=>{const t=(e=>a.useInitStore(e,(e=>{const t=a.store(!1),n=a.store(!1),r=a.proxy((()=>e.get().objectIdentifier)),i=a.proxy((()=>e.get().progressiveInbandVariant)),o=a.proxy((()=>e.get().canUserUseTransfer)),s=a.proxy((()=>e.get().canContentUseTransfer)),l=a.store(0),_=a.store(!1),d=a.store(!1),c=a.store(ae.MAIN),u=a.store(!1);return{$inbandTransitionDone:t,$shouldHideNonInbandButtons:n,$props:e,$objectIdentifier:r,$progressiveInbandVariant:i,$canUserUseTransfer:o,$canContentUseTransfer:s,$componentViewTime:l,$isClickawayLocked:_,$isInbandStarted:d,$currentScreen:c,$isBrandingPanelOpen:u}})))(e);return e.isOpen?k.createElement(Ks,null,k.createElement(Bs,{store:t})):null},t.MetadataProvider=et,t.Provider=Ot,t.SharingSdkProvider=e=>k.default.createElement(a.SafeQueryClientProviderWrapper,null,k.default.createElement(yl,{...e})),t.SharingSettingsUtil=e=>({getLinkPolicy:e=>({link_password:P(e.link_permissions)?void 0:"",expires:e.expires,allow_download:e.link_permissions.allow_download,audience:$(e.link_permissions),require_password:e.link_permissions.require_password,is_low_distraction_view:e.link_permissions.is_low_distraction_view}),getModifiedSettings:(t,a,n)=>{if(a===n)return;const r={},i=null!=t.expires&&null==a.expires;if(a.audience!==n.audience&&(r.audience=a.audience),a.allow_download!==n.allow_download&&(r.allow_download=a.allow_download),a.expires&&t.link_permissions.can_set_expiry&&(r.expires=a.expires.toISOString().split(".")[0]+"Z"),a.require_password!==n.require_password&&(r.require_password=a.require_password),"password"===a.audience||a.require_password)if(a.link_password)r.require_password=!0,r.link_password=a.link_password;else if(""===a.link_password)return{error:e.formatMessage({id:"wFrAfD",defaultMessage:"Password can’t be empty"})};return a.is_low_distraction_view!==n.is_low_distraction_view&&(r.is_low_distraction_view=a.is_low_distraction_view),Object.keys(r).length<=0&&!i?void 0:{url:t.url,settings:r,remove_expiration:i}}}),t.canCreateLink=function(e,t,a,n,r,i,o,s,l,_,d,c,u){switch(e){case"editor":return a?i&&G(n,u)&&(!r||!!c):G(n,u)&&l;case"viewer":return!("writer"===_&&!d)&&(t?s:G(n,u)&&s||o);default:return!1}},t.canCreateLinksForFolder=G,t.canModifyExpire=function(e){const t=e.link_permissions;return Boolean(t.can_set_expiry)},t.canModifyPassword=function(e){return Boolean(e&&e.can_set_password)||F(e)},t.canToggleExpire=function(e){const t=e.link_permissions;return Boolean(null!=e.expires?t.can_remove_expiry:t.can_set_expiry)},t.canTogglePassword=function(e){return Boolean(e&&e.require_password?e.can_remove_password:e.can_set_password)||F(e)},t.convertContactToInviteTarget=e=>e.type===a.ContactTypes.EMAIL?e.name&&e.name.length?{".tag":"user",dbx_team_id:e.dbx_team_id||"",...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,sort_key:e.name,dbx_account_id:e.dbx_account_id||"",email:e.email||""}:Sa(e.email||""):e.type===a.ContactTypes.NEW_STYLE_GROUP?{".tag":"group",dbx_team_id:e.dbx_team_id||"",members:e.members||"",name:e.name,sort_key:e.name,group_id:e.group_id||"",group_size:e.group_size||0}:e.type===a.ContactTypes.DBX_ID?{".tag":"user",dbx_team_id:e.dbx_team_id||"",...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,sort_key:e.name,dbx_account_id:e.dbx_account_id||"",email:e.email||""}:Sa(""),t.convertContentInfoToObjectIdentifier=e=>{var t,a;return e.isSharedFolder()?{".tag":"shared_folder",sharedFolderId:String(e.sharedFolderId())}:e.isFileFolder()?{".tag":"file_folder",name:e.name(),path:null!==(t=e.displayPath())&&void 0!==t?t:""}:{".tag":"file",fileId:null!==(a=e.fileId())&&void 0!==a?a:""}},t.convertInviteTargetToContact=gr,t.convertLinkAccessLevelToSdkLinkAccessLevel=hr,t.convertLinksMetadataToSdkLinksMetadata=e=>{if(void 0===e)throw new Error("Adapt error");const t=[];for(const s of e)t.push((r=void 0,i=void 0,o=void 0,{".tag":(n=s).file_type,url:n.url,id:n.id,name:n.name,expires:a.convertExpirationDateToString(n.expires),path_lower:n.path_lower,link_permissions:(i=n.link_permissions,{resolved_visibility:i.resolved_visibility?(o=i.resolved_visibility,"public"===o?on:"team_only"===o?sn:"password"===o?ln:"team_and_password"===o?_n:"shared_folder_only"===o?dn:"no_one"===o?cn:"only_you"===o?un:a.exhausts(o,gn)):void 0,requested_visibility:i.requested_visibility?Er(i.requested_visibility):void 0,can_revoke:i.can_revoke,visibility_policies:[],can_set_expiry:i.can_set_expiry,can_remove_expiry:i.can_remove_expiry,allow_download:i.allow_download,can_allow_download:i.can_allow_download,can_disallow_download:i.can_disallow_download,restricting_shared_folder_path:i.restricting_shared_folder_path,allow_comments:i.allow_comments,team_restricts_comments:i.team_restricts_comments,effective_audience:i.effective_audience?fr(i.effective_audience):void 0,audience_options:Nr(i.audience_options),link_access_level:hr(i.link_access_level),can_set_password:i.can_set_password,can_remove_password:i.can_remove_password,require_password:i.require_password,can_use_extended_sharing_controls:i.can_use_extended_sharing_controls,days_to_expire_policy:Or(i.days_to_expire_policy),change_shared_link_expiration_policy:xr(i.change_shared_link_expiration_policy),enforce_shared_link_password_policy:Dr(i.enforce_shared_link_password_policy)}),team_member_info:n.team_member_info?(r=n.team_member_info,{team_info:Pr(r.team_info),display_name:r.display_name,member_id:r.member_id}):void 0,content_owner_team_info:n.content_owner_team_info?Pr(n.content_owner_team_info):void 0,preview_type:n.preview_type}));var n,r,i,o;return{links:t,has_more:!1}},t.convertSharingInfoToSdkAccountMetadata=e=>{const t=e.user();return{user_id:t.id,email:t.email,account_id:t.account_id,root_info:{".tag":"user",root_namespace_id:"ns_id",home_namespace_id:"ns_id"},is_paid:!!t.paid,role:t.role,is_family_user:!0===e.isFamilyUser(),is_team_member:!!t.is_team,team_policies:yr(e.teamPolicy()),team_id:t.team_dbtid,is_team_admin:t.is_team_admin,team_name:t.team_name,can_use_extended_sharing_controls:!0===e.canUseExtendedSharingControls(),is_tmr_member:t.is_tmr_member,is_paired:!0===e.isPaired()}},t.convertSharingInfoToSdkInviteTargetValidation=(e,t)=>{const a=t.recipientAccess(),n=t.recipientValidation()[a]||{},r=e.map(gr).map((e=>e.getKey())),i=e.map(ba),o=i.reduce(((e,t,a)=>({[t]:n[r[a]],...e})),{});return i.reduce(((e,t)=>{const a=o[t];if(!a)return e;const n={member:{".tag":"other"},result:mr(a),target_invite_eligibility:{".tag":"other"}};return{...e,[t]:n}}),{})},t.convertSharingInfoToSdkObjectMetadata=e=>br(e.metadata(),!0===e.contentInfo().isFolderInsideTeamFolderTree(),!0===e.contentInfo().isTeamSharedFolder()),t.convertSharingInfoToSdkSharingPrefs=e=>{const t=e.sharingPrefs();if(void 0===t)throw new Error("Adapt error");return{in_server_side_contact_validation_settings:t.in_server_side_contact_validation_settings,create_nested_shared_folder_variant:t.create_nested_shared_folder_variant,confidential_folder_links_enabled:t.confidential_folder_links_enabled,in_share_modal_upsell_premium_sharing:t.in_share_modal_upsell_premium_sharing,in_share_modal_upsell_premium_sharing_variant:t.in_share_modal_upsell_premium_sharing_variant,has_seen_share_modal_upsell_premium_sharing_counter:t.has_seen_share_modal_upsell_premium_sharing_counter,invite_after_sharing_modal_variant:Fr(t.invite_after_sharing_modal_variant),exp_links_in_member_list:t.exp_links_in_member_list,has_seen_esign_post_sharing:t.has_seen_esign_post_sharing,links_in_member_list_in_sdk_share_modal_variant:t.links_in_member_list_in_sdk_share_modal,is_in_esign_post_sharing_exclusion_period:t.is_in_esign_post_sharing_exclusion_period,bsx_organize_around_people:t.bsx_organize_around_people,is_showing_file_upload_toolkit_campaign:t.is_showing_file_upload_toolkit_campaign,default_sharing_access_level_setting:t.default_sharing_access_level_setting,default_sharing_link_audience_setting:t.default_sharing_link_audience_setting,last_seen_team_policy_audience:t.last_seen_team_policy_audience,capture_sdk_integration_voice_overs_variant:t.capture_sdk_integration_voice_overs_variant,core_act_docsend_advanced_sharing:t.core_act_docsend_advanced_sharing,create_view_file_link_enabled:t.create_view_file_link_enabled,create_view_folder_link_enabled:t.create_view_folder_link_enabled,invite_after_sharing_resurface_variant:t.invite_after_sharing_resurface_variant,num_available_licenses:t.num_available_licenses}},t.convertSharingInfoToSdkUser=e=>{const t=e.user();return{id:t.id,email:t.email,is_team:!!t.is_team,is_team_admin:t.is_team_admin,account_id:t.account_id,team_dbtid:t.team_dbtid,is_tmr_member:t.is_tmr_member}},t.createFromEmail=Sa,t.createSdkObjectMetadata=br,t.daysAfterToday=e=>{const t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),((e,t,a,n,r,i)=>(null==t&&(t=0),null==a&&(a=0),null==n&&(n=0),null==r&&(r=0),null==i&&(i=0),e.setFullYear(e.getFullYear()+t),e.setMonth(e.getMonth()+a),e.setDate(e.getDate()+n),e.setHours(e.getHours()+r),e.setMinutes(e.getMinutes()+i),e))(t,0,0,e)},t.daysExpirationPolicyToNumber=H,t.fetchIsEligibleToInviteGuest=J,t.fetchTeamGuestPassDetails=async function(){var e,t;const n=ee(await a.fetchViewer());let r;try{r=await Z(n).rpc("get_team_details",{},{})}catch(n){throw new Error((null===(t=null===(e=a.filterApiError(n))||void 0===e?void 0:e.error)||void 0===t?void 0:t[".tag"])||"Unknown error")}if(void 0===r.remaining_guest_passes||void 0===r.used_guest_passes||void 0===r.guest_pass_duration_days||void 0===r.is_team_eligible_for_guest_pass)throw new Error("Missing data in response");return{remainingGuestPasses:r.remaining_guest_passes,usedGuestPasses:r.used_guest_passes,guestPassDurationDays:r.guest_pass_duration_days,isTeamEligibleForGuestPass:r.is_team_eligible_for_guest_pass}},t.formatSubTitle=Aa,t.getAudienceForLink=$,t.getAvatarUrl=ya,t.getDoesServiceHavePermissionGranted=Pi,t.getGroupInitials=Fi,t.getInviteAfterSharingUsers=K,t.getIsServiceConnected=Di,t.getLinkControlPolicyWarningText=function(e,t,a,n){let r="";if(j(e,a)){const e=z(a),t=V(a);r=n.formatMessage({id:"GoACO+",defaultMessage:"Your admin requires {requirements, select, 0 {an expiration and a password} 1 {a password} 2 {an expiration} other{}} for links shared outside the team. To change the link setting, delete the link and create it again."},{requirements:e&&t?0:t?1:2})}else t.display_expiration_warning?r=n.formatMessage({id:"ySRXj8",defaultMessage:"Your admin {show_password_text, select, true {requires a password and } other {}}has set an expiration for all links shared outside the team. This link will expire in {days_to_expire, plural, =365 {1 year} one {# day} other {# days}}.{expiration_enforced, select, true { You can change or remove this expiration.} other {}}"},{days_to_expire:H[a.days_to_expire_policy],expiration_enforced:"allowed"===a.change_shared_link_expiration_policy,show_password_text:!!t.display_password_warning}):t.display_password_warning&&(r=n.formatMessage({id:"lcVbzE",defaultMessage:"Your admin requires to set a password for links shared outside the team."}));return r},t.getUniqueId=ba,t.getUserInitials=$i,t.hasLinkPassword=P,t.isConfidentialFolderLinksEnabled=xn,t.isExpirationPolicyEnforcedByAdmin=z,t.isExpirationPolicySetByAdmin=U,t.isExternalAudience=B,t.isMemberInviteModal=Y,t.isPasswordPolicyEnforcedByAdmin=V,t.isReadOnlyPolicy=j,t.listLinkedServices=xi,t.shouldShowModalVariant=Q,t.targetsSearch=Oi,t.useData=xt,t.useEndpoint=tt,t.useLogger=Je,t.usePlatform=Za,t.useRedirectWindowToken=Mi,t.useShowGenericRequestFailureMessage=an,t.useSnackbar=Ja}));
//# sourceMappingURL=c_src_bindings_provider.js-vfl2f8DMa.map

//# debugId=41eb6429-894b-3f7d-b342-48d124683064