!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="9921c058-ad64-3e44-a835-73b5efa5f8d1")}catch(e){}}();
define(["exports","./c_file_viewer_common_download_utils","./c_admin_registration_source_constants","./c_browse_data_selectors","./c_tagging_data_store","./e_file_viewer_static_scl_page_folder","./c_file_viewer_pap_logger_utils","./c_preview_audio_video_video_editing_utils","react","./c_share_download_ui_api","./c_api_v2_routes_password_confirmation_provider","./e_core_exception","./c_lodash","./c_core_i18n","./c_src_sink_index","./c_pap-events_docsend_view_docsend_hub_entry_button","metaserver/static/js/langpack","./c_ui_async_file_modal_controller","./e_edison","./c_api_v2_routes_folders_info_provider","./c_proto_sharing_edison_edison_sharing_service_connectweb","./e_data_modules_stormcrow","./c_encrypted_folder_ekms","./c_portable_save_as_copy","./c_ui_copy_to_dropbox_copy_to_dropbox_helper","./c_files_view_file_actions_api_v2","./c_core_notify","react-dom","metaserver/static/js/modules/constants/viewer","./c_api_v2_routes_team_provider","./c_portable_save_as_copy_snackbars","./c_file_viewer_common_show_auth_modal","./c_tagging_utils","./c_browse_models","./c_search_search_helpers","./c_pap-events_navigation_select_create_folder_action","./c_dig-icons_assets_ui-icon_line_star","./c_browse_action_logger","./c_files_view_util","./c_pnm_utils","./c_onboarding_survey_lib_oa_pulsar_campaigns","./c_sync_everything_redux_selectors","./c_sync_everything_redux_types","./c_sync_everything_redux_store","./c_core_logging_actions","./c_react_query_helpers_queries_file_content_metadata","./c_api_v2_routes_hellosign_provider"],(function(e,i,o,t,r,_,n,s,c,a,l,d,p,u,g,v,w,f,S,E,h,m,b,y,A,D,F,x,P,T,k,I,O,C,W,N,U,K,L,R,B,V,H,q,M,$,j){"use strict";const z=[_.SDKPreviewSurface.BROWSE,_.SDKPreviewSurface.SEARCH,_.SDKPreviewSurface.STANDALONE_PREVIEW],G=(e,i)=>{i&&z.includes(i)&&_.UserSurvey.trackEvent("download_item","previews"),_.isVideoPreview(_.getExtension$1(e))&&_.UserSurvey.trackEvent("video_preview_download","previews")},Q=[_.SDKPreviewSurface.BROWSE,_.SDKPreviewSurface.SHARED_LINK,_.SDKPreviewSurface.STANDALONE_PREVIEW],Z=e=>{const{getActiveFile:o,logUserAction:s,previewSurface:c,user:a}=e,{file:l}=o();G(l,c),c&&Q.includes(c)&&!_.isEncryptedFile(l)&&_.publishEvent(_.CampaignEvents.DOWNLOAD_BUTTON_CLICKED,{context:{file_name:_.getFilename(l),file_extension:_.getExtension$1(l),is_video_editing_eligible:!0===e.videoEditEligible?"true":"false"}});const d={onAttempt:()=>s(_.UserAction.DownloadStart),onSuccess:()=>{s(_.UserAction.DownloadSuccess,"title_bar_open_split_button")},onError:()=>s(_.UserAction.DownloadFailed)},p={actionSurface:"previews",actionElement:e.userActionContext,fileSize:l.bytes,fileType:_.getFileTypeFromString(_.getExtension$1(l)),previewType:n.getPapPreviewType(_.resolvePreviewType(l.preview,_.getFilename(l))),previousSurface:i.getPreviousSurfaceFromString(e.previewSurface)},{rootNSID:u,blockHash:g}=t.getBrowseState(r.getStoreForBrowse().getState()).context;a&&u&&_.isUnmountedBackupBrowse(a,u)?g&&_.isBrowseFile(l)&&i.downloadSingleFileAsZip({fqPath:l.fq_path,rootNsId:u,source:"PREVIEWS",blockHash:g,user:a,loggingParams:p},d):i.downloadSingleFile({href:l.href,source:"PREVIEWS",isFswm:_.isSharedFile(l),user:a,fileEncryptionInfo:_.getFileEncryptionInfo(l),loggingParams:p},d)},J=e=>{const{getActiveFile:o,logUserAction:t,previewSurface:r,user:n,shareToken:s,sharePermission:c,encryptionOptions:a,authModalKind:l,videoEditEligible:d,userPresentableVerdict:p,userActionContext:u}=e,{file:g}=o();G(g,r),r&&Q.includes(r)&&!_.isEncryptedFile(g)&&_.publishEvent(_.CampaignEvents.DOWNLOAD_BUTTON_CLICKED,{context:{file_name:_.getFilename(g),file_extension:_.getExtension$1(g),is_video_editing_eligible:!0===d?"true":"false"}}),i.downloadActiveFile({file:g,user:n,encryptionOptions:a,authModalKind:l,logUserAction:t,shareToken:s,webSignInTag:_.getWebSignInTag(!!n,r,c),userPresentableVerdict:p,userActionContext:u,previewSurface:r})};e.downloadActionWrapper=e=>{const{getActiveFile:i,fileContentMetadata:o,onLogSharedActionClick:t}=e,{file:r}=i();return t&&t("download"),e.videoEditEligible=!o||void 0===s.checkFileEditEligibility(o,null==r?void 0:r.bytes,e.fileName),_.isSharedFile(r)?J(e):Z(e)},e.nonSharedDownloadActionWrapper=Z,e.sharedCopyActionWrapper=e=>{const{getActiveFile:t,logUserAction:r,previewSurface:n,user:s,shareToken:c,sharePermission:a,encryptionOptions:l,outOfQuota:d,onLogSharedActionClick:p}=e,{file:u}=t();p&&p("copy_to_dropbox"),i.saveToDropbox(u,(e=>r(e,"title_bar_download_split_button")),s,c,l,o.RegistrationSource.SHMODEL_SAVE_TO_REGISTER,d,_.getWebSignInTag(!!s,n,a),t().sharedLinkInfo)},e.sharedDownloadActionWrapper=J}));
//# sourceMappingURL=c_action_plugins_download_action_action.js-vflPIZcyX.map

//# debugId=9921c058-ad64-3e44-a835-73b5efa5f8d1