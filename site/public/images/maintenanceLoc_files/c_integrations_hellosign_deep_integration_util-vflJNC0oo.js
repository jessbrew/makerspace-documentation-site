!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2951c14e-a3b0-3ce0-aa10-c2c6796643bc")}catch(e){}}();
define(["require","exports","./c_api_v2_routes_hellosign_provider","./c_pap-events_sign_save_signature_doc","./e_file_viewer_static_scl_page_folder","./c_file_viewer_api_navigation","react","./c_core_i18n","./c_pdf_editor_plugin_show_plugin_util","./c_lodash"],(function(e,t,n,i,r,_,o,a,E,s){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var S=l(o);const u=e=>{let t,n;e.header&&(t=S.default.createElement(r.Modal.Title,null,a.intl.formatMessage(e.header))),e.body&&(n=a.intl.formatMessage(e.body));const i=e.confirmationString||a.defineMessage({id:"4aLDLg",defaultMessage:"OK"});return S.default.createElement(r.Modal,{open:e.isOpen,isCentered:!0,withCloseButton:"Close",onRequestClose:e.close},S.default.createElement(r.Modal.Header,{hasBottomSpacing:"title-standard"},t),S.default.createElement(r.Modal.Body,{hasVerticalSpacing:!1},n),S.default.createElement(r.Modal.Footer,null,e.additionalCloseButton&&S.default.createElement(r.Button,{variant:"opacity",onClick:e.close},a.intl.formatMessage(e.additionalCloseButton)),S.default.createElement(r.Button,{variant:"primary",onClick:()=>{e.confirmRedirect?window.open(e.confirmRedirect):e.onConfirm?e.onConfirm():e.close()},withIconLeft:e.confirmRedirect?S.default.createElement(r.UIIcon,{src:r.OpenLine}):null},a.intl.formatMessage(i))))};u.displayName="ConfirmationModal";const d=a.defineMessages({overFileLimitError:{id:"+2TtIJ",defaultMessage:"The page count and file size are too large for signatures in PDF. Try reducing the file to less than 40MB or 500 pages."}});var c,f;t.EntryPointType=void 0,(c=t.EntryPointType||(t.EntryPointType={})).SELF_SIGN="SELF_SIGN",c.SEND_FOR_SIGNATURE="SEND_FOR_SIGNATURE",c.TEMPLATE="TEMPLATE",t.EntryPointSurface=void 0,(t.EntryPointSurface||(t.EntryPointSurface={})).SIGNATURES="SIGNATURES",t.SignEditorType=void 0,(f=t.SignEditorType||(t.SignEditorType={})).PDF_EDITOR="PDF_EDITOR",f.DEEP_INTEGRATION="DEEP_INTEGRATION";const N=()=>{r.mountModal(S.default.createElement(u,{isOpen:!0,close:()=>r.unmountModal(),header:a.defineMessage({id:"dyerh1",defaultMessage:"Canâ€™t add signature."}),body:d.overFileLimitError}))};async function T(e){const t=new r.DefaultUserApiV2Client(e||r.mustGetActiveUserApiV2Properties());try{return(await n.GetHellosignRoutes(t).rpc("get_pdf_editor_eligibility",void 0,{})).is_eligible}catch(e){}return!0}const g=async(e,n,r)=>{if(e!==t.EntryPointType.SELF_SIGN&&e!==t.EntryPointType.SEND_FOR_SIGNATURE&&e!==t.EntryPointType.TEMPLATE)throw new Error("entry_point_not_supported");if(!await P(r))return!1;if(!n.ext||!i.HELLOSIGN_SUPPORTED_EXTENSIONS.includes(`.${n.ext}`))throw new Error("file_extension_not_supported");let _=t.SignEditorType.DEEP_INTEGRATION;if("ON"!==await O("pdf_editing_form_building",r)?_=t.SignEditorType.DEEP_INTEGRATION:("pdf"===n.ext||p(n.ext))&&(_=t.SignEditorType.PDF_EDITOR),_===t.SignEditorType.PDF_EDITOR){if(n.bytes>i.HELLO_SIGN_MAX_FILE_SIZE)throw new Error("size_over_limit");if(n.pageCount&&n.pageCount>i.HELLO_SIGN_MAX_PAGES)throw new Error("page_count_over_limit")}return _===t.SignEditorType.PDF_EDITOR},I=async(e,t)=>{const n=await new r.StormcrowGatingClient(t).getVariant({features:[e]});let i="OFF";return n&&n.variantInfos.forEach((t=>{t.feature===e&&(i=t.variant||"OFF")})),i},O=s.memoize(I),P=s.memoize(T),D=e=>{let t=E.SendForSignatureEntryPoints.PREVIEW_SHARE_DROPDOWN_SEND_FOR_SIGNATURE;return e===r.SDKPreviewSurface.BROWSE?t=E.SendForSignatureEntryPoints.BROWSE_PREVIEW_SHARE_DROPDOWN_SEND_FOR_SIGNATURE:e===r.SDKPreviewSurface.STANDALONE_PREVIEW?t=E.SendForSignatureEntryPoints.STANDALONE_PREVIEW_SHARE_DROPDOWN_SEND_FOR_SIGNATURE:e===r.SDKPreviewSurface.SHARED_LINK&&(t=E.SendForSignatureEntryPoints.SHARED_LINK_SHARE_DROPDOWN_SEND_FOR_SIGNATURE),t},p=e=>i.SIGN_NON_PDF_IN_PDF_EDITOR_SUPPORTED_EXTENSIONS.includes(e);t.getDesktopDeepLinkSource=e=>{switch(e){case"file_context_menu_mac":return E.SendForSignatureEntryPoints.DESKTOP_FILE_CONTEXT_MENU_MAC_SEND_FOR_SIGNATURE;case"file_context_menu_win":return E.SendForSignatureEntryPoints.DESKTOP_FILE_CONTEXT_MENU_WIN_SEND_FOR_SIGNATURE;case"file_context_menu_linux":return E.SendForSignatureEntryPoints.DESKTOP_FILE_CONTEXT_MENU_LINUX_SEND_FOR_SIGNATURE;case"file_context_menu_mac_self_sign":return E.SelfSignEntryPoints.DESKTOP_FILE_CONTEXT_MENU_MAC_SELF_SIGN;case"file_context_menu_win_self_sign":return E.SelfSignEntryPoints.DESKTOP_FILE_CONTEXT_MENU_WIN_SELF_SIGN;case"file_context_menu_linux_self_sign":return E.SelfSignEntryPoints.DESKTOP_FILE_CONTEXT_MENU_LINUX_SELF_SIGN;default:return E.SendForSignatureEntryPoints.DESKTOP_FILE_CONTEXT_MENU_UNKNOWN_SEND_FOR_SIGNATURE}},t.getEditorEligibility=T,t.getVariant=I,t.handleFileOverLimitError=N,t.isNonPdfEnabledInPdfEditor=p,t.isOpenWithSelfSign=e=>{switch(e){case"file_context_menu_mac_self_sign":case"file_context_menu_win_self_sign":case"file_context_menu_linux_self_sign":return!0;default:return!1}},t.memoizedGetEditorEligibility=P,t.memoizedGetVariant=O,t.openSendForSignatureOnPreviews=async(n,i,o,a,E,s,l)=>{var S;const u=r.getExtension$1({fq_path:null!==(S=n.fq_path)&&void 0!==S?S:""});try{if(await g(t.EntryPointType.SEND_FOR_SIGNATURE,{ext:u,bytes:n.bytes,pageCount:E},a))i(_.PDF_EDITOR_PLUGIN_ID,r.UserActionContext.Toolbar,{source:D(o),highlight:"send_for_signature"});else{const{getLauncher:t}=await new Promise((function(t,n){e(["./c_integrations_hellosign_deep_integration_launcher"],t,n)})),i=t();i.init({entryPoint:l||"share_menu",file:n,user:a,source:s}),i.launch()}}catch(e){e instanceof Error&&("size_over_limit"===e.message||"page_count_over_limit"===e.message)&&N()}},t.shouldUsePDFEditorFromDesktop=e=>!(!e||!i.HELLOSIGN_SUPPORTED_EXTENSIONS.includes(`.${e}`))&&("pdf"===e||p(e)),t.shouldUsePdfEditor=g}));
//# sourceMappingURL=c_integrations_hellosign_deep_integration_util.js-vflkPewdZ.map

//# debugId=2951c14e-a3b0-3ce0-aa10-c2c6796643bc